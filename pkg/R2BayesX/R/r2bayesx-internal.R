.print_bayesx <-
function(x, ...)
{
  cat("Call:\n")
  print(x$call)
  cat("---\n")
  if(!is.null(x$model.fit)) {
    mfn <- names(x$model.fit)
    step <- 5L
    for(i in 1L:length(mfn)) {
      if(i < step) {
        if(!is.null(x$model.fit[[i]]) && x$model.fit[[i]] != "") {
          if(mfn[i] != "step.final.model")
            cat(mfn[i], "=", x$model.fit[[i]]," ")
          else {
            cat("\n---\n")
            cat("Stepwise final model:\n")
            cat("-\n")
            cat(x$model.fit[[i]])
          }
        }
      }
      if(i == step) {
        if(i != length(mfn))
          cat("\n")
        step <- step + step
      }
    }
  cat("\n")
  }

  return(invisible(NULL))
}

.print_summary_bayesx <-
function(x, digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"), ...)
{
  if(!is.null(x$model.fit))
    if(!is.null(x$model.fit$model.name))
      if(length(grep("_hlevel", x$model.fit$model.name))) {
        hlevel <- splitme(strsplit(x$model.fit$model.name, "_hlevel")[[1]][2])
        go <- TRUE
        hl <- NULL
        for(i in 1:length(hlevel)) {
          if(hlevel[i] == "_")
            go <- FALSE
          if(go)
            hl <- c(hl, hlevel[i])
        }
        hlevel <- as.integer(resplit(hl))
        if(hlevel > 1)
          cat("Hierarchical random effects model results: stage", hlevel, "\n")
        else {
          cat("Main effects model results: stage", hlevel, "\n")
          cat("---\n")
        }
      }
  if(!is.null(x$call)) {
    cat("Call:\n")
    cat(paste(deparse(x$call), sep = "\n", collapse = "\n"), "\n", sep = "")
  } else {
    if(!is.null(x$model.fit$formula)) {
      cat("Formula:\n")
      print(as.formula(x$model.fit$formula))
    }
  }
  liner <- "---"
  fc <- FALSE
  if(!is.null(x$fixed.effects)) {
    fc <- TRUE
    if(nrow(x$fixed.effects) < 2L) {
      if(all(x$fixed.effects[1L,] == 0))
        fc <- FALSE
    } else {
      if(all(x$fixed.effects[1L,] == 0)) {
        m <- ncol(x$fixed.effects)
        nc <- colnames(x$fixed.effects)
        nr <- rownames(x$fixed.effects)[2L:nrow(x$fixed.effects)]
        x$fixed.effects <- matrix(x$fixed.effects[2L:nrow(x$fixed.effects),], ncol = m)
        colnames(x$fixed.effects) <- nc
        rownames(x$fixed.effects) <- nr
      }
    }
    x$fixed.effects <- round(x$fixed.effects, digits)
  }
  if(fc || (!is.null(x$smooth.hyp))) {
    cat(liner, "\n")
    cat("Fixed effects estimation results:\n")
    cat("-\n")
  }
  if(fc) {
    cat("Parametric Coefficients:\n")
    printCoefmat(x$fixed.effects)
  }
  if(!is.null(x$smooth.hyp)) {
    if(fc)
      cat("-\n")
    if(x$model.fit$method == "MCMC") 
      cat("Smooth terms variances:\n")
    else
      cat("Smooth terms:\n")
    ls <- ncol(x$smooth.hyp)
    terms <- colnames(x$smooth.hyp)	
    rn <- rownames(x$smooth.hyp)
    x$smooth.hyp <- round(x$smooth.hyp, digits)
    printCoefmat(x$smooth.hyp)
  }
  cat(liner, "\n")
  if(!is.null(x$random.hyp)) {
    cat("Random effects variances:\n")
    x$random.hyp <- round(x$random.hyp, digits)
    printCoefmat(x$random.hyp)		
    cat(liner, "\n")
  }		
  if(!is.null(x$model.fit)) {
    if(x$model.fit$method == "MCMC") {
      if(!is.null(x$variance)) {
        cat("Scale estimate:\n")
        x$variance <- round(x$variance, digits)
        printCoefmat(x$variance)
        cat(liner, "\n")
      }
    } else {
      if(!is.null(x$variance)) {
        cat("Scale estimate:", round(as.numeric(x$variance)[1], digits), "\n")
        cat(liner, "\n")
      }
    }
    mfn <- names(x$model.fit)
    step <- 5L
    for(i in 1L:length(mfn)) {
      if(!mfn[i] %in% c("model.name", "formula", "step.final.model")) { 
        if(!is.null(x$model.fit[[i]]) && x$model.fit[[i]] != "") {
          if(i < step)
            cat(mfn[i], "=", x$model.fit[[i]], " ")
          if(i == step) {
            if(i != length(mfn))
              cat("\n")
            cat(mfn[i], "=", x$model.fit[[i]], " ")
            step <- step + step
          }
        }
      }
    }
    cat("\n")
  }
  if(!is.null(x$model.fit$step.final.model)) {
    cat(liner,"\n")
    cat("Stepwise final model:\n")
    cat("-\n")
    cat(x$model.fit$step.final.model, "\n")
  }

  return(invisible(NULL))
}

.Random.seed <-
c(403L, 1L, 844839627L, -945939590L, -290231684L, -1734164801L, 
1544890261L, 78823340L, 1782840706L, 1941881693L, -898019753L, 
747441470L, 1659059576L, -490000805L, 1000999353L, -1522336760L, 
-536705354L, -46836239L, 1586244643L, 261219442L, 173389508L, 
892194951L, 871560285L, -490358188L, 374796410L, 1934545861L, 
-2060040929L, 1554859174L, -1609017808L, 1920601299L, -876207375L, 
201814560L, -606161730L, -836206391L, -1041431941L, -116701110L, 
1664055468L, 1125343151L, 2089388901L, -1231216356L, 122030450L, 
-934929939L, 831761959L, -28737970L, -1773313368L, -880205653L, 
-1275172407L, -1078516264L, 1717015686L, 1103182177L, 1790483699L, 
-1055562910L, 1485172180L, -1511839529L, -756335923L, -285128092L, 
1733853258L, 1380083125L, 1104201999L, 1067415062L, 130339008L, 
-826915197L, 38724257L, 931652752L, 820375406L, -1503434471L, 
1788389803L, 219899802L, -1958938788L, -1446828449L, 865121845L, 
-1067715124L, 1196184866L, 1163968381L, -1884466057L, -1999918690L, 
-778502056L, -1650549317L, -905079975L, -705748760L, 601301270L, 
-539196783L, 931082051L, -984692142L, 245873892L, 2118690599L, 
2122695549L, 1212020340L, 2136057946L, 409211045L, 549868223L, 
-1774155450L, 1888280528L, 1748605427L, -192154351L, -89804480L, 
1638080798L, -1235560983L, -386590949L, -867589846L, -2041710004L, 
1046504975L, 904546629L, 1061671676L, 866339154L, -1744216371L, 
-475744633L, -1908612754L, -713131192L, -1978908853L, 803899049L, 
199302136L, -236002522L, 1676575809L, -1575451181L, -1605392510L, 
-223122508L, 1056826167L, -1166089683L, 1042072388L, 1231382634L, 
-790048043L, -2038911889L, 2047141238L, 701337248L, 1903135587L, 
198451201L, -585766032L, -2096053490L, -112132743L, -1233381109L, 
1404160570L, -2055610052L, 1841098367L, -519227947L, 493759468L, 
-566932158L, 250360477L, -1426137321L, 1744125566L, -188072392L, 
1795442971L, 2114465401L, 373254856L, -1888773386L, 1463948081L, 
1801438051L, 1923062066L, 1361029764L, 827279047L, 1176997277L, 
-1887680236L, -306681926L, 1638158853L, 615187423L, 1888467558L, 
952251888L, -783912173L, 948804785L, -675668128L, 689945854L, 
-843080567L, 1314495419L, 1515713930L, 1742443628L, -1664897553L, 
-1288788443L, 788259548L, 2145958066L, 460127149L, -1993162905L, 
879979662L, -181540504L, -1712727701L, 860666633L, 1420742040L, 
9919686L, 241059361L, 836691635L, -109392862L, -1340877292L, 
1888635543L, -190012275L, -463099484L, -1830677622L, 902447093L, 
-1975423409L, 1756518742L, -341367808L, -843141821L, 335626465L, 
998578768L, 1599555246L, 1502442073L, 1096227435L, -912846886L, 
464335004L, -886070625L, -1431908107L, 72595852L, -1344687006L, 
854324285L, -758696265L, 385930590L, -1033503592L, 1024493563L, 
1102704025L, 786558504L, -1866467626L, 213517137L, -1772108285L, 
266176914L, -715131100L, 134068711L, -516827587L, -1130848076L, 
-419703014L, 1711365221L, -1189849857L, -460458618L, -792564976L, 
-1005162573L, -1495796655L, 1084348416L, 298477790L, 821887785L, 
-842555685L, 942435818L, -862562932L, 230290162L, 711495936L, 
-41438092L, 789461512L, 949674426L, -2015684144L, 248189932L, 
-1903757420L, -1076091694L, -1277054880L, 581753164L, 1225260832L, 
980812418L, 155955688L, -374275092L, 1138540092L, 581202546L, 
-1040713872L, 1335705892L, -499007944L, 931368346L, 1880724944L, 
1927295420L, -978298220L, -409954686L, -1906927168L, -64839876L, 
-886692208L, -2114952414L, -1517113848L, -1035016436L, 933576604L, 
-1710426094L, 1746281344L, 328826644L, -570726104L, 125769786L, 
1926973392L, 1213588076L, 1347380276L, 57846930L, 1229362528L, 
-2117336756L, 1511129568L, -572852318L, 192339880L, 201108620L, 
-1556616260L, 2097774706L, 198882288L, 240934980L, 421344344L, 
-1955354566L, 663928944L, 1364027964L, -576689388L, 99991234L, 
-697000224L, 1316349052L, 552480976L, 773735330L, -1689370072L, 
13393164L, 1589578684L, 1376775474L, -1876597568L, -783417804L, 
61687496L, 1101024954L, 1060505744L, 920546028L, -2092924332L, 
-1626806638L, 543816480L, -2077312052L, 816682208L, -1613866302L, 
608682024L, 1598448556L, 1706807996L, 411753970L, 196161072L, 
465455012L, -711957064L, 1182566234L, -586299248L, 1240449916L, 
-1401021676L, 1714774338L, 287916800L, 1903077308L, -1949121712L, 
-781423326L, 1456436808L, 1449412620L, 457533532L, -948194862L, 
792580608L, -1449387692L, -237255448L, 576765178L, -120643888L, 
59548972L, 1893804276L, -1034170990L, 987689312L, -627011572L, 
1639732960L, 896469602L, -1022712152L, -1711323572L, -635968644L, 
-1550162638L, 90019440L, -934991036L, -560241704L, -1079939206L, 
-56825296L, 481897404L, 1028280916L, -2023447486L, -83525472L, 
2104957628L, -1888666160L, 1074988898L, 1992346344L, -1912228660L, 
1767869948L, -1775748622L, -2135067008L, -2093124108L, -1577774456L, 
-2091008198L, -669319344L, -1691501460L, -578620012L, -1794866094L, 
-1281418784L, -467088180L, -1928722272L, 2050869634L, -858105624L, 
-122422548L, -1693784772L, 633087090L, -1914975120L, 1774580772L, 
-737406920L, 1336992538L, 454272208L, -1255992516L, -180224108L, 
704706434L, -2030080576L, 820490812L, 2113001872L, 1614205474L, 
1362939144L, 195060364L, 617989916L, 2116692114L, -591935104L, 
250513940L, 356934440L, -572318150L, -1832496688L, 2140271980L, 
-1785599052L, -1064244206L, -1512760864L, -1400751156L, 1388538080L, 
871129122L, -1967272664L, 1225141772L, -1472079044L, 1367073778L, 
1792605936L, -2061401532L, -763400616L, -2017443014L, 551404016L, 
-926552388L, -606794476L, -1678797118L, -1242310560L, -1280804996L, 
1246313424L, 2039565602L, -1201846616L, 505797516L, -1755231044L, 
170805042L, 1742338624L, 27439284L, 2050275912L, -1779913286L, 
-1227009520L, -1482377492L, -1943468716L, -154905326L, -396146272L, 
-481003828L, -954319264L, 573279170L, -1507800280L, -1068029012L, 
-293585092L, -754057870L, -40210640L, -1724525276L, -398314696L, 
-107335974L, 1406213008L, -313128196L, -1284721772L, -886751166L, 
2040361216L, -1499358148L, 98104656L, -137981790L, -1415035576L, 
370400012L, -490923300L, -1355382446L, -1205999488L, -1666585516L, 
-1375826987L, 1450593151L, 885222936L, 1985885494L, -2068706365L, 
-34434555L, -319788638L, -623710832L, 8101177L, -1791542805L, 
-201893156L, 512581386L, -416230913L, 1480341577L, 1760481758L, 
1395751308L, -762309283L, -178825881L, -1201273200L, -703027026L, 
-426145445L, 774364477L, -2123763798L, -1900074936L, 696778865L, 
-27406877L, 1162938596L, -1584987118L, 749989863L, -873179215L, 
1201342966L, 1318384660L, 1555671845L, 463268911L, -1460470296L, 
-656074042L, -951827597L, 268143573L, -1191578702L, 1179444608L, 
-899474071L, 1669321179L, 634403116L, 657505082L, 2012542447L, 
1423323257L, -47531250L, -1474384164L, -1443668659L, 592203959L, 
-621721024L, 1749586718L, 270572011L, 779113837L, -916112422L, 
-295850600L, -685501439L, -885176909L, -655913772L, 345692642L, 
-1380010889L, -265770559L, -24489146L, 1726922372L, -2185163L, 
-906282977L, 1457782648L, 2008643158L, -1276638493L, 482552997L, 
-846236350L, -1133821136L, 373270361L, 334458059L, 760192316L, 
133216618L, 951161759L, 874360361L, -665849666L, 1546865068L, 
-1663985923L, 812356167L, -2071527120L, -1604326834L, -300944773L, 
-232508963L, -814352374L, -379262680L, -668936303L, 1085389187L, 
-19245436L, -841759566L, 746525703L, 1270054993L, -456806442L, 
2085494452L, 1315765957L, 1717063695L, 1600536712L, -1786347098L, 
-605324973L, -1820489035L, -110436334L, 777646560L, 1296868425L, 
1414820475L, 319191884L, 1884925658L, -1768226097L, -1992645991L, 
472723118L, -899667012L, 927945773L, 518372311L, 725127712L, 
-1805012098L, 252075339L, -1296261299L, -1362889350L, 1964550072L, 
1220279649L, -792645357L, -549140172L, -1701035198L, -1921354921L, 
2029376161L, 1006904166L, 2106891620L, 137136277L, -2100213313L, 
1964383576L, -875519114L, 107110787L, -1887444027L, 958757090L, 
-1542177456L, 1119390841L, -561111125L, 119448860L, -1553788342L, 
-129558977L, -176690551L, 1430032030L, -1587008692L, -1463915747L, 
-1767834969L, -897084976L, -1679328914L, -880090085L, 935439741L, 
880225130L, -925880824L, -1274182991L, -1234801373L, -1717879260L, 
1292080338L, -1274522329L, 1546100593L, -1507656266L, 573130068L, 
-1975819291L, -141992465L, -185383640L, 987698566L, 1534292403L, 
-488706795L, -458002574L, -1625261120L, 2103626793L, 636499034L
)
