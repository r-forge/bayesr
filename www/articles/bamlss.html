<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Lego Toolbox for Flexible Bayesian Regression (and Beyond) • bamlss</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A Lego Toolbox for Flexible Bayesian Regression (and Beyond)">
<meta property="og:description" content="bamlss">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bamlss</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2-4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bamlss.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/terms.html">Available Model Terms</a>
    </li>
    <li>
      <a href="../articles/families.html">Families</a>
    </li>
    <li>
      <a href="../articles/bf.html">BAMLSS Model Frame</a>
    </li>
    <li>
      <a href="../articles/engines.html">Estimation Engines</a>
    </li>
    <li>
      <a href="../articles/distregvis.html">Visualization with distreg.vis</a>
    </li>
    <li>
      <a href="../articles/glm.html">Generalized Linear Models (+)</a>
    </li>
    <li>
      <a href="../articles/multinomial.html">Bayesian Multinomial Regression</a>
    </li>
    <li>
      <a href="../articles/rent.html">Munich Rent Example</a>
    </li>
    <li>
      <a href="../articles/zn.html">Spatial Location-Scale Model</a>
    </li>
    <li>
      <a href="../articles/fatalities.html">Fatalities Model for Austria</a>
    </li>
    <li>
      <a href="../articles/mvnorm.html">Multivariate Normal Model</a>
    </li>
    <li>
      <a href="../articles/misc.html">Miscellaneous Topics</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Publications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/jm.html">Bayesian Joint Models for Longitudinal and Survival Data</a>
    </li>
    <li>
      <a href="../articles/bivnorm.html">Bivariate Gaussian Models for Wind Vectors</a>
    </li>
    <li>
      <a href="../articles/cox.html">Complex Space-Time Interactions in a Cox Model</a>
    </li>
    <li>
      <a href="../articles/lasso.html">LASSO-Type Penalization in the Framework of GAMLSS</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="bamlss_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A Lego Toolbox for Flexible Bayesian Regression (and Beyond)</h1>
                        <h4 data-toc-skip class="author">Nikolaus Umlauf, Nadja Klein, Achim Zeileis, Thorsten Simon</h4>
            
      
      
      <div class="hidden name"><code>bamlss.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The R package <em>bamlss</em> provides a modular computational framework for flexible Bayesian regression models (and beyond). The implementation follows the conceptional framework presented in <span class="citation">Umlauf, Klein, and Zeileis (2018)</span> and provides a modular “Lego toolbox” for setting up regression models. In this setting not only the response distribution or the regression terms are “Lego bricks” but also the estimation algorithm or the MCMC sampler.</p>
<p>The highlights of the package are:</p>
<ul>
<li>The usual R “look &amp; feel” for regression modeling.</li>
<li>Estimation of classic (GAM-type) regression models (Bayesian or frequentist).</li>
<li>Estimation of flexible (GAMLSS-type) distributional regression models.</li>
<li>An extensible “plug &amp; play” approach for regression terms.</li>
<li>Modular combinations of fitting algorithms and samplers.</li>
</ul>
<p>Especially the last item is notable because the models in <em>bamlss</em> are not limited to a specific estimation algorithm but different engines can be plugged in without necessitating changes in other aspects of the model specification.</p>
<p>More detailed overviews and examples are provided in the articles:</p>
<ul>
<li><p><a href="http://www.bamlss.org/articles/terms.html" class="external-link">Available Model Terms</a></p></li>
<li><p><a href="http://www.bamlss.org/articles/families.html" class="external-link">BAMLSS Families</a></p></li>
<li><p><a href="http://www.bamlss.org/articles/bf.html" class="external-link">BAMLSS Model Frame</a></p></li>
<li><p><a href="http://www.bamlss.org/articles/engines.html" class="external-link">Estimation Engines</a></p></li>
<li><p><a href="http://www.bamlss.org/articles/distregvis.html" class="external-link">Visualization with distreg.vis</a></p></li>
<li><p><a href="http://www.bamlss.org/articles/jm.html" class="external-link">Bayesian Joint Models for Longitudinal and Survival Data</a></p></li>
<li><p><a href="http://www.bamlss.org/articles/multinomial.html" class="external-link">Bayesian Multinomial Regression</a></p></li>
<li><p><a href="http://www.bamlss.org/articles/bivnorm.html" class="external-link">Bivariate Gaussian models for wind vectors</a></p></li>
<li><p><a href="http://www.bamlss.org/articles/cox.html" class="external-link">Complex Space-Time Interactions in a Cox Model</a></p></li>
<li><p><a href="http://www.bamlss.org/articles/glm.html" class="external-link">Generalized Linear Models (+)</a></p></li>
<li><p><a href="http://www.bamlss.org/articles/lasso.html" class="external-link">LASSO-Type Penalization in the Framework of Generalized Additive Models for Location, Scale and Shape</a></p></li>
<li><p><a href="http://www.bamlss.org/articles/rent.html" class="external-link">Munich Rent Model</a></p></li>
<li><p><a href="http://www.bamlss.org/articles/zn.html" class="external-link">Spatial Location-Scale Model</a></p></li>
<li><p><a href="http://www.bamlss.org/articles/fatalities.html" class="external-link">Fatalities Model for Austria</a></p></li>
<li><p><a href="http://www.bamlss.org/articles/mvnorm.html" class="external-link">Multivariate Normal Model</a></p></li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The stable release version of <em>bamlss</em> is hosted on the Comprehensive R Archive Network (CRAN) at <a href="https://CRAN.R-project.org/package=bamlss" class="external-link uri">https://CRAN.R-project.org/package=bamlss</a> and can be installed via</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"bamlss"</span><span class="op">)</span></span></code></pre></div>
<p>The development version of <em>bamlss</em> is hosted on R-Forge at <a href="https://R-Forge.R-project.org/projects/bayesr/" class="external-link uri">https://R-Forge.R-project.org/projects/bayesr/</a> in a Subversion (SVN) repository. It can be installed via</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"bamlss"</span>, repos <span class="op">=</span> <span class="st">"http://R-Forge.R-project.org"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-bayesian-regression">Basic Bayesian regression<a class="anchor" aria-label="anchor" href="#basic-bayesian-regression"></a>
</h2>
<p>This section gives a first quick overview of the functionality of the package and demonstrates that the usual “look &amp; feel” when using well-established model fitting functions like <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> is an elementary part of <em>bamlss</em>, i.e., first steps and basic handling of the package should be relatively simple. We illustrate the first steps with <em>bamlss</em> using a data set taken from the <em>Regression Book</em> <span class="citation">(Fahrmeir et al. 2013)</span> which is about prices of used VW Golf cars. The data is loaded with</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Golf"</span>, package <span class="op">=</span> <span class="st">"bamlss"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Golf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   price age kilometer tia abs sunroof</span></span>
<span><span class="co">## 1  7.30  73        10  12 yes     yes</span></span>
<span><span class="co">## 2  3.85 115        30  20 yes      no</span></span>
<span><span class="co">## 3  2.95 127        43   6  no     yes</span></span>
<span><span class="co">## 4  4.80 104        54  25 yes     yes</span></span>
<span><span class="co">## 5  6.20  86        57  23  no      no</span></span>
<span><span class="co">## 6  5.90  74        57  25 yes      no</span></span></code></pre>
<p>In this example the aim is to model the <code>price</code> in 1000 Euro. Using <em>bamlss</em> a first Bayesian linear model could be set up by first specifying a model formula</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="va">price</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">kilometer</span> <span class="op">+</span> <span class="va">tia</span> <span class="op">+</span> <span class="va">abs</span> <span class="op">+</span> <span class="va">sunroof</span></span></code></pre></div>
<p>afterwards the fully Bayesian model using MCMC simulation is estimated by</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://www.bamlss.org/" class="external-link">"bamlss"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">111</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">f</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, data <span class="op">=</span> <span class="va">Golf</span><span class="op">)</span></span></code></pre></div>
<p>Note that the default number of iterations for the MCMC sampler is 1200, the burnin-phase is 200 and thinning is 1 (see the manual of the default MCMC sampler <code><a href="http://www.bamlss.org/reference/GMCMC.html" class="external-link">sam_GMCMC()</a></code>). The reason is that during the modeling process, users usually want to obtain first results rather quickly. Afterwards, if a final model is estimated the number of iterations of the sampler is usually set much higher to get close to i.i.d. samples from the posterior distribution. To obtain reasonable starting values for the MCMC sampler we run a backfitting algorithm that optimizes the posterior mode. The <em>bamlss</em> package uses its own family objects, which can be specified as characters using the <code><a href="http://www.bamlss.org/reference/bamlss.html" class="external-link">bamlss()</a></code> wrapper, in this case <code>family = "gaussian"</code> (see also <a href="http://www.bamlss.org/articles/families.html" class="external-link">BAMLSS Families</a>). In addition, the package also supports all families provided from the <a href="https://cran.r-project.org/package=gamlss.dist" title="CRAN gamlss.dist" class="external-link"><em>gamlss</em> families</a>.</p>
<p>The model summary gives</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">b1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## bamlss(formula = f, family = "gaussian", data = Golf)</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Family: gaussian </span></span>
<span><span class="co">## Link function: mu = identity, sigma = log</span></span>
<span><span class="co">## *---</span></span>
<span><span class="co">## Formula mu:</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## price ~ age + kilometer + tia + abs + sunroof</span></span>
<span><span class="co">## -</span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##                  Mean      2.5%       50%     97.5% parameters</span></span>
<span><span class="co">## (Intercept)  9.333318  8.526293  9.330200 10.173709      9.311</span></span>
<span><span class="co">## age         -0.038461 -0.045355 -0.038341 -0.031706     -0.038</span></span>
<span><span class="co">## kilometer   -0.009686 -0.012547 -0.009667 -0.007061     -0.010</span></span>
<span><span class="co">## tia         -0.005811 -0.022870 -0.005752  0.010105     -0.005</span></span>
<span><span class="co">## absyes      -0.240481 -0.492048 -0.237776 -0.003060     -0.238</span></span>
<span><span class="co">## sunroofyes  -0.024021 -0.300878 -0.025127  0.238145     -0.010</span></span>
<span><span class="co">## -</span></span>
<span><span class="co">## Acceptance probability:</span></span>
<span><span class="co">##       Mean 2.5% 50% 97.5%</span></span>
<span><span class="co">## alpha    1    1   1     1</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Formula sigma:</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## sigma ~ 1</span></span>
<span><span class="co">## -</span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##                Mean    2.5%     50%   97.5% parameters</span></span>
<span><span class="co">## (Intercept) -0.2457 -0.3479 -0.2465 -0.1274     -0.271</span></span>
<span><span class="co">## -</span></span>
<span><span class="co">## Acceptance probability:</span></span>
<span><span class="co">##         Mean   2.5%    50% 97.5%</span></span>
<span><span class="co">## alpha 0.9703 0.7652 1.0000     1</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Sampler summary:</span></span>
<span><span class="co">## -</span></span>
<span><span class="co">## DIC = 408.9675 logLik = -201.0372 pd = 6.8932</span></span>
<span><span class="co">## runtime = 1.006</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Optimizer summary:</span></span>
<span><span class="co">## -</span></span>
<span><span class="co">## AICc = 409.6319 edf = 7 logLik = -197.4745</span></span>
<span><span class="co">## logPost = -252.2614 nobs = 172 runtime = 0.012</span></span></code></pre>
<p>indicating high acceptance rates as reported by the <code>alpha</code> parameter in the linear model output, which is a sign of good mixing of the MCMC chains. The mixing can also be inspected graphically by</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b1</span>, which <span class="op">=</span> <span class="st">"samples"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bamlss_files/figure-html/unnamed-chunk-6-1.png" width="864" style="display: block; margin: auto;"> Note, for convenience we only show the traceplots of the intercepts. Considering significance of the estimated effects, only variables <code>tia</code> and <code>sunroof</code> seem to have no effect on <code>price</code> since the credible intervals of estimated parameters contain zero. This information can also be extracted using the implemented <code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code> method.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">b1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                          2.5%        97.5%</span></span>
<span><span class="co">## mu.(Intercept)     8.52629257 10.173709336</span></span>
<span><span class="co">## mu.age            -0.04535461 -0.031705531</span></span>
<span><span class="co">## mu.kilometer      -0.01254739 -0.007060627</span></span>
<span><span class="co">## mu.tia            -0.02286985  0.010105028</span></span>
<span><span class="co">## mu.absyes         -0.49204765 -0.003060006</span></span>
<span><span class="co">## mu.sunroofyes     -0.30087769  0.238144948</span></span>
<span><span class="co">## sigma.(Intercept) -0.34791813 -0.127380063</span></span></code></pre>
<p>Since the prices cannot be negative, a possible consideration is to use a logarithmic transformation of the response <code>price</code></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">111</span><span class="op">)</span></span>
<span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">kilometer</span> <span class="op">+</span> <span class="va">tia</span> <span class="op">+</span> <span class="va">abs</span> <span class="op">+</span> <span class="va">sunroof</span></span>
<span></span>
<span><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">f</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, data <span class="op">=</span> <span class="va">Golf</span><span class="op">)</span></span></code></pre></div>
<p>and compare the models using the <code><a href="http://www.bamlss.org/reference/predict.bamlss.html" class="external-link">predict()</a></code> method</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">b1</span>, model <span class="op">=</span> <span class="st">"mu"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">b2</span>, model <span class="op">=</span> <span class="st">"mu"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">Golf</span><span class="op">$</span><span class="va">price</span> <span class="op">-</span> <span class="va">p1</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.5818444</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">Golf</span><span class="op">$</span><span class="va">price</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.5410859</span></span></code></pre>
<p>indicating that the transformation seems to improve the model fit.</p>
<p>Instead of using linear effects, another option would be to use polynomial regression for covariates <code>age</code>, <code>kilometer</code> and <code>tia</code>. A polynomial model using polynomials of order 3 is estimated with</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">222</span><span class="op">)</span></span>
<span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">age</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">kilometer</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">tia</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="va">abs</span> <span class="op">+</span> <span class="va">sunroof</span></span>
<span></span>
<span><span class="va">b3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">f</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, data <span class="op">=</span> <span class="va">Golf</span><span class="op">)</span></span></code></pre></div>
<p>Comparing the models using the <code><a href="http://www.bamlss.org/reference/DIC.html" class="external-link">DIC()</a></code> function</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/DIC.html">DIC</a></span><span class="op">(</span><span class="va">b2</span>, <span class="va">b3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          DIC        pd</span></span>
<span><span class="co">## b2 -15.19596  6.893153</span></span>
<span><span class="co">## b3 -10.78925 13.186991</span></span></code></pre>
<p>suggests that the polynomial model is slightly better. The effects can be inspected graphically, to better understand their influence on <code>price</code>. Using the polynomial model, graphical inspections can be done using the <code><a href="http://www.bamlss.org/reference/predict.bamlss.html" class="external-link">predict()</a></code> method.</p>
<p>One major difference compared to other regression model implementations is that predictions can be made for single variables, only, where the user does not have to create a new data frame containing all variables. For example, posterior mean estimates and 95% credible intervals for variable <code>age</code> can be obtained by</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"age"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">Golf</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">Golf</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nd</span><span class="op">$</span><span class="va">page</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">b3</span>, newdata <span class="op">=</span> <span class="va">nd</span>, model <span class="op">=</span> <span class="st">"mu"</span>, term <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>  FUN <span class="op">=</span> <span class="va">c95</span>, intercept <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        age page.2.5% page.Mean page.97.5%</span></span>
<span><span class="co">## 1 65.00000 0.3085312 0.4849915  0.6592331</span></span>
<span><span class="co">## 2 65.77778 0.3120472 0.4757206  0.6362999</span></span>
<span><span class="co">## 3 66.55556 0.3167776 0.4663256  0.6152946</span></span>
<span><span class="co">## 4 67.33333 0.3172396 0.4568109  0.5950657</span></span>
<span><span class="co">## 5 68.11111 0.3201536 0.4471811  0.5742218</span></span>
<span><span class="co">## 6 68.88889 0.3202023 0.4374406  0.5555146</span></span></code></pre>
<p>Note that the prediction does not include the model intercept. Similarly for variables <code>kilometer</code> and <code>tia</code></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nd</span><span class="op">$</span><span class="va">kilometer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">Golf</span><span class="op">$</span><span class="va">kilometer</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">Golf</span><span class="op">$</span><span class="va">kilometer</span><span class="op">)</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">nd</span><span class="op">$</span><span class="va">tia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">Golf</span><span class="op">$</span><span class="va">tia</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">Golf</span><span class="op">$</span><span class="va">tia</span><span class="op">)</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nd</span><span class="op">$</span><span class="va">pkilometer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">b3</span>, newdata <span class="op">=</span> <span class="va">nd</span>, model <span class="op">=</span> <span class="st">"mu"</span>, term <span class="op">=</span> <span class="st">"kilometer"</span>,</span>
<span>  FUN <span class="op">=</span> <span class="va">c95</span>, intercept <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">nd</span><span class="op">$</span><span class="va">ptia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">b3</span>, newdata <span class="op">=</span> <span class="va">nd</span>, model <span class="op">=</span> <span class="st">"mu"</span>, term <span class="op">=</span> <span class="st">"tia"</span>,</span>
<span>  FUN <span class="op">=</span> <span class="va">c95</span>, intercept <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Here, we need to specify for which <code>model</code> predictions should be calculated, and if predictions only for variable <code>age</code> are created, argument <code>term</code> needs also be specified. Argument <code>FUN</code> can be any function that should be applied on the samples of the linear predictor. For more examples see the documentation of the <code><a href="http://www.bamlss.org/reference/predict.bamlss.html" class="external-link">predict.bamlss()</a></code> method.</p>
<p>Then, the estimated effects can be visualized with</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nd</span><span class="op">$</span><span class="va">page</span>, <span class="va">nd</span><span class="op">$</span><span class="va">pkilometer</span>, <span class="va">nd</span><span class="op">$</span><span class="va">ptia</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot2d.html">plot2d</a></span><span class="op">(</span><span class="va">page</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">nd</span>, ylim <span class="op">=</span> <span class="va">ylim</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot2d.html">plot2d</a></span><span class="op">(</span><span class="va">pkilometer</span> <span class="op">~</span> <span class="va">kilometer</span>, data <span class="op">=</span> <span class="va">nd</span>, ylim <span class="op">=</span> <span class="va">ylim</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot2d.html">plot2d</a></span><span class="op">(</span><span class="va">ptia</span> <span class="op">~</span> <span class="va">tia</span>, data <span class="op">=</span> <span class="va">nd</span>, ylim <span class="op">=</span> <span class="va">ylim</span><span class="op">)</span></span></code></pre></div>
<p><img src="bamlss_files/figure-html/unnamed-chunk-15-1.png" width="100%" style="display: block; margin: auto;"> The figure clearly shows the negative effect on the logarithmic <code>price</code> for variable <code>age</code> and <code>kilometer</code>. The effect of <code>tia</code> is not significant according the 95% credible intervals, since the interval always contains the zero horizontal line.</p>
</div>
<div class="section level2">
<h2 id="location-scale-model">Location-scale model<a class="anchor" aria-label="anchor" href="#location-scale-model"></a>
</h2>
<p>As a second startup on how to use <em>bamlss</em> for full distributional regression, we illustrate the basic steps on a small textbook example using the well-known simulated motorcycle accident data <span class="citation">(Silverman 1985)</span>. The data contain measurements of the head acceleration (in <span class="math inline">\(g\)</span>, variable <code>accel</code>) in a simulated motorcycle accident, recorded in milliseconds after impact (variable <code>times</code>).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mcycle"</span>, package <span class="op">=</span> <span class="st">"MASS"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mcycle</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   times accel</span></span>
<span><span class="co">## 1   2.4   0.0</span></span>
<span><span class="co">## 2   2.6  -1.3</span></span>
<span><span class="co">## 3   3.2  -2.7</span></span>
<span><span class="co">## 4   3.6   0.0</span></span>
<span><span class="co">## 5   4.0  -2.7</span></span>
<span><span class="co">## 6   6.2  -2.7</span></span></code></pre>
<p>To estimate a Gaussian location-scale model with <span class="math display">\[
\texttt{accel} \sim \mathcal{N}(\mu = f(\texttt{times}), \log(\sigma) = f(\texttt{times}))
\]</span> we use the following model formula</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">accel</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">times</span>, k <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>, <span class="va">sigma</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">times</span>, k <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>where <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s()</a></code> is the smooth term constructor from the <em>mgcv</em> <span class="citation">(Wood 2020)</span>. Note, that formulae are provided as <code>list</code>s of formulae, i.e., each list entry represents one parameter of the response distribution. Also note that all smooth terms, i.e., <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">te()</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">ti()</a></code>, etc., are supported by <em>bamlss</em>. This way, it is also possible to incorporate user defined model terms. A fully Bayesian model is the estimated with</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">mcycle</span>, family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span></code></pre></div>
<p>using the default of 1200 iterations of the MCMC sampler to obtain first results quickly (see the documentation <code><a href="http://www.bamlss.org/reference/GMCMC.html" class="external-link">sam_GMCMC()</a></code> for further details on tuning parameters). Note that per default <code><a href="http://www.bamlss.org/reference/bamlss.html" class="external-link">bamlss()</a></code> uses a backfitting algorithm to compute posterior mode estimates, afterwards these estimates are used as starting values for the MCMC chains. The returned object is of class <code>"bamlss"</code> for which generic extractor functions like <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>, <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code>, etc., are provided. For example, the estimated effects for distribution parameters <code>mu</code> and <code>sigma</code> can be visualized by</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span>, model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mu"</span>, <span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="bamlss_files/figure-html/unnamed-chunk-20-1.png" width="80%" style="display: block; margin: auto;"> The model summary gives</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## bamlss(formula = f, family = "gaussian", data = mcycle)</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Family: gaussian </span></span>
<span><span class="co">## Link function: mu = identity, sigma = log</span></span>
<span><span class="co">## *---</span></span>
<span><span class="co">## Formula mu:</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## accel ~ s(times, k = 20)</span></span>
<span><span class="co">## -</span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##               Mean   2.5%    50%  97.5% parameters</span></span>
<span><span class="co">## (Intercept) -25.13 -29.36 -25.35 -20.34     -25.14</span></span>
<span><span class="co">## -</span></span>
<span><span class="co">## Acceptance probability:</span></span>
<span><span class="co">##       Mean 2.5% 50% 97.5%</span></span>
<span><span class="co">## alpha    1    1   1     1</span></span>
<span><span class="co">## -</span></span>
<span><span class="co">## Smooth terms:</span></span>
<span><span class="co">##                     Mean      2.5%       50%     97.5% parameters</span></span>
<span><span class="co">## s(times).tau21 425657.47 175634.81 372121.15 914429.32   209325.0</span></span>
<span><span class="co">## s(times).alpha      1.00      1.00      1.00      1.00         NA</span></span>
<span><span class="co">## s(times).edf       14.24     12.64     14.22     15.97       13.6</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Formula sigma:</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## sigma ~ s(times, k = 20)</span></span>
<span><span class="co">## -</span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##              Mean  2.5%   50% 97.5% parameters</span></span>
<span><span class="co">## (Intercept) 2.680 2.549 2.676 2.831      2.581</span></span>
<span><span class="co">## -</span></span>
<span><span class="co">## Acceptance probability:</span></span>
<span><span class="co">##         Mean   2.5%    50% 97.5%</span></span>
<span><span class="co">## alpha 0.9664 0.7510 1.0000     1</span></span>
<span><span class="co">## -</span></span>
<span><span class="co">## Smooth terms:</span></span>
<span><span class="co">##                     Mean      2.5%       50%     97.5% parameters</span></span>
<span><span class="co">## s(times).tau21 1.458e+02 2.384e+01 1.213e+02 4.604e+02     81.406</span></span>
<span><span class="co">## s(times).alpha 5.385e-01 7.903e-04 5.069e-01 1.000e+00         NA</span></span>
<span><span class="co">## s(times).edf   9.415e+00 6.491e+00 9.500e+00 1.259e+01      8.675</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Sampler summary:</span></span>
<span><span class="co">## -</span></span>
<span><span class="co">## DIC = 1115.068 logLik = -545.2265 pd = 24.6149</span></span>
<span><span class="co">## runtime = 2.414</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Optimizer summary:</span></span>
<span><span class="co">## -</span></span>
<span><span class="co">## AICc = 1123.881 edf = 24.2717 logLik = -531.975</span></span>
<span><span class="co">## logPost = -747.4106 nobs = 133 runtime = 0.238</span></span></code></pre>
<p>showing, e.g., the acceptance probabilities of the MCMC chains (<code>alpha</code>), the estimated degrees of freedom of the optimizer and the successive sampler (<code>edf</code>), the final AIC and DIC as well as parametric model coefficients (in this case only the intercepts). As mentioned in the first example, using MCMC involves convergence checks of the sampled parameters. The easiest diagnostics are traceplots</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span>, which <span class="op">=</span> <span class="st">"samples"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bamlss_files/figure-html/unnamed-chunk-23-1.png" width="864" style="display: block; margin: auto;"> Note again that this call would show all traceplots, for convenience we only show the plots for the intercepts. In this case, the traceplots do not indicate convergence of the Markov chains for parameter <code>"mu"</code>. To fix this, the number of iterations can be increased and also the burnin and thinning parameters can be adapted (see <code><a href="http://www.bamlss.org/reference/GMCMC.html" class="external-link">sam_GMCMC()</a></code>). Further inspections are the maximum autocorrelation of all parameters, using <code><a href="http://www.bamlss.org/reference/plot.bamlss.html" class="external-link">plot.bamlss()</a></code> setting argument <code>which = "max-acf"</code>, besides other convergence diagnostics, e.g., diagnostics that are part of the <em>coda</em> package <span class="citation">(Plummer et al. 2006)</span>.</p>
<p>Inspecting randomized quantile residuals <span class="citation">(Dunn and Smyth 1996)</span> is useful for judging how well the model fits to the data</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hist-resid"</span>, <span class="st">"qq-resid"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="bamlss_files/figure-html/unnamed-chunk-25-1.png" width="80%" style="display: block; margin: auto;"> Randomized quantile residuals are the default method in <em>bamlss</em>, which are computed using the CDF function of the corresponding family object.</p>
<p>The posterior mean including 95% credible intervals for new data based on MCMC samples for parameter <span class="math inline">\(\mu\)</span> can be computed by</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"times"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2.4</span>, <span class="fl">57.6</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nd</span><span class="op">$</span><span class="va">ptimes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">b</span>, newdata <span class="op">=</span> <span class="va">nd</span>, model <span class="op">=</span> <span class="st">"mu"</span>, FUN <span class="op">=</span> <span class="va">c95</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot2d.html">plot2d</a></span><span class="op">(</span><span class="va">ptimes</span> <span class="op">~</span> <span class="va">times</span>, data <span class="op">=</span> <span class="va">nd</span><span class="op">)</span></span></code></pre></div>
<p><img src="bamlss_files/figure-html/unnamed-chunk-27-1.png" width="50%" style="display: block; margin: auto;"> and as above in the first example, argument <code>FUN</code> can be any function, e.g., the <code><a href="https://rdrr.io/r/base/identity.html" class="external-link">identity()</a></code> function could be used to calculate other statistics of the distribution, e.g., plot the estimated densities for each iteration of the MCMC sampler for <code>times = 10</code> and <code>times = 40</code>:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Predict for the two scenarios.</span></span>
<span><span class="va">nd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"times"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ptimes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">b</span>, newdata <span class="op">=</span> <span class="va">nd</span>, FUN <span class="op">=</span> <span class="va">identity</span>, type <span class="op">=</span> <span class="st">"parameter"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Extract the family object.</span></span>
<span><span class="va">fam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">family</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Compute densities.</span></span>
<span><span class="va">dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"t10"</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="st">"t40"</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">ptimes</span><span class="op">$</span><span class="va">mu</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">## Densities for times = 10.</span></span>
<span>  <span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"mu"</span> <span class="op">=</span> <span class="va">ptimes</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span><span class="fl">1</span>, <span class="va">i</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span>,</span>
<span>    <span class="st">"sigma"</span> <span class="op">=</span> <span class="va">ptimes</span><span class="op">$</span><span class="va">sigma</span><span class="op">[</span><span class="fl">1</span>, <span class="va">i</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">dens</span><span class="op">$</span><span class="va">t10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">dens</span><span class="op">$</span><span class="va">t10</span>, <span class="va">fam</span><span class="op">$</span><span class="fu">d</span><span class="op">(</span><span class="va">mcycle</span><span class="op">$</span><span class="va">accel</span>, <span class="va">par</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">## Densities for times = 40.</span></span>
<span>  <span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"mu"</span> <span class="op">=</span> <span class="va">ptimes</span><span class="op">$</span><span class="va">mu</span><span class="op">[</span><span class="fl">2</span>, <span class="va">i</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span>,</span>
<span>    <span class="st">"sigma"</span> <span class="op">=</span> <span class="va">ptimes</span><span class="op">$</span><span class="va">sigma</span><span class="op">[</span><span class="fl">2</span>, <span class="va">i</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">dens</span><span class="op">$</span><span class="va">t40</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">dens</span><span class="op">$</span><span class="va">t40</span>, <span class="va">fam</span><span class="op">$</span><span class="fu">d</span><span class="op">(</span><span class="va">mcycle</span><span class="op">$</span><span class="va">accel</span>, <span class="va">par</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Visualize.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/rainbow_hcl.html" class="external-link">rainbow_hcl</a></span><span class="op">(</span><span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot2d.html">plot2d</a></span><span class="op">(</span><span class="va">dens</span><span class="op">$</span><span class="va">t10</span> <span class="op">~</span> <span class="va">accel</span>, data <span class="op">=</span> <span class="va">mcycle</span>,</span>
<span>  col.lines <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, ylab <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot2d.html">plot2d</a></span><span class="op">(</span><span class="va">dens</span><span class="op">$</span><span class="va">t40</span> <span class="op">~</span> <span class="va">accel</span>, data <span class="op">=</span> <span class="va">mcycle</span>,</span>
<span>  col.lines <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="bamlss_files/figure-html/unnamed-chunk-28-1.png" width="50%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references hanging-indent">
<div id="ref-bamlss:Dunn+Gordon:1996">
<p>Dunn, Peter K., and Gordon K. Smyth. 1996. “Randomized Quantile Residuals.” <em>Journal of Computational and Graphical Statistics</em> 5 (3): 236–44.</p>
</div>
<div id="ref-bamlss:Fahrmeir+Kneib+Lang+Marx:2013">
<p>Fahrmeir, Ludwig, Thomas Kneib, Stefan Lang, and Brian Marx. 2013. <em>Regression – Models, Methods and Applications</em>. Berlin: Springer-Verlag.</p>
</div>
<div id="ref-bamlss:Plummer+Best+Cowles+Vines:2006">
<p>Plummer, Martyn, Nicky Best, Kate Cowles, and Karen Vines. 2006. “coda: Convergence Diagnosis and Output Analysis for MCMC.” <em>R News</em> 6 (1): 7–11. <a href="https://doi.org/10.18637/jss.v021.i11" class="external-link">https://doi.org/10.18637/jss.v021.i11</a>.</p>
</div>
<div id="ref-bamlss:Silverman:1985">
<p>Silverman, B. W. 1985. “Some Aspects of the Spline Smoothing Approach to Non-Parametric Regression Curve Fitting.” <em>Journal of the Royal Statistical Society. Series B (Methodological)</em> 47 (1): 1–52.</p>
</div>
<div id="ref-bamlss:Umlauf+Klein+Zeileis:2017">
<p>Umlauf, Nikolaus, Nadja Klein, and Achim Zeileis. 2018. “BAMLSS: Bayesian Additive Models for Location, Scale and Shape (and Beyond).” <em>Journal of Computational and Graphical Statistics</em> 27 (3): 612–27. <a href="https://doi.org/10.1080/10618600.2017.1407325" class="external-link">https://doi.org/10.1080/10618600.2017.1407325</a>.</p>
</div>
<div id="ref-bamlss:Umlauf+bamlss:2021">
<p>Umlauf, Nikolaus, Nadja Klein, Achim Zeileis, and Thorsten Simon. 2021. “bamlss: Bayesian Additive Models for Location Scale and Shape (and Beyond).” <em>Journal of Statistical Software</em> 100 (4): 1–53. <a href="https://doi.org/10.18637/jss.v100.i04" class="external-link">https://doi.org/10.18637/jss.v100.i04</a>.</p>
</div>
<div id="ref-bamlss:Umlauf+bamlss:2018">
<p>———. 2024. <em>bamlss: Bayesian Additive Models for Location Scale and Shape (and Beyond)</em>. <a href="https://CRAN.R-project.org/package=bamlss" class="external-link">https://CRAN.R-project.org/package=bamlss</a>.</p>
</div>
<div id="ref-bamlss:Wood:2018">
<p>Wood, S. N. 2020. <em>mgcv: GAMs with Gcv/Aic/Reml Smoothness Estimation and Gamms by Pql</em>. <a href="https://CRAN.R-project.org/package=mgcv" class="external-link">https://CRAN.R-project.org/package=mgcv</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nikolaus Umlauf, Nadja Klein, Achim Zeileis, Thorsten Simon.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
