<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BAMLSS Families • bamlss</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="BAMLSS Families">
<meta property="og:description" content="bamlss">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bamlss</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2-4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bamlss.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/terms.html">Available Model Terms</a>
    </li>
    <li>
      <a href="../articles/families.html">Families</a>
    </li>
    <li>
      <a href="../articles/bf.html">BAMLSS Model Frame</a>
    </li>
    <li>
      <a href="../articles/engines.html">Estimation Engines</a>
    </li>
    <li>
      <a href="../articles/distregvis.html">Visualization with distreg.vis</a>
    </li>
    <li>
      <a href="../articles/glm.html">Generalized Linear Models (+)</a>
    </li>
    <li>
      <a href="../articles/multinomial.html">Bayesian Multinomial Regression</a>
    </li>
    <li>
      <a href="../articles/rent.html">Munich Rent Example</a>
    </li>
    <li>
      <a href="../articles/zn.html">Spatial Location-Scale Model</a>
    </li>
    <li>
      <a href="../articles/fatalities.html">Fatalities Model for Austria</a>
    </li>
    <li>
      <a href="../articles/mvnorm.html">Multivariate Normal Model</a>
    </li>
    <li>
      <a href="../articles/misc.html">Miscellaneous Topics</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Publications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/jm.html">Bayesian Joint Models for Longitudinal and Survival Data</a>
    </li>
    <li>
      <a href="../articles/bivnorm.html">Bivariate Gaussian Models for Wind Vectors</a>
    </li>
    <li>
      <a href="../articles/cox.html">Complex Space-Time Interactions in a Cox Model</a>
    </li>
    <li>
      <a href="../articles/lasso.html">LASSO-Type Penalization in the Framework of GAMLSS</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="families_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>BAMLSS Families</h1>
            
      
      
      <div class="hidden name"><code>families.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Family objects are important building blocks in the design of BAMLSS models. They specify the distribution by collecting functions of the density, respective log-likelihood, first-order derivatives of the log-likelihood w.r.t. predictors (the score function), and (optionally) second-order derivatives of the log-likelihood w.r.t. predictors <em>or</em> their expectation (the Hessian).</p>
<p>The <em>bamlss</em> package can be easily extended by <a href="#build">constructing families</a> for specific tasks, i.e. problems for which a likelihood can be formulated. However, the most important distributions are <a href="#avail">shipped with <em>bamlss</em></a>. Finally, it is also possible to employ <a href="#gamlss"><em>gamlss</em> families</a>.</p>
</div>
<div class="section level2">
<h2 id="build">How to build a <em>bamlss</em> family<a class="anchor" aria-label="anchor" href="#build"></a>
</h2>
<p>We illustrate how to build a <em>bamlss</em> family <em>by hand</em> along the Gaussian distribution, with density <span class="math display">\[
f(y\,|\,\mu,\sigma) = \frac{1}{\sqrt{2\pi}\sigma} \cdot \exp
\left( \frac{-(y-\mu)^2}{2\sigma^2} \right),
\]</span> and log-likelihood function <span class="math display">\[
\ell(\mu,\sigma\,|\,y) = - \frac{1}{2} \log(2\pi) - \log(\sigma) -
\frac{(y-\mu)^2}{2\sigma^2},
\]</span> for an individual observation. The sum of the log-likelihood function over all observations is the target function of the optimization problem.</p>
<p>In the distributional regression framework the parameters are linked to predictors by link functions, <span class="math display">\[
\mu = \eta_\mu, \qquad \log(\sigma) = \eta_\sigma.
\]</span> For the Gaussian <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are linked to <span class="math inline">\(\eta_\mu\)</span> and <span class="math inline">\(\eta_\sigma\)</span> by the identity function and the logarithm, respectively.</p>
<p>The score functions in <em>bamlss</em> are the first derivatives of the log-likelihood w.r.t. the predictors: <span class="math display">\[
s_\mu = \frac{\partial\ell}{\partial\eta_\mu} = \frac{\partial\ell}{\partial\mu} \cdot
\frac{\partial\mu}{\partial\eta_\mu} = \frac{y-\mu}{\sigma^2},
\]</span> and <span class="math display">\[
s_\sigma = \frac{\partial\ell}{\partial\eta_\sigma} = \frac{\partial\ell}{\partial\sigma} \cdot
\frac{\partial\sigma}{\partial\eta_\sigma} = -1 + \frac{(y-\mu)^2}{\sigma^2}.
\]</span></p>
<p>For the second derivative of the log-likelihood we are able to obtain the negative expectation, <span class="math display">\[
\mathsf{E}(-\partial^2\ell / \partial\eta_{\mu}^{2} ) = \sigma^{-2},
\]</span> and <span class="math display">\[
\mathsf{E}(-\partial^2\ell / \partial\eta_{\sigma}^{2} ) = 2.
\]</span></p>
<p>Now we have to write a function that returns a <code>family.bamlss</code> object (S3) which encapsulates functions for density, score and Hessian, and the names of the family, parameter and link functions:</p>
<table class="table">
<colgroup>
<col width="21%">
<col width="78%">
</colgroup>
<thead><tr class="header">
<th>Name of element</th>
<th>Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>family</code></td>
<td>character string with the name of the family</td>
</tr>
<tr class="even">
<td><code>names</code></td>
<td>vector of character strings with the names of the parameters</td>
</tr>
<tr class="odd">
<td><code>links</code></td>
<td>vector of character strings with the names of the link functions</td>
</tr>
<tr class="even">
<td><code>d</code></td>
<td>a function returning the density with arguments <code>y, par, log = FALSE</code> (see below)</td>
</tr>
<tr class="odd">
<td><code>score</code></td>
<td>a list with functions (one for each parameter) returning the first derivatives of the log-likelihood w.r.t. predictors</td>
</tr>
<tr class="even">
<td><code>hess</code></td>
<td>a list with functions (one for each parameter) returning the negative second derivatives of the log-likelihood w.r.t. predictors</td>
</tr>
</tbody>
</table>
<p>Nearly all functions take as first argument the response <code>y</code> and as second argument a named list holding the evaluated parameters <code>par</code> of the distribution on the scale of the predictors <span class="math inline">\(\eta_{\star}\)</span>.</p>
<p>The implementation looks like this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mygauss</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        <span class="st">"family"</span> <span class="op">=</span> <span class="st">"mygauss"</span>,</span>
<span>        <span class="st">"names"</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mu"</span>, <span class="st">"sigma"</span><span class="op">)</span>,</span>
<span>        <span class="st">"links"</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="st">"identity"</span>, sigma <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>,</span>
<span>        <span class="st">"d"</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">par</span>, <span class="va">log</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">y</span>, mean <span class="op">=</span> <span class="va">par</span><span class="op">$</span><span class="va">mu</span>, sd <span class="op">=</span> <span class="va">par</span><span class="op">$</span><span class="va">sigma</span>, log <span class="op">=</span> <span class="va">log</span><span class="op">)</span></span>
<span>        <span class="op">}</span>,</span>
<span>        <span class="st">"score"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>            mu <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">par</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">par</span><span class="op">$</span><span class="va">mu</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">par</span><span class="op">$</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="op">}</span>,</span>
<span>            sigma <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">par</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">par</span><span class="op">$</span><span class="va">mu</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="op">(</span><span class="va">par</span><span class="op">$</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="op">}</span></span>
<span>        <span class="op">)</span>,</span>
<span>        <span class="st">"hess"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>            mu <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">par</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">par</span><span class="op">$</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="op">}</span>,</span>
<span>            sigma <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">par</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span> </span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="op">}</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"family.bamlss"</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://www.bamlss.org/" class="external-link">"bamlss"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Simulate some data.</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GAMart.html">GAMart</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Specify formula.</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">f</span>, <span class="va">num</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="va">f</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Model.</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">d</span>, family <span class="op">=</span> <span class="va">mygauss</span><span class="op">)</span></span></code></pre></div>
<p>Optionally, the <code>family.bamlss</code> object can be extended by functions for</p>
<ul>
<li>the cumulative distribution function <code>p(y, par, ...)</code>,</li>
<li>the quantile function (the inverse cdf) <code>q(p, par)</code>,</li>
<li>a random number generator <code>r(n, par)</code>,</li>
<li>the log-likelihood <code>loglik(y, par)</code>,</li>
<li>the expectation <code>mu(par, ...)</code>,</li>
<li>initial values for optimization, which has to be a list containing a function for each parameter,</li>
<li>…</li>
</ul>
<p>which can help to speed up optimization, or be convenient for predictions and simulations.</p>
</div>
<div class="section level2">
<h2 id="avail">Available families<a class="anchor" aria-label="anchor" href="#avail"></a>
</h2>
<p>There are some families implemented:</p>
<div class="section level3">
<h3 id="continuous-response">Continuous response<a class="anchor" aria-label="anchor" href="#continuous-response"></a>
</h3>
<div class="section level4">
<h4 id="gaussian-distribution">Gaussian distribution<a class="anchor" aria-label="anchor" href="#gaussian-distribution"></a>
</h4>
<p>Or normal distribution.</p>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\mu,\sigma) = \frac{1}{\sqrt{2\pi}\sigma} \cdot \exp
\left( \frac{-(y-\mu)^2}{2\sigma^2} \right),
\]</span> with <span class="math inline">\(\sigma &gt; 0\)</span>.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\mu = \eta_\mu\)</span></li>
<li><span class="math inline">\(\log(\sigma) = \eta_\sigma\)</span></li>
</ul>
<p><strong>Function</strong>: <code>gaussian_bamlss(...)</code></p>
<p><strong>Alternative parameterizations</strong>:</p>
<ul>
<li>
<code>gaussian2_bamlss(...)</code> models inverse <code>sigma</code> with a log link.</li>
<li>
<code>Gaussian_bamlss(...)</code> one parametric family modelling only <code>mu</code>.</li>
</ul>
</div>
<div class="section level4">
<h4 id="generalized-logistic-distribution">Generalized logistic distribution<a class="anchor" aria-label="anchor" href="#generalized-logistic-distribution"></a>
</h4>
<p>Or skewed-logistic distribution.</p>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\mu,\sigma,\alpha)=\frac{\alpha\cdot\exp\left(-\frac{y-\mu}{\sigma}\right)}
{\sigma\cdot\left(1+\exp\left(-\frac{y-\mu}{\sigma}\right)\right)^{2\alpha}},
\]</span> with <span class="math inline">\(\sigma, \alpha &gt; 0\)</span>.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\mu = \eta_\mu\)</span></li>
<li><span class="math inline">\(\log(\sigma) = \eta_\sigma\)</span></li>
<li><span class="math inline">\(\log(\alpha) = \eta_\alpha\)</span></li>
</ul>
<p><strong>Function</strong>: <code>glogis_bamlss(...)</code></p>
</div>
</div>
<div class="section level3">
<h3 id="positive-continuous-response">Positive continuous response<a class="anchor" aria-label="anchor" href="#positive-continuous-response"></a>
</h3>
<div class="section level4">
<h4 id="gamma-distribution">Gamma distribution<a class="anchor" aria-label="anchor" href="#gamma-distribution"></a>
</h4>
<p>Two-parameter distribution with <span class="math inline">\(\mu &gt; 0\)</span> for the expectation of the distribution and <span class="math inline">\(\sigma &gt; 0\)</span> for its shape.</p>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\mu,\sigma)=\frac{y^{\sigma-1}\cdot\exp\left(-\frac{\sigma\cdot y}{\mu}\right)}
{\left(\frac{\mu}{\sigma}\right)^\sigma\cdot\Gamma(\sigma)}.
\]</span></p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\log(\mu) = \eta_\mu\)</span></li>
<li><span class="math inline">\(\log(\sigma) = \eta_\sigma\)</span></li>
</ul>
<p><strong>Function</strong>: <code>gamma_bamlss(...)</code></p>
</div>
<div class="section level4">
<h4 id="generalized-pareto-distribution">Generalized Pareto distribution<a class="anchor" aria-label="anchor" href="#generalized-pareto-distribution"></a>
</h4>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\xi,\sigma)=\frac{1}{\sigma}\cdot\left(1+\frac{\xi\cdot y}{\sigma}
\right)^{-\left(1+1/\xi\right)},
\]</span> with <span class="math inline">\(\xi, \sigma &gt; 0\)</span>.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\log(\xi) = \eta_\xi\)</span></li>
<li><span class="math inline">\(\log(\sigma) = \eta_\sigma\)</span></li>
</ul>
<p><strong>Function</strong>: <code>gpareto_bamlss(...)</code></p>
</div>
<div class="section level4">
<h4 id="weibull-distribution">Weibull distribution<a class="anchor" aria-label="anchor" href="#weibull-distribution"></a>
</h4>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\lambda,\alpha)=\frac{\alpha}{\lambda}\cdot\left(\frac{y}{\lambda}\right)^{\alpha-1}
\cdot\exp\left(-\left(\frac{y}{\lambda}\right)^\alpha\right),
\]</span> with <span class="math inline">\(\lambda, \alpha &gt; 0\)</span>.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\log(\lambda) = \eta_\lambda\)</span></li>
<li><span class="math inline">\(\log(\alpha) = \eta_\alpha\)</span></li>
</ul>
<p><strong>Function</strong>: <code>weibull_bamlss(...)</code></p>
</div>
<div class="section level4">
<h4 id="lognormal-distribution">Lognormal distribution<a class="anchor" aria-label="anchor" href="#lognormal-distribution"></a>
</h4>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\mu,\sigma) = \frac{1}{\sqrt{2\pi}\sigma} \cdot \exp
\left( \frac{-(\log(y)-\mu)^2}{2\sigma^2} \right),
\]</span> with <span class="math inline">\(\sigma &gt; 0\)</span>.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\mu = \eta_\mu\)</span></li>
<li><span class="math inline">\(\log(\sigma) = \eta_\sigma\)</span></li>
</ul>
<p><strong>Function</strong>: <code>lognormal_bamlss(...)</code></p>
</div>
</div>
<div class="section level3">
<h3 id="censored-continuous-responses">Censored continuous responses<a class="anchor" aria-label="anchor" href="#censored-continuous-responses"></a>
</h3>
<div class="section level4">
<h4 id="zero-censored-normal-distribution">Zero-censored normal distribution<a class="anchor" aria-label="anchor" href="#zero-censored-normal-distribution"></a>
</h4>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\mu,\sigma)= \begin{cases} 
  \frac{1}{\sigma} \phi\left(\frac{y-\mu}{\sigma} \right) &amp; y &gt; 0 \\
  \Phi\left(\frac{-\mu}{\sigma} \right) &amp; \mbox{else,}
\end{cases}
\]</span> where <span class="math inline">\(\phi\)</span> is the probability density and <span class="math inline">\(\Phi\)</span> the cumulative distribution function of the standard normal distribution.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\mu = \eta_\mu\)</span></li>
<li><span class="math inline">\(\log(\sigma) = \eta_\sigma\)</span></li>
</ul>
<p><strong>Function</strong>: <code>cnorm_bamlss(...)</code></p>
</div>
</div>
<div class="section level3">
<h3 id="interval-responses">Interval responses<a class="anchor" aria-label="anchor" href="#interval-responses"></a>
</h3>
<div class="section level4">
<h4 id="beta-distribution">Beta distribution<a class="anchor" aria-label="anchor" href="#beta-distribution"></a>
</h4>
<p>The beta distribution, with density <span class="math display">\[
f_{Beta}(y\,|\,\alpha,\beta)=\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\cdot\Gamma(\beta)}
\cdot y^{\alpha-1} \cdot (1-y)^{\beta-1}
\]</span> is implemented using the Balding-Nichols parameterization <span class="citation">(Balding and Nichols 1995)</span>.</p>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\mu,\sigma)=f_{Beta}\left(y\,\middle|\,\alpha = \mu \cdot \frac{1-\sigma}{\sigma},
\beta = (1-\mu) \cdot \frac{1-\sigma}{\sigma} \right),
\]</span> with <span class="math inline">\(0 &lt; \mu &lt; 1\)</span> and <span class="math inline">\(0 &lt; \sigma &lt; 1\)</span>.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\mathrm{logit}(\mu)=\eta_\mu\)</span></li>
<li><span class="math inline">\(\mathrm{logit}(\sigma)=\eta_\sigma\)</span></li>
</ul>
<p><strong>Function</strong>: <code>beta_bamlss(...)</code></p>
</div>
</div>
<div class="section level3">
<h3 id="discrete-responses">Discrete responses<a class="anchor" aria-label="anchor" href="#discrete-responses"></a>
</h3>
<div class="section level4">
<h4 id="bernoulli-distribution">Bernoulli distribution<a class="anchor" aria-label="anchor" href="#bernoulli-distribution"></a>
</h4>
<p>Often called <em>binomial</em>, though the Bernoulli is a special case of the binomial distribution.</p>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\pi) = \pi^y \cdot (1-\pi)^{1-y},
\]</span> where <span class="math inline">\(\pi\)</span> is a probability.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\mathrm{logit}(\pi)=\eta_\pi\)</span></li>
</ul>
<p><strong>Function</strong>: <code>binomial_bamlss(link = "logit", ...)</code></p>
</div>
<div class="section level4">
<h4 id="multinomial-model">Multinomial model<a class="anchor" aria-label="anchor" href="#multinomial-model"></a>
</h4>
<p>Say, <span class="math inline">\(y\)</span> is a categorial response with <span class="math inline">\(c+1\)</span> nomial categories, and <span class="math inline">\(y_{1}^{\star}, \dots, y_{c+1}^{\star}\)</span> are associated dummy variables. <span class="math inline">\(p_1, \dots, p_{c+1}\)</span> are probabilities for an observation falling in one of the categories. Category <span class="math inline">\(c+1\)</span> serves as reference, i.e. <span class="math inline">\(p_{c+1} = 1 - p_1 - \dots - p_{c}\)</span>.</p>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\pi_1,\dots,\pi_c) = \prod_{s=1}^{c+1} p_{s}^{y_{s}^{\star}}, \quad
\text{where} \quad p_r = \frac{\pi_r}{1 + \pi_1 + \dots + \pi_c},
\]</span></p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\log(\pi_r) = \log\left(\frac{p_r}{p_{c+1}}\right) = \eta_r,\)</span></li>
</ul>
<p>where <span class="math inline">\(\eta_r\)</span> specifies the log-odds between category <span class="math inline">\(r\)</span> and the reference category <span class="math inline">\(c+1\)</span>.</p>
<p><strong>Function</strong>: <code>multinomial_bamlss(...)</code></p>
</div>
</div>
<div class="section level3">
<h3 id="count-data-responses">Count data responses<a class="anchor" aria-label="anchor" href="#count-data-responses"></a>
</h3>
<div class="section level4">
<h4 id="poisson-distribution">Poisson distribution<a class="anchor" aria-label="anchor" href="#poisson-distribution"></a>
</h4>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\lambda) = \frac{\lambda^y \cdot \exp(-\lambda)}{y!},
\]</span> with <span class="math inline">\(\lambda &gt; 0\)</span>.</p>
<p><strong>Link</strong>:</p>
<ul>
<li><span class="math inline">\(\log(\lambda) = \eta_\lambda\)</span></li>
</ul>
<p><strong>Function</strong>: <code>poisson_bamlss(...)</code></p>
</div>
<div class="section level4">
<h4 id="negative-binomial-type-ii">Negative binomial (type II)<a class="anchor" aria-label="anchor" href="#negative-binomial-type-ii"></a>
</h4>
<p><strong>Density</strong>: <span class="math display">\[
f(y\, |\, \mu, \theta) =
\frac{\Gamma(\theta + y)}{\Gamma({\theta}) \cdot y!} \cdot
\frac{\mu^y \cdot \theta^\theta}{(\mu + \theta)^{\theta + y}},
\]</span> with <span class="math inline">\(\mu,\theta &gt; 0\)</span>.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\log(\mu) = \eta_\mu\)</span></li>
<li><span class="math inline">\(\log(\theta) = \eta_\theta\)</span></li>
</ul>
<p><strong>Function</strong>: <code>nbinom_bamlss(...)</code></p>
</div>
<div class="section level4">
<h4 id="zero-truncated-negative-binomial">Zero-truncated negative binomial<a class="anchor" aria-label="anchor" href="#zero-truncated-negative-binomial"></a>
</h4>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\mu,\theta)=\frac{f_{\mathrm{NB}}(y\,|\,\mu,\theta)}
{1-f_{\mathrm{NB}}(0\,|\,\mu,\theta)},
\]</span> where <span class="math inline">\(f_{\mathrm{NB}}\)</span> is the density of the negative binomial.</p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\log(\mu) = \eta_\mu\)</span></li>
<li><span class="math inline">\(\log(\theta) = \eta_\theta\)</span></li>
</ul>
<p><strong>Function</strong>: <code>ztnbinom_bamlss(...)</code></p>
</div>
</div>
<div class="section level3">
<h3 id="multivariate-responses">Multivariate responses<a class="anchor" aria-label="anchor" href="#multivariate-responses"></a>
</h3>
<div class="section level4">
<h4 id="multivariate-normal-distribution">Multivariate normal distribution<a class="anchor" aria-label="anchor" href="#multivariate-normal-distribution"></a>
</h4>
<p>Say <span class="math inline">\(y\)</span> is a <span class="math inline">\(k\)</span> dimensional observation.</p>
<p><strong>Density</strong>: <span class="math display">\[
f(y\,|\,\mu,\Sigma) = \frac{1}{\sqrt{(2\pi)^{k} |\Sigma|}} \cdot
\exp \left(-\frac{1}{2} (y-\mu)^\top \Sigma^{-1} (y-\mu) \right),
\]</span> where <span class="math inline">\(\Sigma\)</span> can be decomposed into <span class="math inline">\(\Sigma = D \Omega D\)</span> with <span class="math display">\[
D=
 \begin{pmatrix}
  \sigma_1 &amp; 0 &amp; \cdots &amp; 0 \\
  0 &amp; \sigma_2 &amp; \cdots &amp; 0 \\
  \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
  0 &amp; 0 &amp; \cdots &amp; \sigma_k
 \end{pmatrix},
 \qquad \text{and} \qquad
\Omega=
 \begin{pmatrix}
  1 &amp; \rho_{12} &amp; \cdots &amp; \rho_{1k} \\
  \rho_{12} &amp; 1 &amp; \cdots &amp; \rho_{2k} \\
  \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  \rho_{1k} &amp; \rho_{2k} &amp; \cdots &amp; 1
 \end{pmatrix}.
\]</span></p>
<p><strong>Links</strong>:</p>
<ul>
<li><span class="math inline">\(\mu_j = \eta_{\mu_j}\)</span></li>
<li><span class="math inline">\(\log(\sigma_j) = \eta_{\sigma_j}\)</span></li>
<li><span class="math inline">\(\mathrm{rhogit}(\rho_{jl}) = \eta_{\rho_{jl}}\)</span></li>
</ul>
<p><strong>Function</strong>: <code>mvnorm_bamlss(k = 2, ...)</code></p>
<p><strong>Alternative parameterizations</strong>:</p>
<ul>
<li>
<code>mvnormAR1_bamlss(k = 2, ...)</code> with <span class="math display">\[
\Omega=
 \begin{pmatrix}
1 &amp; \rho &amp; \rho^2 &amp; \cdots &amp; \rho^{k-1} \\
\rho &amp; 1 &amp; \rho &amp; \cdots &amp; \rho^{k-2} \\
\rho^2 &amp; \rho &amp; 1 &amp; \cdots &amp; \rho^{k-3} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\rho^{k-1} &amp; \rho^{k-2} &amp; \rho^{k-3} &amp; \cdots &amp; 1
 \end{pmatrix},
\]</span> and <span class="math inline">\(\mathrm{rhogit}(\rho) = \eta_{\rho}\)</span>.</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="survival">Survival<a class="anchor" aria-label="anchor" href="#survival"></a>
</h3>
<ul>
<li><code>cox_bamlss(...)</code></li>
</ul>
</div>
<div class="section level3">
<h3 id="others">Others<a class="anchor" aria-label="anchor" href="#others"></a>
</h3>
<ul>
<li><code>AR1_bamlss(ar.start = NULL, ...)</code></li>
<li><code>beta1_bamlss(ar.start, ...)</code></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="gamlss">R package <em>gamlss</em> support<a class="anchor" aria-label="anchor" href="#gamlss"></a>
</h2>
<p>The <em>bamlss</em> package supports <a href="https://cran.r-project.org/package=gamlss.dist" title="CRAN gamlss.dist" class="external-link"><em>gamlss</em> families</a> via a transfer function that builds the <code>bamlss.family</code> object from a GAMLSS distribution funciton <span class="citation">(Stasinopoulos and Rigby 2007)</span>, e.g. <code><a href="https://rdrr.io/pkg/gamlss.dist/man/NO.html" class="external-link">NO()</a></code>, internally:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load the gamlss families.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://www.gamlss.com/" class="external-link">"gamlss.dist"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Estimate model.</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">d</span>, family <span class="op">=</span> <span class="va">NO</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references hanging-indent">
<div id="ref-bamlss:Balding+Nichols:1995">
<p>Balding, David J., and Richard A. Nichols. 1995. “A Method for Quantifying Differentiation Between Populations at Multi-Allelic Loci and Its Implications for Investigating Identity and Paternity.” <em>Genetica</em> 96 (1): 3–12. <a href="https://doi.org/10.1007/BF01441146" class="external-link">https://doi.org/10.1007/BF01441146</a>.</p>
</div>
<div id="ref-bamlss:Stasinopoulos:Rigby:2007">
<p>Stasinopoulos, D. Mikis, and Robert A. Rigby. 2007. “Generalized Additive Models for Location Scale and Shape (Gamlss) in R.” <em>Journal of Statistical Software</em> 23 (7): 1–46. <a href="https://doi.org/10.18637/jss.v023.i07" class="external-link">https://doi.org/10.18637/jss.v023.i07</a>.</p>
</div>
<div id="ref-bamlss:Umlauf+bamlss:2018">
<p>Umlauf, Nikolaus, Nadja Klein, Achim Zeileis, and Thorsten Simon. 2024. <em>bamlss: Bayesian Additive Models for Location Scale and Shape (and Beyond)</em>. <a href="https://CRAN.R-project.org/package=bamlss" class="external-link">https://CRAN.R-project.org/package=bamlss</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nikolaus Umlauf, Nadja Klein, Achim Zeileis, Thorsten Simon.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
