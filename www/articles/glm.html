<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generalized Linear Models • bamlss</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Generalized Linear Models">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bamlss</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bamlss.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/glm.html">Generalized Linear Models</a>
    </li>
    <li>
      <a href="../articles/misc.html">Miscellaneous Topics</a>
    </li>
    <li>
      <a href="../articles/terms.html">Available Model Terms</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Generalized Linear Models</h1>
            
      
      
      <div class="hidden name"><code>glm.Rmd</code></div>

    </div>

    
    
<div id="intro" class="section level2">
<h2 class="hasAnchor">
<a href="#intro" class="anchor"></a>Intro</h2>
<p>The <em>bamlss</em> package is perfectly suitable for estimating (Bayesian) generalized linear models (GLM) and provides infrastructures for the estimation using very large data sets, too. Within the main model fitting function <code><a href="../reference/bamlss.html">bamlss()</a></code>, the possible <code>family</code> specifications for fitting GLMs are:</p>
<ul>
<li>
<code>"gaussian"</code> or <code><a href="../reference/family.bamlss.html">gaussian_bamlss()</a></code>,</li>
<li>
<code>"beta"</code> or <code><a href="../reference/family.bamlss.html">beta_bamlss()</a></code>,</li>
<li>
<code>"binomial"</code> or <code><a href="../reference/family.bamlss.html">binomial_bamlss()</a></code>,</li>
<li>
<code>"gamma"</code> or <code><a href="../reference/family.bamlss.html">gamma_bamlss()</a></code>,</li>
<li>
<code>"poisson"</code> or <code><a href="../reference/family.bamlss.html">poisson_bamlss()</a></code>.</li>
</ul>
<p>In addition, there is a wrapper function for the family objects provided by the <em>gamlss</em> package, so in principle all <em>gamlss</em> families can be used by just passing them to the <code>family</code> argument in the <code><a href="../reference/bamlss.html">bamlss()</a></code> function.</p>
<p>First, we illustrate how to fit standard GLMs and how to do inference using the <em>bamlss</em> framework. Aftwards, we show how to estimate GLMs using very large data set.</p>
</div>
<div id="logit-model" class="section level2">
<h2 class="hasAnchor">
<a href="#logit-model" class="anchor"></a>Logit Model</h2>
<p>This example is taken from the <em>AER</em> package <span class="citation">(Kleiber and Zeileis 2018; Kleiber and Zeileis 2008)</span> and is about labor force participation (yes/no) of women in Switzerland 1981. The data can be loaded with</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"SwissLabor"</span>, <span class="dt">package =</span> <span class="st">"AER"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(SwissLabor))</code></pre></div>
<pre><code>##   participation   income age education youngkids oldkids foreign
## 1            no 10.78750 3.0         8         1       1      no
## 2           yes 10.52425 4.5         8         0       1      no
## 3            no 10.96858 4.6         9         0       0      no
## 4            no 11.10500 3.1        11         2       0      no
## 5            no 11.10847 4.4        12         0       2      no
## 6           yes 11.02825 4.2        12         0       1      no</code></pre>
<p>The data frame contains of 872 observations on 7 variables, where some of them might have a nonlinear influence on the response labor <code>participation</code>. Now, a standard Bayesian binomial logit model can be fitted with</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## First, set the seed for reproducibly.
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>)

## Model formula.
f &lt;-<span class="st"> </span>participation ~<span class="st"> </span>income +<span class="st"> </span>age +<span class="st"> </span>education +<span class="st"> </span>youngkids +<span class="st"> </span>oldkids +<span class="st"> </span>foreign +<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/AsIs">I</a></span>(age^<span class="dv">2</span>)

## Estimate model.
b &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bamlss.html">bamlss</a></span>(f, <span class="dt">family =</span> <span class="st">"binomial"</span>, <span class="dt">data =</span> SwissLabor,
  <span class="dt">n.iter =</span> <span class="dv">12000</span>, <span class="dt">burnin =</span> <span class="dv">2000</span>, <span class="dt">thin =</span> <span class="dv">10</span>)</code></pre></div>
<p>Note, to capture nonlinearities, a quadratic term for variable <code>age</code> is added to the model. The model summary gives</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(b)</code></pre></div>
<pre><code>## 
## Call:
## bamlss(formula = f, family = "binomial", data = SwissLabor, n.iter = 12000, 
##     burnin = 2000, thin = 10)
## ---
## Family: binomial 
## Link function: pi = logit
## *---
## Formula pi:
## ---
## participation ~ income + age + education + youngkids + oldkids + 
##     foreign + I(age^2)
## -
## Parametric coefficients:
##                 Mean     2.5%      50%    97.5% parameters
## (Intercept)  6.29460  1.61320  6.35800 10.86894      6.196
## income      -1.11826 -1.53526 -1.11857 -0.66780     -1.104
## age          3.45820  2.14132  3.45310  4.72934      3.437
## education    0.03269 -0.02513  0.03389  0.08447      0.033
## youngkids   -1.17482 -1.50360 -1.17595 -0.83496     -1.186
## oldkids     -0.24017 -0.39322 -0.24097 -0.07412     -0.241
## foreignyes   1.16362  0.77613  1.16502  1.53449      1.168
## I(age^2)    -0.48985 -0.64783 -0.48968 -0.32830     -0.488
## ---
## Sampler summary:
## -
## DIC = 1032.965 logLik = -512.6361 pd = 7.693
## runtime = 12.1
## ---
## Optimizer summary:
## -
## AICc = 1033.737 converged = 1 edf = 8
## logLik = -508.7851 logPost = -571.3986 nobs = 872
## runtime = 0.171
## ---</code></pre>
<p>which suggests “significant” effects for all covariates, since there are no zeros within the 95% credible intervals. Before we proceed, we usually do some convergence checks of the MCMC chains using traceplots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(b, <span class="dt">which =</span> <span class="st">"samples"</span>)</code></pre></div>
<p><img src="glm_files/figure-html/unnamed-chunk-6-1.png" width="864" style="display: block; margin: auto;"> The plots indicate convergence of the MCMC chains, i.e., there is no visible trend in the MCMC chains and very low autocorrelation suggest i.i.d. sampling from the posterior distribution. Note that the function call would show all traceplots, however, for convenience we only show the plots for the intercept and variable <code>income</code>.</p>
<p>The estimated regression coefficients can also be extracted using the <code><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef()</a></code> method</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Extract posterior mean.
<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(b, <span class="dt">FUN =</span> mean)</code></pre></div>
<pre><code>## pi.p.(Intercept)      pi.p.income         pi.p.age   pi.p.education 
##       6.29459725      -1.11826351       3.45820448       0.03268852 
##   pi.p.youngkids     pi.p.oldkids  pi.p.foreignyes    pi.p.I(age^2) 
##      -1.17481773      -0.24017030       1.16362217      -0.48984985 
##       pi.p.alpha 
##       0.86841423</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Or use any other function on the samples.
<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(b, <span class="dt">FUN =</span> function(x) { <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(x, <span class="dt">prob =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)) })</code></pre></div>
<pre><code>##                         2.5%       97.5%
## pi.p.(Intercept)  1.61320356 10.86894390
## pi.p.income      -1.53525827 -0.66779610
## pi.p.age          2.14132459  4.72934336
## pi.p.education   -0.02513391  0.08446961
## pi.p.youngkids   -1.50359765 -0.83496378
## pi.p.oldkids     -0.39321512 -0.07412275
## pi.p.foreignyes   0.77612963  1.53449289
## pi.p.I(age^2)    -0.64783455 -0.32830179
## pi.p.alpha        0.29466484  1.00000000</code></pre>
<p>(there is also a <code><a href="https://www.rdocumentation.org/packages/stats/topics/confint">confint()</a></code> method). The naming convention of the regression coefficients might first seem a bit atypical, it is based on the idea that a <em>bamlss</em> family/response distribution can have more than just one distributional parameter, as well as linear and/or nonlinear model terms. To explain, <code>pi</code> is the name of the distributional parameter in the <code><a href="../reference/family.bamlss.html">binomial_bamlss()</a></code> family and <code>p</code> stands for parametric terms, i.e., there would also be a <code>s</code> for smooth terms if they are part of the model.</p>
<p>Model predictions on the probability scale can be obtained by the predict method (see also function <code><a href="../reference/predict.bamlss.html">predict.bamlss()</a></code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Create some newdata for prediction, note that
## factors need to be fully specified (this will be changed soon).
nd &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">income =</span> <span class="dv">11</span>, <span class="dt">age =</span> <span class="fl">3.3</span>,
  <span class="dt">education =</span> <span class="dv">12</span>, <span class="dt">youngkids =</span> <span class="dv">1</span>, <span class="dt">oldkids =</span> <span class="dv">1</span>,
  <span class="dt">foreign =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="dv">1</span>, <span class="dt">levels =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"no"</span>, <span class="st">"yes"</span>)))

## Predicted probabilities.
<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(b, <span class="dt">newdata =</span> nd, <span class="dt">type =</span> <span class="st">"parameter"</span>)</code></pre></div>
<pre><code>## [1] 0.279716</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nd$foreign &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="dv">2</span>, <span class="dt">levels =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"no"</span>, <span class="st">"yes"</span>))
<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(b, <span class="dt">newdata =</span> nd, <span class="dt">type =</span> <span class="st">"parameter"</span>)</code></pre></div>
<pre><code>## [1] 0.552208</code></pre>
<p>To visualize the effect of age on the probability we can do the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Predict effect of age including 95% credible intervals and plot.
nd &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">income =</span> <span class="dv">11</span>, <span class="dt">age =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">2</span>, <span class="fl">6.2</span>, <span class="dt">length =</span> <span class="dv">100</span>),
  <span class="dt">education =</span> <span class="dv">12</span>, <span class="dt">youngkids =</span> <span class="dv">1</span>, <span class="dt">oldkids =</span> <span class="dv">1</span>,
  <span class="dt">foreign =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="dv">1</span>, <span class="dt">levels =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"no"</span>, <span class="st">"yes"</span>)))

nd$p.no &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(b, <span class="dt">newdata =</span> nd, <span class="dt">type =</span> <span class="st">"parameter"</span>, <span class="dt">FUN =</span> c95)
nd$foreign &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(<span class="dv">2</span>, <span class="dt">levels =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"no"</span>, <span class="st">"yes"</span>))
nd$p.yes &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(b, <span class="dt">newdata =</span> nd, <span class="dt">type =</span> <span class="st">"parameter"</span>, <span class="dt">FUN =</span> c95)

<span class="kw"><a href="../reference/plot2d.html">plot2d</a></span>(p.no ~<span class="st"> </span>age, <span class="dt">data =</span> nd, <span class="dt">ylab =</span> <span class="st">"participation"</span>,
  <span class="dt">ylim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/range">range</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(nd$p.no, nd$p.yes)), <span class="dt">lty =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw"><a href="../reference/plot2d.html">plot2d</a></span>(p.yes ~<span class="st"> </span>age, <span class="dt">data =</span> nd, <span class="dt">col.lines =</span> <span class="st">"blue"</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>,
  <span class="dt">lty =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/legend">legend</a></span>(<span class="st">"topright"</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"foreign yes"</span>, <span class="st">"foreign no"</span>), <span class="dt">lwd =</span> <span class="dv">1</span>,
  <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"blue"</span>, <span class="st">"black"</span>))</code></pre></div>
<p><img src="glm_files/figure-html/unnamed-chunk-10-1.png" width="480" style="display: block; margin: auto;"> The plot nicely depicts the nonlinear effect of variable <code>age</code> for the two levels of <code>foreign</code>.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-bamlss:Kleiber+Zeileis:2008">
<p>Kleiber, Christian, and Achim Zeileis. 2008. <em>Applied Econometrics with R</em>. New York: Springer-Verlag. doi:<a href="https://doi.org/10.1007/978-0-387-77318-6">10.1007/978-0-387-77318-6</a>.</p>
</div>
<div id="ref-bamlss:Kleiber+Zeileis:2018">
<p>———. 2018. <em>AER: Applied Econometrics with R</em>. <a href="https://CRAN.R-project.org/package=AER" class="uri">https://CRAN.R-project.org/package=AER</a>.</p>
</div>
<div id="ref-bamlss:Umlauf+bamlss:2018">
<p>Umlauf, Nikolaus, Nadja Klein, Achim Zeileis, and Thorsten Simon. 2018. <em>Bamlss: Bayesian Additive Models for Location Scale and Shape (and Beyond)</em>. <a href="http://CRAN.R-project.org/package=bamlss" class="uri">http://CRAN.R-project.org/package=bamlss</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#intro">Intro</a></li>
      <li><a href="#logit-model">Logit Model</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nikolaus Umlauf, Nadja Klein, Achim Zeileis, Thorsten Simon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
