<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Markov Chain Monte Carlo for BAMLSS using JAGS — sam_JAGS • bamlss</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Markov Chain Monte Carlo for BAMLSS using JAGS — sam_JAGS"><meta property="og:description" content="This sampler function for BAMLSS is an interface to the JAGS library
  using package rjags. The function basically interprets the
  bamlss.frame into BUGS code, similar to the jagam function of
  package mgcv. I.e., the function uses the random effects representation of
  smooth terms, see the transformer function randomize to generate the BUGS code.
Note that estimating BAMLSS with JAGS is not very efficient.
  Also note that this function is more experimental and support is only provided for a small
  number of bamlss.family objects.
Function BUGSeta() therefore computes the code and data for one parameter of
  the modeled distribution. Function BUGSmodel() then collects all parameter model code
  and data, which can be send to JAGS."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bamlss</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1-9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bamlss.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/terms.html">Available Model Terms</a>
    </li>
    <li>
      <a href="../articles/families.html">Families</a>
    </li>
    <li>
      <a href="../articles/bf.html">BAMLSS Model Frame</a>
    </li>
    <li>
      <a href="../articles/engines.html">Estimation Engines</a>
    </li>
    <li>
      <a href="../articles/distregvis.html">Visualization with distreg.vis</a>
    </li>
    <li>
      <a href="../articles/glm.html">Generalized Linear Models (+)</a>
    </li>
    <li>
      <a href="../articles/multinomial.html">Bayesian Multinomial Regression</a>
    </li>
    <li>
      <a href="../articles/rent.html">Munich Rent Example</a>
    </li>
    <li>
      <a href="../articles/zn.html">Spatial Location-Scale Model</a>
    </li>
    <li>
      <a href="../articles/fatalities.html">Fatalities Model for Austria</a>
    </li>
    <li>
      <a href="../articles/mvnorm.html">Multivariate Normal Model</a>
    </li>
    <li>
      <a href="../articles/misc.html">Miscellaneous Topics</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Publications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/jm.html">Bayesian Joint Models for Longitudinal and Survival Data</a>
    </li>
    <li>
      <a href="../articles/bivnorm.html">Bivariate Gaussian Models for Wind Vectors</a>
    </li>
    <li>
      <a href="../articles/cox.html">Complex Space-Time Interactions in a Cox Model</a>
    </li>
    <li>
      <a href="../articles/lasso.html">LASSO-Type Penalization in the Framework of GAMLSS</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Markov Chain Monte Carlo for BAMLSS using JAGS</h1>
    
    <div class="hidden name"><code>JAGS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This sampler function for BAMLSS is an interface to the JAGS library
  using package <code><a href="https://rdrr.io/pkg/rjags/man/rjags-package.html" class="external-link">rjags</a></code>. The function basically interprets the
  <code><a href="bamlss.frame.html">bamlss.frame</a></code> into BUGS code, similar to the <code><a href="https://rdrr.io/pkg/mgcv/man/jagam.html" class="external-link">jagam</a></code> function of
  package <code><a href="https://rdrr.io/pkg/mgcv/man/mgcv-package.html" class="external-link">mgcv</a></code>. I.e., the function uses the random effects representation of
  smooth terms, see the transformer function <code><a href="randomize.html">randomize</a></code> to generate the BUGS code.</p>
<p>Note that estimating BAMLSS with JAGS is not very efficient.
  Also note that this function is more experimental and support is only provided for a small
  number of <code><a href="family.bamlss.html">bamlss.family</a></code> objects.</p>
<p>Function <code>BUGSeta()</code> therefore computes the code and data for one parameter of
  the modeled distribution. Function <code>BUGSmodel()</code> then collects all parameter model code
  and data, which can be send to JAGS.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co">## Sampler functions:</span>
<span class="fu">sam_JAGS</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">family</span>, start <span class="op">=</span> <span class="cn">NULL</span>,
  tdir <span class="op">=</span> <span class="cn">NULL</span>, n.chains <span class="op">=</span> <span class="fl">1</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>,
  n.iter <span class="op">=</span> <span class="fl">4000</span>, thin <span class="op">=</span> <span class="fl">2</span>, burnin <span class="op">=</span> <span class="fl">1000</span>,
  seed <span class="op">=</span> <span class="cn">NULL</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, set.inits <span class="op">=</span> <span class="cn">TRUE</span>,
  save.all <span class="op">=</span> <span class="cn">FALSE</span>, modules <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">JAGS</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">family</span>, start <span class="op">=</span> <span class="cn">NULL</span>,
  tdir <span class="op">=</span> <span class="cn">NULL</span>, n.chains <span class="op">=</span> <span class="fl">1</span>, n.adapt <span class="op">=</span> <span class="fl">100</span>,
  n.iter <span class="op">=</span> <span class="fl">4000</span>, thin <span class="op">=</span> <span class="fl">2</span>, burnin <span class="op">=</span> <span class="fl">1000</span>,
  seed <span class="op">=</span> <span class="cn">NULL</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, set.inits <span class="op">=</span> <span class="cn">TRUE</span>,
  save.all <span class="op">=</span> <span class="cn">FALSE</span>, modules <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span>

<span class="co">## Function to interpret an additive predictor into BUGS code:</span>
<span class="fu">BUGSeta</span><span class="op">(</span><span class="va">x</span>, id <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span>

<span class="co">## Function to interpret the full BAMLSS:</span>
<span class="fu">BUGSmodel</span><span class="op">(</span><span class="va">x</span>, <span class="va">family</span>, is.stan <span class="op">=</span> <span class="cn">FALSE</span>, reference <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>For function <code>sam_JAGS()</code> and <code>BUGSmodel()</code> the <code>x</code> list, as returned from
    function <code><a href="bamlss.frame.html">bamlss.frame</a></code>, holding all model matrices and other information that is
    used for fitting the model. For function <code>BUGSeta()</code> argument <code>x</code> is one element of
    the <code>x</code> object, i.e., one parameter.</p></dd>

  <dt>y</dt>
<dd><p>The model response, as returned from function <code><a href="bamlss.frame.html">bamlss.frame</a></code>.</p></dd>

  <dt>family</dt>
<dd><p>A <span class="pkg">bamlss</span> family object, see <code><a href="family.bamlss.html">family.bamlss</a></code>.</p></dd>

  <dt>start</dt>
<dd><p>A named numeric vector containing possible starting values, the names are based on
    function <code><a href="parameters.html">parameters</a></code>.</p></dd>

  <dt>tdir</dt>
<dd><p>The path to the temporary directory that should be used.</p></dd>

  <dt>n.chains</dt>
<dd><p>Specifies the number of sequential MCMC chains that should be run with JAGS.</p></dd>

  <dt>n.adapt</dt>
<dd><p>Specifies the number of iterations that should be used as an initial adaptive phase.</p></dd>

  <dt>n.iter</dt>
<dd><p>Sets the number of MCMC iterations.</p></dd>

  <dt>thin</dt>
<dd><p>Defines the thinning parameter for MCMC simulation. E.g., <code>thin = 10</code> means,
    that only every 10th sampled parameter will be stored.</p></dd>

  <dt>burnin</dt>
<dd><p>Sets the burn-in phase of the sampler, i.e., the number of starting samples that
    should be removed.</p></dd>

  <dt>seed</dt>
<dd><p>Sets the seed.</p></dd>

  <dt>verbose</dt>
<dd><p>Print information during runtime of the algorithm.</p></dd>

  <dt>set.inits</dt>
<dd><p>Should initial values of BAMLSS <code><a href="parameters.html">parameters</a></code> be provided to JAGS,
    if available. Set in argument <code>start</code>.</p></dd>

  <dt>save.all</dt>
<dd><p>Should all JAGS files be saved in <code>tdir</code>.</p></dd>

  <dt>modules</dt>
<dd><p>Specify additional modules that should be loaded, see function <code><a href="https://rdrr.io/pkg/rjags/man/jags.module.html" class="external-link">load.module</a></code>.</p></dd>

  <dt>id</dt>
<dd><p>Character, the current parameter name for which the BUGS code should be produced.</p></dd>

  <dt>is.stan</dt>
<dd><p>Should the BUGS code be translated to STAN code. Note that this is only experimental.</p></dd>

  <dt>reference</dt>
<dd><p>A <code>character</code> specifying a reference category, e.g., when
    fitting a multinomial model.</p></dd>

  <dt>...</dt>
<dd><p>Currently not used.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Function <code>sam_JAGS()</code> returns samples of parameters. The samples are provided as a <code><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">mcmc</a></code></p>


<p>matrix. If <code>n.chains &gt; 1</code>, the samples are provided as a <code><a href="https://rdrr.io/pkg/coda/man/mcmc.list.html" class="external-link">mcmc.list</a></code>.</p>


<p>Function <code>BUGSeta()</code> returns the BUGS model code and preprocessed data for one
  additive predictor. Function <code>BUGSmodel()</code> then combines all single BUGS code chunks and
  the data and creates the final BUGS model code that can be send to JAGS.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Note that for setting up a new family object to be used with <code>sam_JAGS()</code> additional
  information needs to be supplied. The extra information must be placed within the
  family object in an element named <code>"bugs"</code>. The following entries should be supplied
  within the <code>..$bugs</code> list:</p><ul><li><p><code>"dist"</code>. The name of the distribution in BUGS/JAGS model language.</p></li>
<li><p><code>"eta"</code>. The function that computes the BUGS code for one structured additive predictor.
      Function <code>BUGSeta()</code> is used per default.</p></li>
<li><p><code>"model"</code>. The function that merges all single predictor BUGS model code and data.
      The default function is <code>BUGSmodel()</code>.</p></li>
<li><p><code>"reparam"</code>. A named vector of character strings that specify a re-parametrization.</p></li>
</ul><p>See also the example code of <code><a href="family.bamlss.html">family.bamlss</a></code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="bamlss.html">bamlss</a></code>, <code><a href="bamlss.frame.html">bamlss.frame</a></code>,
  <code><a href="bamlss.engine.setup.html">bamlss.engine.setup</a></code>, <code><a href="bamlss.engine.helpers.html">set.starting.values</a></code>, <code><a href="bfit.html">bfit</a></code>,
  <code><a href="GMCMC.html">GMCMC</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co">## Simulated data example illustrating</span></span>
<span class="r-in"><span class="co">## how to call the sampler function.</span></span>
<span class="r-in"><span class="co">## This is done internally within</span></span>
<span class="r-in"><span class="co">## the setup of function bamlss().</span></span>
<span class="r-in"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="GAMart.html">GAMart</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="va">f</span> <span class="op">&lt;-</span> <span class="va">num</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">x1</span>, bs <span class="op">=</span> <span class="st">"ps"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">bf</span> <span class="op">&lt;-</span> <span class="fu"><a href="bamlss.frame.html">bamlss.frame</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">d</span>, family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in bamlss.model.frame(formula, data, family, weights, subset, offset,     na.action, specials, contrasts):</span> object 'd' not found</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## First, find starting values with optimizer.</span></span>
<span class="r-in"><span class="va">opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">bf</span>, <span class="fu"><a href="bfit.html">opt_bfit</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">family</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in with(bf, opt_bfit(x, y, family)):</span> object 'bf' not found</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Sample with JAGS.</span></span>
<span class="r-in"><span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="http://mcmc-jags.sourceforge.net" class="external-link">"rjags"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="va">samps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">bf</span>, <span class="fu">sam_JAGS</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">family</span>, start <span class="op">=</span> <span class="va">opt</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">samps</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">d</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, sampler <span class="op">=</span> <span class="va">sam_JAGS</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: rjags</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Linked to JAGS 4.3.0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loaded modules: basemod,bugs</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in with(bf, sam_JAGS(x, y, family, start = opt$parameters)):</span> object 'bf' not found</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nikolaus Umlauf, Nadja Klein, Achim Zeileis, Thorsten Simon.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

