<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Batchwise Backfitting — opt_bbfit • bamlss</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Batchwise Backfitting — opt_bbfit"><meta property="og:description" content="Batchwise backfitting estimation engine for GAMLSS using very large data sets."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bamlss</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1-8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bamlss.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/terms.html">Available Model Terms</a>
    </li>
    <li>
      <a href="../articles/families.html">Families</a>
    </li>
    <li>
      <a href="../articles/bf.html">BAMLSS Model Frame</a>
    </li>
    <li>
      <a href="../articles/engines.html">Estimation Engines</a>
    </li>
    <li>
      <a href="../articles/distregvis.html">Visualization with distreg.vis</a>
    </li>
    <li>
      <a href="../articles/glm.html">Generalized Linear Models (+)</a>
    </li>
    <li>
      <a href="../articles/multinomial.html">Bayesian Multinomial Regression</a>
    </li>
    <li>
      <a href="../articles/rent.html">Munich Rent Example</a>
    </li>
    <li>
      <a href="../articles/zn.html">Spatial Location-Scale Model</a>
    </li>
    <li>
      <a href="../articles/fatalities.html">Fatalities Model for Austria</a>
    </li>
    <li>
      <a href="../articles/mvnorm.html">Multivariate Normal Model</a>
    </li>
    <li>
      <a href="../articles/misc.html">Miscellaneous Topics</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Publications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/jm.html">Bayesian Joint Models for Longitudinal and Survival Data</a>
    </li>
    <li>
      <a href="../articles/bivnorm.html">Bivariate Gaussian Models for Wind Vectors</a>
    </li>
    <li>
      <a href="../articles/cox.html">Complex Space-Time Interactions in a Cox Model</a>
    </li>
    <li>
      <a href="../articles/lasso.html">LASSO-Type Penalization in the Framework of GAMLSS</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Batchwise Backfitting</h1>
    
    <div class="hidden name"><code>bbfit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Batchwise backfitting estimation engine for GAMLSS using very large data sets.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co">## Batchwise backfitting engine.</span>
<span class="fu">opt_bbfit</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">family</span>, shuffle <span class="op">=</span> <span class="cn">TRUE</span>, start <span class="op">=</span> <span class="cn">NULL</span>, offset <span class="op">=</span> <span class="cn">NULL</span>,
  epochs <span class="op">=</span> <span class="fl">1</span>, nbatch <span class="op">=</span> <span class="fl">10</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">bbfit</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">family</span>, shuffle <span class="op">=</span> <span class="cn">TRUE</span>, start <span class="op">=</span> <span class="cn">NULL</span>, offset <span class="op">=</span> <span class="cn">NULL</span>,
  epochs <span class="op">=</span> <span class="fl">1</span>, nbatch <span class="op">=</span> <span class="fl">10</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span>

<span class="co">## Parallel version.</span>
<span class="fu">opt_bbfitp</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">family</span>, mc.cores <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span>

<span class="co">## Loglik contribution plot.</span>
<span class="fu">contribplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>For function <code><a href="bfit.html">bfit()</a></code> the <code>x</code> list, as returned from function
    <code><a href="bamlss.frame.html">bamlss.frame</a></code>, holding all model matrices and other information that is used for
    fitting the model. For the updating functions an object as returned from function
    <code><a href="https://rdrr.io/pkg/mgcv/man/smooth.construct.html" class="external-link">smooth.construct</a></code> or <code><a href="https://rdrr.io/pkg/mgcv/man/smoothCon.html" class="external-link">smoothCon</a></code>. For function
    <code>contribplot()</code>, a <code>"bamlss"</code> object using <code>bbfit()</code> with argument
    <code>select = TRUE</code>.</p></dd>

  <dt>y</dt>
<dd><p>The model response, as returned from function <code><a href="bamlss.frame.html">bamlss.frame</a></code>.</p></dd>

  <dt>family</dt>
<dd><p>A <span class="pkg">bamlss</span> family object, see <code><a href="family.bamlss.html">family.bamlss</a></code>.</p></dd>

  <dt>shuffle</dt>
<dd><p>Should observations be shuffled?</p></dd>

  <dt>start</dt>
<dd><p>A named numeric vector containing possible starting values, the names are based on
    function <code><a href="parameters.html">parameters</a></code>.</p></dd>

  <dt>offset</dt>
<dd><p>Can be used to supply model offsets for use in fitting,
    returned from function <code><a href="bamlss.frame.html">bamlss.frame</a></code>.</p></dd>

  <dt>epochs</dt>
<dd><p>For how many epochs should the algorithm run?</p></dd>

  <dt>nbatch</dt>
<dd><p>Number of batches. Can also be a number between 0 and 1, i.e., determining
    the fraction of observations that should be used for fitting.</p></dd>

  <dt>verbose</dt>
<dd><p>Print information during runtime of the algorithm.</p></dd>

  <dt>mc.cores</dt>
<dd><p>On how many cores should estimation be started?</p></dd>

  <dt>...</dt>
<dd><p>For <code>bbfitp()</code> all arguments to be passed to <code>bbfit()</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The algorithm uses batch-wise estimation of regression coefficients and smoothing variances.
  The smoothing variances are estimated on an hold-out batch. This way, models for very large
  data sets can be estimated. Note, the algorithm can work in combination with the <span class="pkg">ff</span>
  and <span class="pkg">ffbase</span> package, i.e., the entire data is never in the computer RAM. Therefore, the
  data can either to be stored as comma separated file on disc or provided as <code>"ffdf"</code>
  data frame, see also the examples.</p>
<p>The optimizer functions use additional arguments:</p><ul><li><p><code>batch_ids</code>. This argument can either be a list of indices specifying the
      batches that should be used for estimation, or a vector of length 2, where the
      first element specifies the number of observations that should be sampled for each
      batch and the second argument specifies the number of batches, see the example.</p></li>
<li><p><code>nu</code>, the step length control parameter. Defaults to <code>nu = 0.05</code>.
      If argument <code>slice = TRUE</code> then <code>nu = 1</code>.</p></li>
<li><p><code>loglik</code>, defaults to <code>loglik = FALSE</code>. If set to <code>loglik = TRUE</code>
      the "out-of-sample" log-likelihood is used for smoothing variance estimation.</p></li>
<li><p><code>aic</code>, defaults to <code>aic = FALSE</code>, If set to <code>aic = TRUE</code>
      the "out-of-sample" AIC is used for smoothing variance estimation.</p></li>
<li><p><code>eps_loglik</code>, defaults to <code>eps_loglik = 0.01</code>. This argument specifies
      the relative change in the "out-of-sample" log-likelihood that is needed such that
      a model term gets updated.</p></li>
<li><p><code>select</code>, defaults to <code>select = FALSE</code>. If set to <code>select = TRUE</code>,
      the algorithm only selects the model term with the largest contribution in the
      "out-of-sample" log-likelihood for updating in each iteration/batch.</p></li>
<li><p><code>always</code>, defaults to <code>always = FALSE</code>. If set to <code>always = TRUE</code>
      no log-likelihood contribution checks will be used and model terms are always updated.</p></li>
<li><p><code>K</code>, defaults to <code>K = 2</code>. This argument controls the penalty on the
      degrees of freedom in the computation of the AIC.</p></li>
<li><p><code>slice</code>, defaults to <code>slice = FALSE</code>. If set to <code>slice = TRUE</code>,
      slice sampling using the "out-of-sample" log-likelihood or AIC is used for smoothing
      variance estimation. Moreover, <code>always = TRUE</code>, <code>eps_loglik = -Inf</code> and
      <code>nu = 1</code>. If <code>slice</code> is an integer <code>n</code>, slice sampling is started after
      <code>n</code> iterations, before smoothing variances are optimized.</p></li>
</ul><p>When using function <code>opt_bbfitp</code>, the parameter updates are stored as <code>"mcmc"</code>
  objects. In this case the traceplots can be visualized using <code><a href="plot.bamlss.html">plot.bamlss</a></code>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>For function <code>opt_bbfit()</code> a list containing the following objects:</p>
<dl><dt>fitted.values</dt>
<dd><p>A named list of the fitted values of the modeled parameters
    of the selected distribution.</p></dd>

  <dt>parameters</dt>
<dd><p>The estimated set regression coefficients and smoothing variances.</p></dd>

  <dt>shuffle</dt>
<dd><p>Logical</p></dd>

  <dt>runtime</dt>
<dd><p>The runtime of the algorithm.</p></dd>

</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="bamlss.html">bamlss</a></code>, <code><a href="bfit.html">bfit</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co">## Simulate data.</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span class="r-in"><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="GAMart.html">GAMart</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">27000</span>, sd <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Write data to disc.</span></span>
<span class="r-in"><span class="va">tf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span><span class="va">d</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tf</span>, <span class="st">"d.raw"</span><span class="op">)</span>, quote <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Model formula.</span></span>
<span class="r-in"><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">  <span class="va">y</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">x1</span>,k<span class="op">=</span><span class="fl">40</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x2</span>,k<span class="op">=</span><span class="fl">40</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x3</span>,k<span class="op">=</span><span class="fl">40</span><span class="op">)</span> <span class="op">+</span> <span class="fu">te</span><span class="op">(</span><span class="va">lon</span>,<span class="va">lat</span>,k<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,</span>
<span class="r-in">  <span class="va">sigma</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">x1</span>,k<span class="op">=</span><span class="fl">40</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x2</span>,k<span class="op">=</span><span class="fl">40</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x3</span>,k<span class="op">=</span><span class="fl">40</span><span class="op">)</span> <span class="op">+</span> <span class="fu">te</span><span class="op">(</span><span class="va">lon</span>,<span class="va">lat</span>,k<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Specify 50 batches with 1000 observations.</span></span>
<span class="r-in"><span class="va">batch_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nobs"</span> <span class="op">=</span> <span class="fl">1000</span>, <span class="st">"nbatch"</span> <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Note, can also be a list of indices, e.g.</span></span>
<span class="r-in"><span class="co">## batch_ids &lt;- lapply(1:50, function(i) { sample(1:nrow(d), size = 1000) })</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Different flavors:</span></span>
<span class="r-in"><span class="co">## (1) Using "out-of-sample" aic for smoothing</span></span>
<span class="r-in"><span class="co">##     variance estimation. Update is only accepted</span></span>
<span class="r-in"><span class="co">##     if the "out-of-sample" log-likelihood is</span></span>
<span class="r-in"><span class="co">##     increased. If data is a filepath, the data set is</span></span>
<span class="r-in"><span class="co">##     read into R using package ff and model and</span></span>
<span class="r-in"><span class="co">##     design matrices are processed with ff. This may</span></span>
<span class="r-in"><span class="co">##     take some time depending on the size of the data.</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tf</span>, <span class="st">"d.raw"</span><span class="op">)</span>,</span>
<span class="r-in">  sampler <span class="op">=</span> <span class="cn">FALSE</span>, optimizer <span class="op">=</span> <span class="va">opt_bbfit</span>,</span>
<span class="r-in">  batch_ids <span class="op">=</span> <span class="va">batch_ids</span>, nu <span class="op">=</span> <span class="fl">0.1</span>, aic <span class="op">=</span> <span class="cn">TRUE</span>, eps_loglik <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span class="r-in">  always <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. creating directory 'ff_data_bamlss' for storing matrices. Note, the directory is may not deleted and matrices can be used for another model. Use delete = TRUE in the bamlss call. Before starting a new model you can set overwrite = TRUE to overwrite existing data.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..     100%  .. ff processing term s(x1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..     100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ff processing term s(x2) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..     100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ff processing term s(x3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..     100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ff processing term te(lon,lat) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..     100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..     100%  .. ff processing term s(x1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ff processing term s(x2) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ff processing term s(x3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ff processing term te(lon,lat) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term s(x1) 4.000005 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term s(x2) 4.000005 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term s(x3) 4.000005 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term te(lon,lat) 10.0012 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> opening ff ff_data_bamlss/sx1.ff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term s(x1) 4.000004 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> opening ff ff_data_bamlss/sx2.ff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term s(x2) 4.000005 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> opening ff ff_data_bamlss/sx3.ff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term s(x3) 4.000005 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> opening ff ff_data_bamlss/telonlat.ff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term te(lon,lat) 10.00654 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    * iter 1, nobs 1000, edf 27.080100   * iter 2, nobs 2000, eps 1.952600, edf 27.560000   * iter 3, nobs 3000, eps 1.510800, edf 32.280000   * iter 4, nobs 4000, eps 0.496400, edf 31.620000   * iter 5, nobs 5000, eps 0.242300, edf 36.880000   * iter 6, nobs 6000, eps 0.218300, edf 26.780000   * iter 7, nobs 7000, eps 0.122300, edf 34.900000   * iter 8, nobs 8000, eps 0.079800, edf 27.800000   * iter 9, nobs 9000, eps 0.109500, edf 29.700000   * iter 10, nobs 10000, eps 0.100300, edf 28.980000   * iter 11, nobs 11000, eps 0.103600, edf 29.210000   * iter 12, nobs 12000, eps 0.082500, edf 30.680000   * iter 13, nobs 13000, eps 0.080700, edf 29.100000   * iter 14, nobs 14000, eps 0.072200, edf 28.380000   * iter 15, nobs 15000, eps 0.046900, edf 30.420000   * iter 16, nobs 16000, eps 0.085100, edf 28.350000   * iter 17, nobs 17000, eps 0.043600, edf 31.340000   * iter 18, nobs 18000, eps 0.055500, edf 32.500000   * iter 19, nobs 19000, eps 0.049400, edf 30.870000   * iter 20, nobs 20000, eps 0.054800, edf 26.390000   * iter 21, nobs 21000, eps 0.044100, edf 31.980000   * iter 22, nobs 22000, eps 0.103400, edf 33.770000   * iter 23, nobs 23000, eps 0.056100, edf 26.400000   * iter 24, nobs 24000, eps 0.055100, edf 23.320000   * iter 25, nobs 25000, eps 0.088600, edf 31.510000   * iter 26, nobs 26000, eps 0.055500, edf 28.650000   * iter 27, nobs 27000, eps 0.036900, edf 29.890000   * iter 28, nobs 28000, eps 0.054900, edf 25.590000   * iter 29, nobs 29000, eps 0.027500, edf 24.870000   * iter 30, nobs 30000, eps 0.044300, edf 31.670000   * iter 31, nobs 31000, eps 0.032600, edf 18.770000   * iter 32, nobs 32000, eps 0.098100, edf 22.390000   * iter 33, nobs 33000, eps 0.035400, edf 21.710000   * iter 34, nobs 34000, eps 0.033600, edf 21.840000   * iter 35, nobs 35000, eps 0.040700, edf 21.380000   * iter 36, nobs 36000, eps 0.027200, edf 19.060000   * iter 37, nobs 37000, eps 0.027500, edf 15.450000   * iter 38, nobs 38000, eps 0.063000, edf 10.860000   * iter 39, nobs 39000, eps 0.034600, edf 33.240000   * iter 40, nobs 40000, eps 0.437100, edf 22.360000   * iter 41, nobs 41000, eps 0.051400, edf 21.000000   * iter 42, nobs 42000, eps 0.216400, edf 12.680000   * iter 43, nobs 43000, eps 0.007600, edf 13.890000   * iter 44, nobs 44000, eps 0.047900, edf 34.380000   * iter 45, nobs 45000, eps 0.051300, edf 28.020000   * iter 46, nobs 46000, eps 0.083900, edf 22.960000   * iter 47, nobs 47000, eps 0.015900, edf 7.900000   * iter 48, nobs 48000, eps 0.043300, edf 27.470000   * iter 49, nobs 49000, eps 0.018300, edf 17.370000   * iter 50, nobs 50000, eps 0.051500, edf 39.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> elapsed time: 23.86sec</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Plot estimated effects.</span></span>
<span class="r-in"><span class="co">## plot(b1)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Plot coefficient paths for x3 in mu.</span></span>
<span class="r-in"><span class="co">## pathplot(b1, name = "mu.s.s(x3).b")</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## (2) Same but always update, this mimics the classic SGD.</span></span>
<span class="r-in"><span class="co">##     Note, for prediction only the last iteration is</span></span>
<span class="r-in"><span class="co">##     used in this case. To use more iterations use opt_bbfitp(),</span></span>
<span class="r-in"><span class="co">##     Then iterations are stored as "mcmc" object and we can</span></span>
<span class="r-in"><span class="co">##     predict using the burnin argment, e.g.,</span></span>
<span class="r-in"><span class="co">##     p &lt;- predict(b2, model = "mu", burnin = 35)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tf</span>, <span class="st">"d.raw"</span><span class="op">)</span>,</span>
<span class="r-in">  sampler <span class="op">=</span> <span class="cn">FALSE</span>, optimizer <span class="op">=</span> <span class="va">opt_bbfit</span>,</span>
<span class="r-in">  batch_ids <span class="op">=</span> <span class="va">batch_ids</span>, nu <span class="op">=</span> <span class="fl">0.1</span>, aic <span class="op">=</span> <span class="cn">TRUE</span>, eps_loglik <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span class="r-in">  always <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. creating directory 'ff_data_bamlss' for storing matrices. Note, the directory is may not deleted and matrices can be used for another model. Use delete = TRUE in the bamlss call. Before starting a new model you can set overwrite = TRUE to overwrite existing data.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..     100%  .. ff processing term s(x1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..     100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ff processing term s(x2) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..     100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ff processing term s(x3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..     100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ff processing term te(lon,lat) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..     100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..     100%  .. ff processing term s(x1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ff processing term s(x2) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ff processing term s(x3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ff processing term te(lon,lat) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term s(x1) 4.000004 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term s(x2) 4.000004 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term s(x3) 4.000005 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term te(lon,lat) 10.01284 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> opening ff ff_data_bamlss/sx1.ff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term s(x1) 4.000004 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> opening ff ff_data_bamlss/sx2.ff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term s(x2) 4.000004 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> opening ff ff_data_bamlss/sx3.ff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term s(x3) 4.000005 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> opening ff ff_data_bamlss/telonlat.ff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term te(lon,lat) 10.00109 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    * iter 1, nobs 1000, edf 33.481200   * iter 2, nobs 2000, eps 1.465300, edf 34.570000   * iter 3, nobs 3000, eps 0.632200, edf 34.570000   * iter 4, nobs 4000, eps 0.240500, edf 27.890000   * iter 5, nobs 5000, eps 0.239400, edf 34.600000   * iter 6, nobs 6000, eps 0.191600, edf 32.290000   * iter 7, nobs 7000, eps 0.281200, edf 35.120000   * iter 8, nobs 8000, eps 0.087700, edf 28.560000   * iter 9, nobs 9000, eps 0.143000, edf 27.790000   * iter 10, nobs 10000, eps 0.098200, edf 31.850000   * iter 11, nobs 11000, eps 0.081400, edf 31.300000   * iter 12, nobs 12000, eps 0.075100, edf 32.160000   * iter 13, nobs 13000, eps 0.057200, edf 30.660000   * iter 14, nobs 14000, eps 0.143900, edf 32.030000   * iter 15, nobs 15000, eps 0.100600, edf 29.400000   * iter 16, nobs 16000, eps 0.084300, edf 30.340000   * iter 17, nobs 17000, eps 0.099700, edf 30.320000   * iter 18, nobs 18000, eps 0.044500, edf 29.600000   * iter 19, nobs 19000, eps 0.050300, edf 29.230000   * iter 20, nobs 20000, eps 0.444900, edf 30.980000   * iter 21, nobs 21000, eps 0.054200, edf 30.980000   * iter 22, nobs 22000, eps 0.060800, edf 31.070000   * iter 23, nobs 23000, eps 0.051500, edf 32.140000   * iter 24, nobs 24000, eps 0.048000, edf 29.910000   * iter 25, nobs 25000, eps 0.075300, edf 29.830000   * iter 26, nobs 26000, eps 0.046900, edf 31.940000   * iter 27, nobs 27000, eps 0.026700, edf 32.440000   * iter 28, nobs 28000, eps 0.025800, edf 27.150000   * iter 29, nobs 29000, eps 0.046800, edf 29.330000   * iter 30, nobs 30000, eps 0.045000, edf 32.780000   * iter 31, nobs 31000, eps 0.121300, edf 29.490000   * iter 32, nobs 32000, eps 0.043400, edf 27.670000   * iter 33, nobs 33000, eps 0.032400, edf 33.820000   * iter 34, nobs 34000, eps 0.031600, edf 27.860000   * iter 35, nobs 35000, eps 0.037800, edf 31.720000   * iter 36, nobs 36000, eps 0.091400, edf 31.170000   * iter 37, nobs 37000, eps 0.046900, edf 33.840000   * iter 38, nobs 38000, eps 0.034600, edf 34.190000   * iter 39, nobs 39000, eps 0.036400, edf 33.750000   * iter 40, nobs 40000, eps 0.047900, edf 31.440000   * iter 41, nobs 41000, eps 0.024200, edf 30.870000   * iter 42, nobs 42000, eps 0.079900, edf 34.080000   * iter 43, nobs 43000, eps 0.057700, edf 29.520000   * iter 44, nobs 44000, eps 0.132700, edf 35.900000   * iter 45, nobs 45000, eps 0.048200, edf 36.380000   * iter 46, nobs 46000, eps 0.065000, edf 39.180000   * iter 47, nobs 47000, eps 0.038100, edf 33.960000   * iter 48, nobs 48000, eps 0.036300, edf 36.370000   * iter 49, nobs 49000, eps 0.058100, edf 33.570000   * iter 50, nobs 50000, eps 0.127600, edf 32.940000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> elapsed time: 23.06sec</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Plot coefficient paths for x3 in mu.</span></span>
<span class="r-in"><span class="co">## pathplot(b2, name = "mu.s.s(x3).b")</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## (3) Boosting type flavor, only update model term with</span></span>
<span class="r-in"><span class="co">##     the largest contribution in the "out-of-sample"</span></span>
<span class="r-in"><span class="co">##     log-likelihood. In this case, if edf = 0 during</span></span>
<span class="r-in"><span class="co">##     runtime of the algorithm, no model has an additional</span></span>
<span class="r-in"><span class="co">##     contribution and the algorithm converges. This</span></span>
<span class="r-in"><span class="co">##     behavior is controlled by argument eps_loglik, the</span></span>
<span class="r-in"><span class="co">##     higher eps_loglik, the more restrictive is the</span></span>
<span class="r-in"><span class="co">##     updating step.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Initialize intercepts.</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span class="r-in"><span class="va">b0</span> <span class="op">&lt;-</span> <span class="fu"><a href="bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">d</span>, sampler <span class="op">=</span> <span class="cn">FALSE</span>, optimizer <span class="op">=</span> <span class="va">opt_bbfitp</span>,</span>
<span class="r-in">  batch_ids <span class="op">=</span> <span class="va">batch_ids</span>, slice <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(predvars, data, env):</span> object 'num' not found</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Compute starting values, remove the first</span></span>
<span class="r-in"><span class="co">## 10 iterates and compute the mean of the</span></span>
<span class="r-in"><span class="co">## remaining iterates.</span></span>
<span class="r-in"><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">b0</span>, FUN <span class="op">=</span> <span class="va">mean</span>, burnin <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in coef(b0, FUN = mean, burnin = 10):</span> object 'b0' not found</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Start boosting, only update if change in</span></span>
<span class="r-in"><span class="co">## "out-of-sample" log-likelihood is 0.1</span></span>
<span class="r-in"><span class="co">## eps_loglik = 0.001.</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"><span class="va">b3</span> <span class="op">&lt;-</span> <span class="fu"><a href="bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">d</span>, sampler <span class="op">=</span> <span class="cn">FALSE</span>, optimizer <span class="op">=</span> <span class="va">opt_bbfit</span>,</span>
<span class="r-in">    batch_ids <span class="op">=</span> <span class="va">batch_ids</span>, nu <span class="op">=</span> <span class="fl">0.1</span>, aic <span class="op">=</span> <span class="cn">TRUE</span>, eps_loglik <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span class="r-in">    select <span class="op">=</span> <span class="cn">TRUE</span>, always <span class="op">=</span> <span class="cn">FALSE</span>, start <span class="op">=</span> <span class="va">start</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in start[paste0(i, ".p.", colnames(x[[i]]$model.matrix))]:</span> object of type 'closure' is not subsettable</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Plot log-likelihood contributions.</span></span>
<span class="r-in"><span class="co">## contribplot(b3)</span></span>
<span class="r-in"><span class="co">## In this case, the algorithm did not converge,</span></span>
<span class="r-in"><span class="co">## we need more iterations/batches.</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Note, prediction uses last iterate.</span></span>
<span class="r-in"><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">b3</span>, model <span class="op">=</span> <span class="st">"mu"</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in predict(b3, model = "mu"):</span> object 'b3' not found</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## (4) Use slice sampling under the "out-of-sample"</span></span>
<span class="r-in"><span class="co">##     log likelihood for estimation of smoothing</span></span>
<span class="r-in"><span class="co">##     variances. In this case model terms are always</span></span>
<span class="r-in"><span class="co">##     updated ad parameter paths behave like a MCMC</span></span>
<span class="r-in"><span class="co">##     chain. Therefore, use opt_bbfitp(), which stores</span></span>
<span class="r-in"><span class="co">##     parameter paths as "mcmc" objects and we can</span></span>
<span class="r-in"><span class="co">##     inspect using traceplots. Note nu = 1 if</span></span>
<span class="r-in"><span class="co">##     slice = TRUE.</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span class="r-in"><span class="va">b4</span> <span class="op">&lt;-</span> <span class="fu"><a href="bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">d</span>, sampler <span class="op">=</span> <span class="cn">FALSE</span>, optimizer <span class="op">=</span> <span class="va">opt_bbfitp</span>,</span>
<span class="r-in">  batch_ids <span class="op">=</span> <span class="va">batch_ids</span>, aic <span class="op">=</span> <span class="cn">TRUE</span>, slice <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term s(x1) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term s(x2) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term s(x3) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term te(lon,lat) 10.00511 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term s(x1) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term s(x2) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term s(x3) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term te(lon,lat) 9.999999 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    * iter 1, nobs 1000, edf 42.375800   * iter 2, nobs 2000, eps 0.668700, edf 39.730000   * iter 3, nobs 3000, eps 0.947800, edf 44.540000   * iter 4, nobs 4000, eps 0.714500, edf 47.630000   * iter 5, nobs 5000, eps 1.567000, edf 47.020000   * iter 6, nobs 6000, eps 0.779100, edf 39.980000   * iter 7, nobs 7000, eps 1.540500, edf 41.130000   * iter 8, nobs 8000, eps 0.690600, edf 39.430000   * iter 9, nobs 9000, eps 1.081500, edf 40.790000   * iter 10, nobs 10000, eps 0.713700, edf 35.940000   * iter 11, nobs 11000, eps 0.614100, edf 35.050000   * iter 12, nobs 12000, eps 0.725900, edf 35.230000   * iter 13, nobs 13000, eps 0.647100, edf 42.490000   * iter 14, nobs 14000, eps 1.400600, edf 48.700000   * iter 15, nobs 15000, eps 0.598500, edf 51.240000   * iter 16, nobs 16000, eps 0.771900, edf 45.120000   * iter 17, nobs 17000, eps 0.951200, edf 42.990000   * iter 18, nobs 18000, eps 0.728000, edf 45.860000   * iter 19, nobs 19000, eps 6.769500, edf 41.650000   * iter 20, nobs 20000, eps 0.863600, edf 42.020000   * iter 21, nobs 21000, eps 1.067900, edf 40.000000   * iter 22, nobs 22000, eps 1.304300, edf 42.820000   * iter 23, nobs 23000, eps 0.905400, edf 42.450000   * iter 24, nobs 24000, eps 0.814300, edf 44.000000   * iter 25, nobs 25000, eps 0.604800, edf 36.220000   * iter 26, nobs 26000, eps 0.653800, edf 43.940000   * iter 27, nobs 27000, eps 0.827700, edf 47.020000   * iter 28, nobs 28000, eps 0.870500, edf 49.360000   * iter 29, nobs 29000, eps 0.973400, edf 42.350000   * iter 30, nobs 30000, eps 0.651400, edf 49.110000   * iter 31, nobs 31000, eps 0.720200, edf 46.580000   * iter 32, nobs 32000, eps 0.903500, edf 47.630000   * iter 33, nobs 33000, eps 3.202200, edf 42.550000   * iter 34, nobs 34000, eps 1.014400, edf 43.860000   * iter 35, nobs 35000, eps 0.765900, edf 46.190000   * iter 36, nobs 36000, eps 0.976500, edf 46.420000   * iter 37, nobs 37000, eps 1.931500, edf 46.580000   * iter 38, nobs 38000, eps 0.537900, edf 39.260000   * iter 39, nobs 39000, eps 0.910900, edf 41.610000   * iter 40, nobs 40000, eps 4.386900, edf 41.060000   * iter 41, nobs 41000, eps 0.553400, edf 38.960000   * iter 42, nobs 42000, eps 0.846100, edf 41.230000   * iter 43, nobs 43000, eps 1.410300, edf 48.280000   * iter 44, nobs 44000, eps 0.638400, edf 38.390000   * iter 45, nobs 45000, eps 1.625000, edf 40.390000   * iter 46, nobs 46000, eps 0.763700, edf 39.120000   * iter 47, nobs 47000, eps 1.464600, edf 41.890000   * iter 48, nobs 48000, eps 3.535800, edf 35.830000   * iter 49, nobs 49000, eps 0.543300, edf 30.000000   * iter 50, nobs 50000, eps 0.909500, edf 33.310000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> elapsed time:  6.34sec</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## plot(b4)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Plot parameter updates/samples.</span></span>
<span class="r-in"><span class="co">## plot(b4, which = "samples")</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Predict with burnin and compute mean</span></span>
<span class="r-in"><span class="co">## prediction of the last 20 iterates.</span></span>
<span class="r-in"><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">b4</span>, model <span class="op">=</span> <span class="st">"mu"</span>, burnin <span class="op">=</span> <span class="fl">30</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nikolaus Umlauf, Nadja Klein, Achim Zeileis, Thorsten Simon.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

