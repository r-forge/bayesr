<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Batchwise Backfitting — opt_bbfit • bamlss</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Batchwise Backfitting — opt_bbfit"><meta property="og:description" content="Batchwise backfitting estimation engine for GAMLSS using very large data sets."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bamlss</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2-2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bamlss.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/terms.html">Available Model Terms</a>
    </li>
    <li>
      <a href="../articles/families.html">Families</a>
    </li>
    <li>
      <a href="../articles/bf.html">BAMLSS Model Frame</a>
    </li>
    <li>
      <a href="../articles/engines.html">Estimation Engines</a>
    </li>
    <li>
      <a href="../articles/distregvis.html">Visualization with distreg.vis</a>
    </li>
    <li>
      <a href="../articles/glm.html">Generalized Linear Models (+)</a>
    </li>
    <li>
      <a href="../articles/multinomial.html">Bayesian Multinomial Regression</a>
    </li>
    <li>
      <a href="../articles/rent.html">Munich Rent Example</a>
    </li>
    <li>
      <a href="../articles/zn.html">Spatial Location-Scale Model</a>
    </li>
    <li>
      <a href="../articles/fatalities.html">Fatalities Model for Austria</a>
    </li>
    <li>
      <a href="../articles/mvnorm.html">Multivariate Normal Model</a>
    </li>
    <li>
      <a href="../articles/misc.html">Miscellaneous Topics</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Publications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/jm.html">Bayesian Joint Models for Longitudinal and Survival Data</a>
    </li>
    <li>
      <a href="../articles/bivnorm.html">Bivariate Gaussian Models for Wind Vectors</a>
    </li>
    <li>
      <a href="../articles/cox.html">Complex Space-Time Interactions in a Cox Model</a>
    </li>
    <li>
      <a href="../articles/lasso.html">LASSO-Type Penalization in the Framework of GAMLSS</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Batchwise Backfitting</h1>
    
    <div class="hidden name"><code>bbfit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Batchwise backfitting estimation engine for GAMLSS using very large data sets.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co">## Batchwise backfitting engine.</span></span>
<span><span class="fu">opt_bbfit</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">family</span>, shuffle <span class="op">=</span> <span class="cn">TRUE</span>, start <span class="op">=</span> <span class="cn">NULL</span>, offset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  epochs <span class="op">=</span> <span class="fl">1</span>, nbatch <span class="op">=</span> <span class="fl">10</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">bbfit</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">family</span>, shuffle <span class="op">=</span> <span class="cn">TRUE</span>, start <span class="op">=</span> <span class="cn">NULL</span>, offset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  epochs <span class="op">=</span> <span class="fl">1</span>, nbatch <span class="op">=</span> <span class="fl">10</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Parallel version.</span></span>
<span><span class="fu">opt_bbfitp</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">family</span>, mc.cores <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Loglik contribution plot.</span></span>
<span><span class="fu">contribplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>For function <code><a href="bfit.html">bfit()</a></code> the <code>x</code> list, as returned from function
    <code><a href="bamlss.frame.html">bamlss.frame</a></code>, holding all model matrices and other information that is used for
    fitting the model. For the updating functions an object as returned from function
    <code><a href="https://rdrr.io/pkg/mgcv/man/smooth.construct.html" class="external-link">smooth.construct</a></code> or <code><a href="https://rdrr.io/pkg/mgcv/man/smoothCon.html" class="external-link">smoothCon</a></code>. For function
    <code>contribplot()</code>, a <code>"bamlss"</code> object using <code>bbfit()</code> with argument
    <code>select = TRUE</code>.</p></dd>

  <dt>y</dt>
<dd><p>The model response, as returned from function <code><a href="bamlss.frame.html">bamlss.frame</a></code>.</p></dd>

  <dt>family</dt>
<dd><p>A <span class="pkg">bamlss</span> family object, see <code><a href="family.bamlss.html">family.bamlss</a></code>.</p></dd>

  <dt>shuffle</dt>
<dd><p>Should observations be shuffled?</p></dd>

  <dt>start</dt>
<dd><p>A named numeric vector containing possible starting values, the names are based on
    function <code><a href="parameters.html">parameters</a></code>.</p></dd>

  <dt>offset</dt>
<dd><p>Can be used to supply model offsets for use in fitting,
    returned from function <code><a href="bamlss.frame.html">bamlss.frame</a></code>.</p></dd>

  <dt>epochs</dt>
<dd><p>For how many epochs should the algorithm run?</p></dd>

  <dt>nbatch</dt>
<dd><p>Number of batches. Can also be a number between 0 and 1, i.e., determining
    the fraction of observations that should be used for fitting.</p></dd>

  <dt>verbose</dt>
<dd><p>Print information during runtime of the algorithm.</p></dd>

  <dt>mc.cores</dt>
<dd><p>On how many cores should estimation be started?</p></dd>

  <dt>...</dt>
<dd><p>For <code>bbfitp()</code> all arguments to be passed to <code>bbfit()</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The algorithm uses batch-wise estimation of regression coefficients and smoothing variances.
  The smoothing variances are estimated on an hold-out batch. This way, models for very large
  data sets can be estimated. Note, the algorithm can work in combination with the <span class="pkg">ff</span>
  and <span class="pkg">ffbase</span> package, i.e., the entire data is never in the computer RAM. Therefore, the
  data can either to be stored as comma separated file on disc or provided as <code>"ffdf"</code>
  data frame, see also the examples.</p>
<p>The optimizer functions use additional arguments:</p><ul><li><p><code>batch_ids</code>. This argument can either be a list of indices specifying the
      batches that should be used for estimation, or a vector of length 2, where the
      first element specifies the number of observations that should be sampled for each
      batch and the second argument specifies the number of batches, see the example.</p></li>
<li><p><code>nu</code>, the step length control parameter. Defaults to <code>nu = 0.05</code>.
      If argument <code>slice = TRUE</code> then <code>nu = 1</code>.</p></li>
<li><p><code>loglik</code>, defaults to <code>loglik = FALSE</code>. If set to <code>loglik = TRUE</code>
      the "out-of-sample" log-likelihood is used for smoothing variance estimation.</p></li>
<li><p><code>aic</code>, defaults to <code>aic = FALSE</code>, If set to <code>aic = TRUE</code>
      the "out-of-sample" AIC is used for smoothing variance estimation.</p></li>
<li><p><code>eps_loglik</code>, defaults to <code>eps_loglik = 0.01</code>. This argument specifies
      the relative change in the "out-of-sample" log-likelihood that is needed such that
      a model term gets updated.</p></li>
<li><p><code>select</code>, defaults to <code>select = FALSE</code>. If set to <code>select = TRUE</code>,
      the algorithm only selects the model term with the largest contribution in the
      "out-of-sample" log-likelihood for updating in each iteration/batch.</p></li>
<li><p><code>always</code>, defaults to <code>always = FALSE</code>. If set to <code>always = TRUE</code>
      no log-likelihood contribution checks will be used and model terms are always updated.</p></li>
<li><p><code>K</code>, defaults to <code>K = 2</code>. This argument controls the penalty on the
      degrees of freedom in the computation of the AIC.</p></li>
<li><p><code>slice</code>, defaults to <code>slice = FALSE</code>. If set to <code>slice = TRUE</code>,
      slice sampling using the "out-of-sample" log-likelihood or AIC is used for smoothing
      variance estimation. Moreover, <code>always = TRUE</code>, <code>eps_loglik = -Inf</code> and
      <code>nu = 1</code>. If <code>slice</code> is an integer <code>n</code>, slice sampling is started after
      <code>n</code> iterations, before smoothing variances are optimized.</p></li>
</ul><p>When using function <code>opt_bbfitp</code>, the parameter updates are stored as <code>"mcmc"</code>
  objects. In this case the traceplots can be visualized using <code><a href="plot.bamlss.html">plot.bamlss</a></code>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>For function <code>opt_bbfit()</code> a list containing the following objects:</p>
<dl><dt>fitted.values</dt>
<dd><p>A named list of the fitted values of the modeled parameters
    of the selected distribution.</p></dd>

  <dt>parameters</dt>
<dd><p>The estimated set regression coefficients and smoothing variances.</p></dd>

  <dt>shuffle</dt>
<dd><p>Logical</p></dd>

  <dt>runtime</dt>
<dd><p>The runtime of the algorithm.</p></dd>

</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="bamlss.html">bamlss</a></code>, <code><a href="bfit.html">bfit</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co">## Simulate data.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="GAMart.html">GAMart</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">27000</span>, sd <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Write data to disc.</span></span></span>
<span class="r-in"><span><span class="va">tf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table</a></span><span class="op">(</span><span class="va">d</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tf</span>, <span class="st">"d.raw"</span><span class="op">)</span>, quote <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>, sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Model formula.</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">x1</span>,k<span class="op">=</span><span class="fl">40</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x2</span>,k<span class="op">=</span><span class="fl">40</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x3</span>,k<span class="op">=</span><span class="fl">40</span><span class="op">)</span> <span class="op">+</span> <span class="fu">te</span><span class="op">(</span><span class="va">lon</span>,<span class="va">lat</span>,k<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="va">sigma</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">x1</span>,k<span class="op">=</span><span class="fl">40</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x2</span>,k<span class="op">=</span><span class="fl">40</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x3</span>,k<span class="op">=</span><span class="fl">40</span><span class="op">)</span> <span class="op">+</span> <span class="fu">te</span><span class="op">(</span><span class="va">lon</span>,<span class="va">lat</span>,k<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Specify 50 batches with 1000 observations.</span></span></span>
<span class="r-in"><span><span class="va">batch_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nobs"</span> <span class="op">=</span> <span class="fl">1000</span>, <span class="st">"nbatch"</span> <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Note, can also be a list of indices, e.g.</span></span></span>
<span class="r-in"><span><span class="co">## batch_ids &lt;- lapply(1:50, function(i) { sample(1:nrow(d), size = 1000) })</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Different flavors:</span></span></span>
<span class="r-in"><span><span class="co">## (1) Using "out-of-sample" aic for smoothing</span></span></span>
<span class="r-in"><span><span class="co">##     variance estimation. Update is only accepted</span></span></span>
<span class="r-in"><span><span class="co">##     if the "out-of-sample" log-likelihood is</span></span></span>
<span class="r-in"><span><span class="co">##     increased. If data is a filepath, the data set is</span></span></span>
<span class="r-in"><span><span class="co">##     read into R using package ff and model and</span></span></span>
<span class="r-in"><span><span class="co">##     design matrices are processed with ff. This may</span></span></span>
<span class="r-in"><span><span class="co">##     take some time depending on the size of the data.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tf</span>, <span class="st">"d.raw"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sampler <span class="op">=</span> <span class="cn">FALSE</span>, optimizer <span class="op">=</span> <span class="va">opt_bbfit</span>,</span></span>
<span class="r-in"><span>  batch_ids <span class="op">=</span> <span class="va">batch_ids</span>, nu <span class="op">=</span> <span class="fl">0.1</span>, aic <span class="op">=</span> <span class="cn">TRUE</span>, eps_loglik <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span></span>
<span class="r-in"><span>  always <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in loadNamespace(x):</span> there is no package called ‘ff’</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot estimated effects.</span></span></span>
<span class="r-in"><span><span class="co">## plot(b1)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot coefficient paths for x3 in mu.</span></span></span>
<span class="r-in"><span><span class="co">## pathplot(b1, name = "mu.s.s(x3).b")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## (2) Same but always update, this mimics the classic SGD.</span></span></span>
<span class="r-in"><span><span class="co">##     Note, for prediction only the last iteration is</span></span></span>
<span class="r-in"><span><span class="co">##     used in this case. To use more iterations use opt_bbfitp(),</span></span></span>
<span class="r-in"><span><span class="co">##     Then iterations are stored as "mcmc" object and we can</span></span></span>
<span class="r-in"><span><span class="co">##     predict using the burnin argment, e.g.,</span></span></span>
<span class="r-in"><span><span class="co">##     p &lt;- predict(b2, model = "mu", burnin = 35)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tf</span>, <span class="st">"d.raw"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sampler <span class="op">=</span> <span class="cn">FALSE</span>, optimizer <span class="op">=</span> <span class="va">opt_bbfit</span>,</span></span>
<span class="r-in"><span>  batch_ids <span class="op">=</span> <span class="va">batch_ids</span>, nu <span class="op">=</span> <span class="fl">0.1</span>, aic <span class="op">=</span> <span class="cn">TRUE</span>, eps_loglik <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span></span>
<span class="r-in"><span>  always <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in loadNamespace(x):</span> there is no package called ‘ff’</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot coefficient paths for x3 in mu.</span></span></span>
<span class="r-in"><span><span class="co">## pathplot(b2, name = "mu.s.s(x3).b")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## (3) Boosting type flavor, only update model term with</span></span></span>
<span class="r-in"><span><span class="co">##     the largest contribution in the "out-of-sample"</span></span></span>
<span class="r-in"><span><span class="co">##     log-likelihood. In this case, if edf = 0 during</span></span></span>
<span class="r-in"><span><span class="co">##     runtime of the algorithm, no model has an additional</span></span></span>
<span class="r-in"><span><span class="co">##     contribution and the algorithm converges. This</span></span></span>
<span class="r-in"><span><span class="co">##     behavior is controlled by argument eps_loglik, the</span></span></span>
<span class="r-in"><span><span class="co">##     higher eps_loglik, the more restrictive is the</span></span></span>
<span class="r-in"><span><span class="co">##     updating step.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Initialize intercepts.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">batch_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">400</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">b0</span> <span class="op">&lt;-</span> <span class="fu"><a href="bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">d</span>, sampler <span class="op">=</span> <span class="cn">FALSE</span>, optimizer <span class="op">=</span> <span class="va">opt_bbfitp</span>,</span></span>
<span class="r-in"><span>  batch_ids <span class="op">=</span> <span class="va">batch_ids</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    * iter 1, nobs 1000, edf 0.000000   * iter 2, nobs 2000, eps 0.000000, edf 0.000000   * iter 3, nobs 3000, eps 0.000000, edf 0.000000   * iter 4, nobs 4000, eps 0.000000, edf 0.000000   * iter 5, nobs 5000, eps 0.000000, edf 0.000000   * iter 6, nobs 6000, eps 0.000000, edf 0.000000   * iter 7, nobs 7000, eps 0.000000, edf 0.000000   * iter 8, nobs 8000, eps 0.000000, edf 0.000000   * iter 9, nobs 9000, eps 0.000000, edf 0.000000   * iter 10, nobs 10000, eps 0.000000, edf 0.000000   * iter 11, nobs 11000, eps 0.000000, edf 0.000000   * iter 12, nobs 12000, eps 0.000000, edf 0.000000   * iter 13, nobs 13000, eps 0.000000, edf 0.000000   * iter 14, nobs 14000, eps 0.000000, edf 0.000000   * iter 15, nobs 15000, eps 0.000000, edf 0.000000   * iter 16, nobs 16000, eps 0.000000, edf 0.000000   * iter 17, nobs 17000, eps 0.000000, edf 0.000000   * iter 18, nobs 18000, eps 0.000000, edf 0.000000   * iter 19, nobs 19000, eps 0.000000, edf 0.000000   * iter 20, nobs 20000, eps 0.000000, edf 0.000000   * iter 21, nobs 21000, eps 0.000000, edf 0.000000   * iter 22, nobs 22000, eps 0.000000, edf 0.000000   * iter 23, nobs 23000, eps 0.000000, edf 0.000000   * iter 24, nobs 24000, eps 0.000000, edf 0.000000   * iter 25, nobs 25000, eps 0.000000, edf 0.000000   * iter 26, nobs 26000, eps 0.000000, edf 0.000000   * iter 27, nobs 27000, eps 0.000000, edf 0.000000   * iter 28, nobs 28000, eps 0.000000, edf 0.000000   * iter 29, nobs 29000, eps 0.000000, edf 0.000000   * iter 30, nobs 30000, eps 0.000000, edf 0.000000   * iter 31, nobs 31000, eps 0.000000, edf 0.000000   * iter 32, nobs 32000, eps 0.000000, edf 0.000000   * iter 33, nobs 33000, eps 0.000000, edf 0.000000   * iter 34, nobs 34000, eps 0.000000, edf 0.000000   * iter 35, nobs 35000, eps 0.000000, edf 0.000000   * iter 36, nobs 36000, eps 0.000000, edf 0.000000   * iter 37, nobs 37000, eps 0.000000, edf 0.000000   * iter 38, nobs 38000, eps 0.000000, edf 0.000000   * iter 39, nobs 39000, eps 0.000000, edf 0.000000   * iter 40, nobs 40000, eps 0.000000, edf 0.000000   * iter 41, nobs 41000, eps 0.000000, edf 0.000000   * iter 42, nobs 42000, eps 0.000000, edf 0.000000   * iter 43, nobs 43000, eps 0.000000, edf 0.000000   * iter 44, nobs 44000, eps 0.000000, edf 0.000000   * iter 45, nobs 45000, eps 0.000000, edf 0.000000   * iter 46, nobs 46000, eps 0.000000, edf 0.000000   * iter 47, nobs 47000, eps 0.000000, edf 0.000000   * iter 48, nobs 48000, eps 0.000000, edf 0.000000   * iter 49, nobs 49000, eps 0.000000, edf 0.000000   * iter 50, nobs 50000, eps 0.000000, edf 0.000000   * iter 51, nobs 51000, eps 0.000000, edf 0.000000   * iter 52, nobs 52000, eps 0.000000, edf 0.000000   * iter 53, nobs 53000, eps 0.000000, edf 0.000000   * iter 54, nobs 54000, eps 0.000000, edf 0.000000   * iter 55, nobs 55000, eps 0.000000, edf 0.000000   * iter 56, nobs 56000, eps 0.000000, edf 0.000000   * iter 57, nobs 57000, eps 0.000000, edf 0.000000   * iter 58, nobs 58000, eps 0.000000, edf 0.000000   * iter 59, nobs 59000, eps 0.000000, edf 0.000000   * iter 60, nobs 60000, eps 0.000000, edf 0.000000   * iter 61, nobs 61000, eps 0.000000, edf 0.000000   * iter 62, nobs 62000, eps 0.000000, edf 0.000000   * iter 63, nobs 63000, eps 0.000000, edf 0.000000   * iter 64, nobs 64000, eps 0.000000, edf 0.000000   * iter 65, nobs 65000, eps 0.000000, edf 0.000000   * iter 66, nobs 66000, eps 0.000000, edf 0.000000   * iter 67, nobs 67000, eps 0.000000, edf 0.000000   * iter 68, nobs 68000, eps 0.000000, edf 0.000000   * iter 69, nobs 69000, eps 0.000000, edf 0.000000   * iter 70, nobs 70000, eps 0.000000, edf 0.000000   * iter 71, nobs 71000, eps 0.000000, edf 0.000000   * iter 72, nobs 72000, eps 0.000000, edf 0.000000   * iter 73, nobs 73000, eps 0.000000, edf 0.000000   * iter 74, nobs 74000, eps 0.000000, edf 0.000000   * iter 75, nobs 75000, eps 0.000000, edf 0.000000   * iter 76, nobs 76000, eps 0.000000, edf 0.000000   * iter 77, nobs 77000, eps 0.000000, edf 0.000000   * iter 78, nobs 78000, eps 0.000000, edf 0.000000   * iter 79, nobs 79000, eps 0.000000, edf 0.000000   * iter 80, nobs 80000, eps 0.000000, edf 0.000000   * iter 81, nobs 81000, eps 0.000000, edf 0.000000   * iter 82, nobs 82000, eps 0.000000, edf 0.000000   * iter 83, nobs 83000, eps 0.000000, edf 0.000000   * iter 84, nobs 84000, eps 0.000000, edf 0.000000   * iter 85, nobs 85000, eps 0.000000, edf 0.000000   * iter 86, nobs 86000, eps 0.000000, edf 0.000000   * iter 87, nobs 87000, eps 0.000000, edf 0.000000   * iter 88, nobs 88000, eps 0.000000, edf 0.000000   * iter 89, nobs 89000, eps 0.000000, edf 0.000000   * iter 90, nobs 90000, eps 0.000000, edf 0.000000   * iter 91, nobs 91000, eps 0.000000, edf 0.000000   * iter 92, nobs 92000, eps 0.000000, edf 0.000000   * iter 93, nobs 93000, eps 0.000000, edf 0.000000   * iter 94, nobs 94000, eps 0.000000, edf 0.000000   * iter 95, nobs 95000, eps 0.000000, edf 0.000000   * iter 96, nobs 96000, eps 0.000000, edf 0.000000   * iter 97, nobs 97000, eps 0.000000, edf 0.000000   * iter 98, nobs 98000, eps 0.000000, edf 0.000000   * iter 99, nobs 99000, eps 0.000000, edf 0.000000   * iter 100, nobs 100000, eps 0.000000, edf 0.000000   * iter 101, nobs 101000, eps 0.000000, edf 0.000000   * iter 102, nobs 102000, eps 0.000000, edf 0.000000   * iter 103, nobs 103000, eps 0.000000, edf 0.000000   * iter 104, nobs 104000, eps 0.000000, edf 0.000000   * iter 105, nobs 105000, eps 0.000000, edf 0.000000   * iter 106, nobs 106000, eps 0.000000, edf 0.000000   * iter 107, nobs 107000, eps 0.000000, edf 0.000000   * iter 108, nobs 108000, eps 0.000000, edf 0.000000   * iter 109, nobs 109000, eps 0.000000, edf 0.000000   * iter 110, nobs 110000, eps 0.000000, edf 0.000000   * iter 111, nobs 111000, eps 0.000000, edf 0.000000   * iter 112, nobs 112000, eps 0.000000, edf 0.000000   * iter 113, nobs 113000, eps 0.000000, edf 0.000000   * iter 114, nobs 114000, eps 0.000000, edf 0.000000   * iter 115, nobs 115000, eps 0.000000, edf 0.000000   * iter 116, nobs 116000, eps 0.000000, edf 0.000000   * iter 117, nobs 117000, eps 0.000000, edf 0.000000   * iter 118, nobs 118000, eps 0.000000, edf 0.000000   * iter 119, nobs 119000, eps 0.000000, edf 0.000000   * iter 120, nobs 120000, eps 0.000000, edf 0.000000   * iter 121, nobs 121000, eps 0.000000, edf 0.000000   * iter 122, nobs 122000, eps 0.000000, edf 0.000000   * iter 123, nobs 123000, eps 0.000000, edf 0.000000   * iter 124, nobs 124000, eps 0.000000, edf 0.000000   * iter 125, nobs 125000, eps 0.000000, edf 0.000000   * iter 126, nobs 126000, eps 0.000000, edf 0.000000   * iter 127, nobs 127000, eps 0.000000, edf 0.000000   * iter 128, nobs 128000, eps 0.000000, edf 0.000000   * iter 129, nobs 129000, eps 0.000000, edf 0.000000   * iter 130, nobs 130000, eps 0.000000, edf 0.000000   * iter 131, nobs 131000, eps 0.000000, edf 0.000000   * iter 132, nobs 132000, eps 0.000000, edf 0.000000   * iter 133, nobs 133000, eps 0.000000, edf 0.000000   * iter 134, nobs 134000, eps 0.000000, edf 0.000000   * iter 135, nobs 135000, eps 0.000000, edf 0.000000   * iter 136, nobs 136000, eps 0.000000, edf 0.000000   * iter 137, nobs 137000, eps 0.000000, edf 0.000000   * iter 138, nobs 138000, eps 0.000000, edf 0.000000   * iter 139, nobs 139000, eps 0.000000, edf 0.000000   * iter 140, nobs 140000, eps 0.000000, edf 0.000000   * iter 141, nobs 141000, eps 0.000000, edf 0.000000   * iter 142, nobs 142000, eps 0.000000, edf 0.000000   * iter 143, nobs 143000, eps 0.000000, edf 0.000000   * iter 144, nobs 144000, eps 0.000000, edf 0.000000   * iter 145, nobs 145000, eps 0.000000, edf 0.000000   * iter 146, nobs 146000, eps 0.000000, edf 0.000000   * iter 147, nobs 147000, eps 0.000000, edf 0.000000   * iter 148, nobs 148000, eps 0.000000, edf 0.000000   * iter 149, nobs 149000, eps 0.000000, edf 0.000000   * iter 150, nobs 150000, eps 0.000000, edf 0.000000   * iter 151, nobs 151000, eps 0.000000, edf 0.000000   * iter 152, nobs 152000, eps 0.000000, edf 0.000000   * iter 153, nobs 153000, eps 0.000000, edf 0.000000   * iter 154, nobs 154000, eps 0.000000, edf 0.000000   * iter 155, nobs 155000, eps 0.000000, edf 0.000000   * iter 156, nobs 156000, eps 0.000000, edf 0.000000   * iter 157, nobs 157000, eps 0.000000, edf 0.000000   * iter 158, nobs 158000, eps 0.000000, edf 0.000000   * iter 159, nobs 159000, eps 0.000000, edf 0.000000   * iter 160, nobs 160000, eps 0.000000, edf 0.000000   * iter 161, nobs 161000, eps 0.000000, edf 0.000000   * iter 162, nobs 162000, eps 0.000000, edf 0.000000   * iter 163, nobs 163000, eps 0.000000, edf 0.000000   * iter 164, nobs 164000, eps 0.000000, edf 0.000000   * iter 165, nobs 165000, eps 0.000000, edf 0.000000   * iter 166, nobs 166000, eps 0.000000, edf 0.000000   * iter 167, nobs 167000, eps 0.000000, edf 0.000000   * iter 168, nobs 168000, eps 0.000000, edf 0.000000   * iter 169, nobs 169000, eps 0.000000, edf 0.000000   * iter 170, nobs 170000, eps 0.000000, edf 0.000000   * iter 171, nobs 171000, eps 0.000000, edf 0.000000   * iter 172, nobs 172000, eps 0.000000, edf 0.000000   * iter 173, nobs 173000, eps 0.000000, edf 0.000000   * iter 174, nobs 174000, eps 0.000000, edf 0.000000   * iter 175, nobs 175000, eps 0.000000, edf 0.000000   * iter 176, nobs 176000, eps 0.000000, edf 0.000000   * iter 177, nobs 177000, eps 0.000000, edf 0.000000   * iter 178, nobs 178000, eps 0.000000, edf 0.000000   * iter 179, nobs 179000, eps 0.000000, edf 0.000000   * iter 180, nobs 180000, eps 0.000000, edf 0.000000   * iter 181, nobs 181000, eps 0.000000, edf 0.000000   * iter 182, nobs 182000, eps 0.000000, edf 0.000000   * iter 183, nobs 183000, eps 0.000000, edf 0.000000   * iter 184, nobs 184000, eps 0.000000, edf 0.000000   * iter 185, nobs 185000, eps 0.000000, edf 0.000000   * iter 186, nobs 186000, eps 0.000000, edf 0.000000   * iter 187, nobs 187000, eps 0.000000, edf 0.000000   * iter 188, nobs 188000, eps 0.000000, edf 0.000000   * iter 189, nobs 189000, eps 0.000000, edf 0.000000   * iter 190, nobs 190000, eps 0.000000, edf 0.000000   * iter 191, nobs 191000, eps 0.000000, edf 0.000000   * iter 192, nobs 192000, eps 0.000000, edf 0.000000   * iter 193, nobs 193000, eps 0.000000, edf 0.000000   * iter 194, nobs 194000, eps 0.000000, edf 0.000000   * iter 195, nobs 195000, eps 0.000000, edf 0.000000   * iter 196, nobs 196000, eps 0.000000, edf 0.000000   * iter 197, nobs 197000, eps 0.000000, edf 0.000000   * iter 198, nobs 198000, eps 0.000000, edf 0.000000   * iter 199, nobs 199000, eps 0.000000, edf 0.000000   * iter 200, nobs 200000, eps 0.000000, edf 0.000000   * iter 201, nobs 201000, eps 0.000000, edf 0.000000   * iter 202, nobs 202000, eps 0.000000, edf 0.000000   * iter 203, nobs 203000, eps 0.000000, edf 0.000000   * iter 204, nobs 204000, eps 0.000000, edf 0.000000   * iter 205, nobs 205000, eps 0.000000, edf 0.000000   * iter 206, nobs 206000, eps 0.000000, edf 0.000000   * iter 207, nobs 207000, eps 0.000000, edf 0.000000   * iter 208, nobs 208000, eps 0.000000, edf 0.000000   * iter 209, nobs 209000, eps 0.000000, edf 0.000000   * iter 210, nobs 210000, eps 0.000000, edf 0.000000   * iter 211, nobs 211000, eps 0.000000, edf 0.000000   * iter 212, nobs 212000, eps 0.000000, edf 0.000000   * iter 213, nobs 213000, eps 0.000000, edf 0.000000   * iter 214, nobs 214000, eps 0.000000, edf 0.000000   * iter 215, nobs 215000, eps 0.000000, edf 0.000000   * iter 216, nobs 216000, eps 0.000000, edf 0.000000   * iter 217, nobs 217000, eps 0.000000, edf 0.000000   * iter 218, nobs 218000, eps 0.000000, edf 0.000000   * iter 219, nobs 219000, eps 0.000000, edf 0.000000   * iter 220, nobs 220000, eps 0.000000, edf 0.000000   * iter 221, nobs 221000, eps 0.000000, edf 0.000000   * iter 222, nobs 222000, eps 0.000000, edf 0.000000   * iter 223, nobs 223000, eps 0.000000, edf 0.000000   * iter 224, nobs 224000, eps 0.000000, edf 0.000000   * iter 225, nobs 225000, eps 0.000000, edf 0.000000   * iter 226, nobs 226000, eps 0.000000, edf 0.000000   * iter 227, nobs 227000, eps 0.000000, edf 0.000000   * iter 228, nobs 228000, eps 0.000000, edf 0.000000   * iter 229, nobs 229000, eps 0.000000, edf 0.000000   * iter 230, nobs 230000, eps 0.000000, edf 0.000000   * iter 231, nobs 231000, eps 0.000000, edf 0.000000   * iter 232, nobs 232000, eps 0.000000, edf 0.000000   * iter 233, nobs 233000, eps 0.000000, edf 0.000000   * iter 234, nobs 234000, eps 0.000000, edf 0.000000   * iter 235, nobs 235000, eps 0.000000, edf 0.000000   * iter 236, nobs 236000, eps 0.000000, edf 0.000000   * iter 237, nobs 237000, eps 0.000000, edf 0.000000   * iter 238, nobs 238000, eps 0.000000, edf 0.000000   * iter 239, nobs 239000, eps 0.000000, edf 0.000000   * iter 240, nobs 240000, eps 0.000000, edf 0.000000   * iter 241, nobs 241000, eps 0.000000, edf 0.000000   * iter 242, nobs 242000, eps 0.000000, edf 0.000000   * iter 243, nobs 243000, eps 0.000000, edf 0.000000   * iter 244, nobs 244000, eps 0.000000, edf 0.000000   * iter 245, nobs 245000, eps 0.000000, edf 0.000000   * iter 246, nobs 246000, eps 0.000000, edf 0.000000   * iter 247, nobs 247000, eps 0.000000, edf 0.000000   * iter 248, nobs 248000, eps 0.000000, edf 0.000000   * iter 249, nobs 249000, eps 0.000000, edf 0.000000   * iter 250, nobs 250000, eps 0.000000, edf 0.000000   * iter 251, nobs 251000, eps 0.000000, edf 0.000000   * iter 252, nobs 252000, eps 0.000000, edf 0.000000   * iter 253, nobs 253000, eps 0.000000, edf 0.000000   * iter 254, nobs 254000, eps 0.000000, edf 0.000000   * iter 255, nobs 255000, eps 0.000000, edf 0.000000   * iter 256, nobs 256000, eps 0.000000, edf 0.000000   * iter 257, nobs 257000, eps 0.000000, edf 0.000000   * iter 258, nobs 258000, eps 0.000000, edf 0.000000   * iter 259, nobs 259000, eps 0.000000, edf 0.000000   * iter 260, nobs 260000, eps 0.000000, edf 0.000000   * iter 261, nobs 261000, eps 0.000000, edf 0.000000   * iter 262, nobs 262000, eps 0.000000, edf 0.000000   * iter 263, nobs 263000, eps 0.000000, edf 0.000000   * iter 264, nobs 264000, eps 0.000000, edf 0.000000   * iter 265, nobs 265000, eps 0.000000, edf 0.000000   * iter 266, nobs 266000, eps 0.000000, edf 0.000000   * iter 267, nobs 267000, eps 0.000000, edf 0.000000   * iter 268, nobs 268000, eps 0.000000, edf 0.000000   * iter 269, nobs 269000, eps 0.000000, edf 0.000000   * iter 270, nobs 270000, eps 0.000000, edf 0.000000   * iter 271, nobs 271000, eps 0.000000, edf 0.000000   * iter 272, nobs 272000, eps 0.000000, edf 0.000000   * iter 273, nobs 273000, eps 0.000000, edf 0.000000   * iter 274, nobs 274000, eps 0.000000, edf 0.000000   * iter 275, nobs 275000, eps 0.000000, edf 0.000000   * iter 276, nobs 276000, eps 0.000000, edf 0.000000   * iter 277, nobs 277000, eps 0.000000, edf 0.000000   * iter 278, nobs 278000, eps 0.000000, edf 0.000000   * iter 279, nobs 279000, eps 0.000000, edf 0.000000   * iter 280, nobs 280000, eps 0.000000, edf 0.000000   * iter 281, nobs 281000, eps 0.000000, edf 0.000000   * iter 282, nobs 282000, eps 0.000000, edf 0.000000   * iter 283, nobs 283000, eps 0.000000, edf 0.000000   * iter 284, nobs 284000, eps 0.000000, edf 0.000000   * iter 285, nobs 285000, eps 0.000000, edf 0.000000   * iter 286, nobs 286000, eps 0.000000, edf 0.000000   * iter 287, nobs 287000, eps 0.000000, edf 0.000000   * iter 288, nobs 288000, eps 0.000000, edf 0.000000   * iter 289, nobs 289000, eps 0.000000, edf 0.000000   * iter 290, nobs 290000, eps 0.000000, edf 0.000000   * iter 291, nobs 291000, eps 0.000000, edf 0.000000   * iter 292, nobs 292000, eps 0.000000, edf 0.000000   * iter 293, nobs 293000, eps 0.000000, edf 0.000000   * iter 294, nobs 294000, eps 0.000000, edf 0.000000   * iter 295, nobs 295000, eps 0.000000, edf 0.000000   * iter 296, nobs 296000, eps 0.000000, edf 0.000000   * iter 297, nobs 297000, eps 0.000000, edf 0.000000   * iter 298, nobs 298000, eps 0.000000, edf 0.000000   * iter 299, nobs 299000, eps 0.000000, edf 0.000000   * iter 300, nobs 300000, eps 0.000000, edf 0.000000   * iter 301, nobs 301000, eps 0.000000, edf 0.000000   * iter 302, nobs 302000, eps 0.000000, edf 0.000000   * iter 303, nobs 303000, eps 0.000000, edf 0.000000   * iter 304, nobs 304000, eps 0.000000, edf 0.000000   * iter 305, nobs 305000, eps 0.000000, edf 0.000000   * iter 306, nobs 306000, eps 0.000000, edf 0.000000   * iter 307, nobs 307000, eps 0.000000, edf 0.000000   * iter 308, nobs 308000, eps 0.000000, edf 0.000000   * iter 309, nobs 309000, eps 0.000000, edf 0.000000   * iter 310, nobs 310000, eps 0.000000, edf 0.000000   * iter 311, nobs 311000, eps 0.000000, edf 0.000000   * iter 312, nobs 312000, eps 0.000000, edf 0.000000   * iter 313, nobs 313000, eps 0.000000, edf 0.000000   * iter 314, nobs 314000, eps 0.000000, edf 0.000000   * iter 315, nobs 315000, eps 0.000000, edf 0.000000   * iter 316, nobs 316000, eps 0.000000, edf 0.000000   * iter 317, nobs 317000, eps 0.000000, edf 0.000000   * iter 318, nobs 318000, eps 0.000000, edf 0.000000   * iter 319, nobs 319000, eps 0.000000, edf 0.000000   * iter 320, nobs 320000, eps 0.000000, edf 0.000000   * iter 321, nobs 321000, eps 0.000000, edf 0.000000   * iter 322, nobs 322000, eps 0.000000, edf 0.000000   * iter 323, nobs 323000, eps 0.000000, edf 0.000000   * iter 324, nobs 324000, eps 0.000000, edf 0.000000   * iter 325, nobs 325000, eps 0.000000, edf 0.000000   * iter 326, nobs 326000, eps 0.000000, edf 0.000000   * iter 327, nobs 327000, eps 0.000000, edf 0.000000   * iter 328, nobs 328000, eps 0.000000, edf 0.000000   * iter 329, nobs 329000, eps 0.000000, edf 0.000000   * iter 330, nobs 330000, eps 0.000000, edf 0.000000   * iter 331, nobs 331000, eps 0.000000, edf 0.000000   * iter 332, nobs 332000, eps 0.000000, edf 0.000000   * iter 333, nobs 333000, eps 0.000000, edf 0.000000   * iter 334, nobs 334000, eps 0.000000, edf 0.000000   * iter 335, nobs 335000, eps 0.000000, edf 0.000000   * iter 336, nobs 336000, eps 0.000000, edf 0.000000   * iter 337, nobs 337000, eps 0.000000, edf 0.000000   * iter 338, nobs 338000, eps 0.000000, edf 0.000000   * iter 339, nobs 339000, eps 0.000000, edf 0.000000   * iter 340, nobs 340000, eps 0.000000, edf 0.000000   * iter 341, nobs 341000, eps 0.000000, edf 0.000000   * iter 342, nobs 342000, eps 0.000000, edf 0.000000   * iter 343, nobs 343000, eps 0.000000, edf 0.000000   * iter 344, nobs 344000, eps 0.000000, edf 0.000000   * iter 345, nobs 345000, eps 0.000000, edf 0.000000   * iter 346, nobs 346000, eps 0.000000, edf 0.000000   * iter 347, nobs 347000, eps 0.000000, edf 0.000000   * iter 348, nobs 348000, eps 0.000000, edf 0.000000   * iter 349, nobs 349000, eps 0.000000, edf 0.000000   * iter 350, nobs 350000, eps 0.000000, edf 0.000000   * iter 351, nobs 351000, eps 0.000000, edf 0.000000   * iter 352, nobs 352000, eps 0.000000, edf 0.000000   * iter 353, nobs 353000, eps 0.000000, edf 0.000000   * iter 354, nobs 354000, eps 0.000000, edf 0.000000   * iter 355, nobs 355000, eps 0.000000, edf 0.000000   * iter 356, nobs 356000, eps 0.000000, edf 0.000000   * iter 357, nobs 357000, eps 0.000000, edf 0.000000   * iter 358, nobs 358000, eps 0.000000, edf 0.000000   * iter 359, nobs 359000, eps 0.000000, edf 0.000000   * iter 360, nobs 360000, eps 0.000000, edf 0.000000   * iter 361, nobs 361000, eps 0.000000, edf 0.000000   * iter 362, nobs 362000, eps 0.000000, edf 0.000000   * iter 363, nobs 363000, eps 0.000000, edf 0.000000   * iter 364, nobs 364000, eps 0.000000, edf 0.000000   * iter 365, nobs 365000, eps 0.000000, edf 0.000000   * iter 366, nobs 366000, eps 0.000000, edf 0.000000   * iter 367, nobs 367000, eps 0.000000, edf 0.000000   * iter 368, nobs 368000, eps 0.000000, edf 0.000000   * iter 369, nobs 369000, eps 0.000000, edf 0.000000   * iter 370, nobs 370000, eps 0.000000, edf 0.000000   * iter 371, nobs 371000, eps 0.000000, edf 0.000000   * iter 372, nobs 372000, eps 0.000000, edf 0.000000   * iter 373, nobs 373000, eps 0.000000, edf 0.000000   * iter 374, nobs 374000, eps 0.000000, edf 0.000000   * iter 375, nobs 375000, eps 0.000000, edf 0.000000   * iter 376, nobs 376000, eps 0.000000, edf 0.000000   * iter 377, nobs 377000, eps 0.000000, edf 0.000000   * iter 378, nobs 378000, eps 0.000000, edf 0.000000   * iter 379, nobs 379000, eps 0.000000, edf 0.000000   * iter 380, nobs 380000, eps 0.000000, edf 0.000000   * iter 381, nobs 381000, eps 0.000000, edf 0.000000   * iter 382, nobs 382000, eps 0.000000, edf 0.000000   * iter 383, nobs 383000, eps 0.000000, edf 0.000000   * iter 384, nobs 384000, eps 0.000000, edf 0.000000   * iter 385, nobs 385000, eps 0.000000, edf 0.000000   * iter 386, nobs 386000, eps 0.000000, edf 0.000000   * iter 387, nobs 387000, eps 0.000000, edf 0.000000   * iter 388, nobs 388000, eps 0.000000, edf 0.000000   * iter 389, nobs 389000, eps 0.000000, edf 0.000000   * iter 390, nobs 390000, eps 0.000000, edf 0.000000   * iter 391, nobs 391000, eps 0.000000, edf 0.000000   * iter 392, nobs 392000, eps 0.000000, edf 0.000000   * iter 393, nobs 393000, eps 0.000000, edf 0.000000   * iter 394, nobs 394000, eps 0.000000, edf 0.000000   * iter 395, nobs 395000, eps 0.000000, edf 0.000000   * iter 396, nobs 396000, eps 0.000000, edf 0.000000   * iter 397, nobs 397000, eps 0.000000, edf 0.000000   * iter 398, nobs 398000, eps 0.000000, edf 0.000000   * iter 399, nobs 399000, eps 0.000000, edf 0.000000   * iter 400, nobs 400000, eps 0.000000, edf 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> elapsed time:  1.00sec</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Compute starting values, remove the first</span></span></span>
<span class="r-in"><span><span class="co">## 10 iterates and compute the mean of the</span></span></span>
<span class="r-in"><span><span class="co">## remaining iterates.</span></span></span>
<span class="r-in"><span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">b0</span>, FUN <span class="op">=</span> <span class="va">mean</span>, burnin <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Start boosting, only update if change in</span></span></span>
<span class="r-in"><span><span class="co">## "out-of-sample" log-likelihood is 0.1</span></span></span>
<span class="r-in"><span><span class="co">## eps_loglik = 0.001.</span></span></span>
<span class="r-in"><span><span class="va">b3</span> <span class="op">&lt;-</span> <span class="fu"><a href="bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">d</span>, sampler <span class="op">=</span> <span class="cn">FALSE</span>, optimizer <span class="op">=</span> <span class="va">opt_bbfit</span>,</span></span>
<span class="r-in"><span>    batch_ids <span class="op">=</span> <span class="va">batch_ids</span>, nu <span class="op">=</span> <span class="fl">0.1</span>, aic <span class="op">=</span> <span class="cn">TRUE</span>, eps_loglik <span class="op">=</span> <span class="fl">0.001</span>,</span></span>
<span class="r-in"><span>    select <span class="op">=</span> <span class="cn">TRUE</span>, always <span class="op">=</span> <span class="cn">FALSE</span>, start <span class="op">=</span> <span class="va">start</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term s(x1) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term s(x2) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term s(x3) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term te(lon,lat) 10.00046 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term s(x1) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term s(x2) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term s(x3) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term te(lon,lat) 10.00207 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    * iter 1, nobs 1000, edf 18.484400   * iter 2, nobs 2000, eps 0.021400, edf 17.720000   * iter 3, nobs 3000, eps 0.025900, edf 19.010000   * iter 4, nobs 4000, eps 0.009400, edf 17.690000   * iter 5, nobs 5000, eps 0.014300, edf 24.540000   * iter 6, nobs 6000, eps 0.399700, edf 19.040000   * iter 7, nobs 7000, eps 0.029000, edf 20.150000   * iter 8, nobs 8000, eps 0.020900, edf 18.710000   * iter 9, nobs 9000, eps 0.025700, edf 19.540000   * iter 10, nobs 10000, eps 0.036900, edf 20.460000   * iter 11, nobs 11000, eps 1.584700, edf 21.220000   * iter 12, nobs 12000, eps 0.037200, edf 18.540000   * iter 13, nobs 13000, eps 3.215500, edf 20.350000   * iter 14, nobs 14000, eps 11.822900, edf 14.610000   * iter 15, nobs 15000, eps 0.502200, edf 14.910000   * iter 16, nobs 16000, eps 0.032700, edf 19.300000   * iter 17, nobs 17000, eps 1.853800, edf 22.960000   * iter 18, nobs 18000, eps 0.039000, edf 20.740000   * iter 19, nobs 19000, eps 0.040800, edf 23.100000   * iter 20, nobs 20000, eps 0.503100, edf 22.860000   * iter 21, nobs 21000, eps 0.503800, edf 17.790000   * iter 22, nobs 22000, eps 2.952300, edf 23.200000   * iter 23, nobs 23000, eps 1.287500, edf 13.860000   * iter 24, nobs 24000, eps 20.638100, edf 21.810000   * iter 25, nobs 25000, eps 0.048300, edf 20.170000   * iter 26, nobs 26000, eps 0.049200, edf 21.800000   * iter 27, nobs 27000, eps 0.508700, edf 11.420000   * iter 28, nobs 28000, eps 1.299400, edf 17.350000   * iter 29, nobs 29000, eps 1.667600, edf 20.900000   * iter 30, nobs 30000, eps 0.051100, edf 22.880000   * iter 31, nobs 31000, eps 0.056100, edf 17.010000   * iter 32, nobs 32000, eps 0.511200, edf 4.640000   * iter 33, nobs 33000, eps 0.509400, edf 4.650000   * iter 34, nobs 34000, eps 1.583100, edf 5.620000   * iter 35, nobs 35000, eps 2.030400, edf 19.230000   * iter 36, nobs 36000, eps 0.061900, edf 21.190000   * iter 37, nobs 37000, eps 0.066700, edf 22.360000   * iter 38, nobs 38000, eps 0.061800, edf 18.740000   * iter 39, nobs 39000, eps 0.515700, edf 9.060000   * iter 40, nobs 40000, eps 0.518500, edf 7.970000   * iter 41, nobs 41000, eps 2.732300, edf 5.430000   * iter 42, nobs 42000, eps 0.518800, edf 11.910000   * iter 43, nobs 43000, eps 1.389300, edf 11.440000   * iter 44, nobs 44000, eps 1.639500, edf 15.450000   * iter 45, nobs 45000, eps 0.516800, edf 12.530000   * iter 46, nobs 46000, eps 0.523200, edf 11.410000   * iter 47, nobs 47000, eps 4.584100, edf 12.090000   * iter 48, nobs 48000, eps 1.186700, edf 18.000000   * iter 49, nobs 49000, eps 0.077100, edf 13.530000   * iter 50, nobs 50000, eps 0.071200, edf 19.350000   * iter 51, nobs 51000, eps 4.285400, edf 8.320000   * iter 52, nobs 52000, eps 0.079700, edf 10.760000   * iter 53, nobs 53000, eps 1.284300, edf 14.690000   * iter 54, nobs 54000, eps 0.527200, edf 19.220000   * iter 55, nobs 55000, eps 1.911300, edf 9.420000   * iter 56, nobs 56000, eps 0.084500, edf 4.710000   * iter 57, nobs 57000, eps 0.529600, edf 5.230000   * iter 58, nobs 58000, eps 0.080700, edf 11.210000   * iter 59, nobs 59000, eps 0.090100, edf 14.220000   * iter 60, nobs 60000, eps 0.088200, edf 7.370000   * iter 61, nobs 61000, eps 1.074400, edf 16.620000   * iter 62, nobs 62000, eps 0.101200, edf 7.770000   * iter 63, nobs 63000, eps 1.393200, edf 7.940000   * iter 64, nobs 64000, eps 0.095100, edf 8.240000   * iter 65, nobs 65000, eps 0.546800, edf 1.000000   * iter 66, nobs 66000, eps 1.880300, edf 2.280000   * iter 67, nobs 67000, eps 0.000000, edf 0.000000   * iter 68, nobs 68000, eps 0.545300, edf 9.220000   * iter 69, nobs 69000, eps 0.547800, edf 1.000000   * iter 70, nobs 70000, eps 0.000000, edf 0.000000   * iter 71, nobs 71000, eps 1.256800, edf 3.720000   * iter 72, nobs 72000, eps 0.000000, edf 0.000000   * iter 73, nobs 73000, eps 0.547600, edf 1.000000   * iter 74, nobs 74000, eps 1.391300, edf 11.170000   * iter 75, nobs 75000, eps 0.974800, edf 7.220000   * iter 76, nobs 76000, eps 0.545700, edf 1.000000   * iter 77, nobs 77000, eps 0.547900, edf 1.000000   * iter 78, nobs 78000, eps 0.000000, edf 0.000000   * iter 79, nobs 79000, eps 0.000000, edf 0.000000   * iter 80, nobs 80000, eps 0.551500, edf 1.000000   * iter 81, nobs 81000, eps 2.119800, edf 1.290000   * iter 82, nobs 82000, eps 0.105500, edf 6.920000   * iter 83, nobs 83000, eps 0.000000, edf 0.000000   * iter 84, nobs 84000, eps 0.112300, edf 8.830000   * iter 85, nobs 85000, eps 0.110000, edf 4.570000   * iter 86, nobs 86000, eps 1.237700, edf 6.540000   * iter 87, nobs 87000, eps 0.000000, edf 0.000000   * iter 88, nobs 88000, eps 0.127300, edf 19.190000   * iter 89, nobs 89000, eps 0.000000, edf 0.000000   * iter 90, nobs 90000, eps 0.000000, edf 0.000000   * iter 91, nobs 91000, eps 0.000000, edf 0.000000   * iter 92, nobs 92000, eps 0.000000, edf 0.000000   * iter 93, nobs 93000, eps 4.957400, edf 6.560000   * iter 94, nobs 94000, eps 0.000000, edf 0.000000   * iter 95, nobs 95000, eps 0.000000, edf 0.000000   * iter 96, nobs 96000, eps 0.000000, edf 0.000000   * iter 97, nobs 97000, eps 0.000000, edf 0.000000   * iter 98, nobs 98000, eps 0.000000, edf 0.000000   * iter 99, nobs 99000, eps 0.000000, edf 0.000000   * iter 100, nobs 100000, eps 0.000000, edf 0.000000   * iter 101, nobs 101000, eps 0.000000, edf 0.000000   * iter 102, nobs 102000, eps 0.000000, edf 0.000000   * iter 103, nobs 103000, eps 0.000000, edf 0.000000   * iter 104, nobs 104000, eps 0.000000, edf 0.000000   * iter 105, nobs 105000, eps 0.573000, edf 7.530000   * iter 106, nobs 106000, eps 1.190300, edf 1.040000   * iter 107, nobs 107000, eps 1.533600, edf 12.350000   * iter 108, nobs 108000, eps 0.137000, edf 8.140000   * iter 109, nobs 109000, eps 1.878900, edf 6.560000   * iter 110, nobs 110000, eps 0.138600, edf 7.840000   * iter 111, nobs 111000, eps 0.000000, edf 0.000000   * iter 112, nobs 112000, eps 0.591000, edf 1.000000   * iter 113, nobs 113000, eps 0.000000, edf 0.000000   * iter 114, nobs 114000, eps 0.000000, edf 0.000000   * iter 115, nobs 115000, eps 0.000000, edf 0.000000   * iter 116, nobs 116000, eps 0.000000, edf 0.000000   * iter 117, nobs 117000, eps 0.126700, edf 2.580000   * iter 118, nobs 118000, eps 0.000000, edf 0.000000   * iter 119, nobs 119000, eps 1.275900, edf 7.480000   * iter 120, nobs 120000, eps 0.000000, edf 0.000000   * iter 121, nobs 121000, eps 0.000000, edf 0.000000   * iter 122, nobs 122000, eps 0.000000, edf 0.000000   * iter 123, nobs 123000, eps 0.000000, edf 0.000000   * iter 124, nobs 124000, eps 0.148800, edf 7.570000   * iter 125, nobs 125000, eps 0.000000, edf 0.000000   * iter 126, nobs 126000, eps 1.144100, edf 7.510000   * iter 127, nobs 127000, eps 0.582200, edf 1.000000   * iter 128, nobs 128000, eps 0.606200, edf 1.000000   * iter 129, nobs 129000, eps 0.000000, edf 0.000000   * iter 130, nobs 130000, eps 0.000000, edf 0.000000   * iter 131, nobs 131000, eps 0.000000, edf 0.000000   * iter 132, nobs 132000, eps 0.000000, edf 0.000000   * iter 133, nobs 133000, eps 1.531100, edf 8.160000   * iter 134, nobs 134000, eps 0.000000, edf 0.000000   * iter 135, nobs 135000, eps 0.000000, edf 0.000000   * iter 136, nobs 136000, eps 0.000000, edf 0.000000   * iter 137, nobs 137000, eps 0.000000, edf 0.000000   * iter 138, nobs 138000, eps 0.000000, edf 0.000000   * iter 139, nobs 139000, eps 0.604500, edf 1.000000   * iter 140, nobs 140000, eps 0.000000, edf 0.000000   * iter 141, nobs 141000, eps 2.518600, edf 8.300000   * iter 142, nobs 142000, eps 0.000000, edf 0.000000   * iter 143, nobs 143000, eps 0.000000, edf 0.000000   * iter 144, nobs 144000, eps 0.000000, edf 0.000000   * iter 145, nobs 145000, eps 0.000000, edf 0.000000   * iter 146, nobs 146000, eps 0.000000, edf 0.000000   * iter 147, nobs 147000, eps 0.000000, edf 0.000000   * iter 148, nobs 148000, eps 0.000000, edf 0.000000   * iter 149, nobs 149000, eps 0.000000, edf 0.000000   * iter 150, nobs 150000, eps 0.000000, edf 0.000000   * iter 151, nobs 151000, eps 0.000000, edf 0.000000   * iter 152, nobs 152000, eps 0.143500, edf 3.360000   * iter 153, nobs 153000, eps 0.145600, edf 3.220000   * iter 154, nobs 154000, eps 0.000000, edf 0.000000   * iter 155, nobs 155000, eps 0.000000, edf 0.000000   * iter 156, nobs 156000, eps 0.000000, edf 0.000000   * iter 157, nobs 157000, eps 0.160600, edf 2.930000   * iter 158, nobs 158000, eps 0.171100, edf 3.600000   * iter 159, nobs 159000, eps 0.000000, edf 0.000000   * iter 160, nobs 160000, eps 0.000000, edf 0.000000   * iter 161, nobs 161000, eps 0.000000, edf 0.000000   * iter 162, nobs 162000, eps 0.000000, edf 0.000000   * iter 163, nobs 163000, eps 0.181600, edf 5.980000   * iter 164, nobs 164000, eps 0.000000, edf 0.000000   * iter 165, nobs 165000, eps 0.000000, edf 0.000000   * iter 166, nobs 166000, eps 0.000000, edf 0.000000   * iter 167, nobs 167000, eps 0.000000, edf 0.000000   * iter 168, nobs 168000, eps 0.000000, edf 0.000000   * iter 169, nobs 169000, eps 0.000000, edf 0.000000   * iter 170, nobs 170000, eps 0.193500, edf 7.220000   * iter 171, nobs 171000, eps 0.193000, edf 8.740000   * iter 172, nobs 172000, eps 0.000000, edf 0.000000   * iter 173, nobs 173000, eps 0.000000, edf 0.000000   * iter 174, nobs 174000, eps 0.000000, edf 0.000000   * iter 175, nobs 175000, eps 1.017800, edf 8.630000   * iter 176, nobs 176000, eps 0.000000, edf 0.000000   * iter 177, nobs 177000, eps 0.000000, edf 0.000000   * iter 178, nobs 178000, eps 1.253100, edf 1.000000   * iter 179, nobs 179000, eps 0.000000, edf 0.000000   * iter 180, nobs 180000, eps 0.000000, edf 0.000000   * iter 181, nobs 181000, eps 0.000000, edf 0.000000   * iter 182, nobs 182000, eps 0.000000, edf 0.000000   * iter 183, nobs 183000, eps 0.000000, edf 0.000000   * iter 184, nobs 184000, eps 0.000000, edf 0.000000   * iter 185, nobs 185000, eps 0.000000, edf 0.000000   * iter 186, nobs 186000, eps 0.000000, edf 0.000000   * iter 187, nobs 187000, eps 0.000000, edf 0.000000   * iter 188, nobs 188000, eps 0.000000, edf 0.000000   * iter 189, nobs 189000, eps 0.000000, edf 0.000000   * iter 190, nobs 190000, eps 0.000000, edf 0.000000   * iter 191, nobs 191000, eps 0.000000, edf 0.000000   * iter 192, nobs 192000, eps 0.000000, edf 0.000000   * iter 193, nobs 193000, eps 0.000000, edf 0.000000   * iter 194, nobs 194000, eps 0.000000, edf 0.000000   * iter 195, nobs 195000, eps 0.000000, edf 0.000000   * iter 196, nobs 196000, eps 0.000000, edf 0.000000   * iter 197, nobs 197000, eps 0.000000, edf 0.000000   * iter 198, nobs 198000, eps 0.000000, edf 0.000000   * iter 199, nobs 199000, eps 0.000000, edf 0.000000   * iter 200, nobs 200000, eps 0.000000, edf 0.000000   * iter 201, nobs 201000, eps 0.000000, edf 0.000000   * iter 202, nobs 202000, eps 0.000000, edf 0.000000   * iter 203, nobs 203000, eps 0.000000, edf 0.000000   * iter 204, nobs 204000, eps 0.000000, edf 0.000000   * iter 205, nobs 205000, eps 0.000000, edf 0.000000   * iter 206, nobs 206000, eps 0.000000, edf 0.000000   * iter 207, nobs 207000, eps 0.000000, edf 0.000000   * iter 208, nobs 208000, eps 0.000000, edf 0.000000   * iter 209, nobs 209000, eps 0.000000, edf 0.000000   * iter 210, nobs 210000, eps 0.000000, edf 0.000000   * iter 211, nobs 211000, eps 0.665300, edf 1.000000   * iter 212, nobs 212000, eps 0.000000, edf 0.000000   * iter 213, nobs 213000, eps 0.000000, edf 0.000000   * iter 214, nobs 214000, eps 0.673600, edf 1.000000   * iter 215, nobs 215000, eps 0.000000, edf 0.000000   * iter 216, nobs 216000, eps 0.000000, edf 0.000000   * iter 217, nobs 217000, eps 0.000000, edf 0.000000   * iter 218, nobs 218000, eps 0.000000, edf 0.000000   * iter 219, nobs 219000, eps 0.000000, edf 0.000000   * iter 220, nobs 220000, eps 0.000000, edf 0.000000   * iter 221, nobs 221000, eps 0.000000, edf 0.000000   * iter 222, nobs 222000, eps 0.000000, edf 0.000000   * iter 223, nobs 223000, eps 0.000000, edf 0.000000   * iter 224, nobs 224000, eps 0.000000, edf 0.000000   * iter 225, nobs 225000, eps 0.000000, edf 0.000000   * iter 226, nobs 226000, eps 0.000000, edf 0.000000   * iter 227, nobs 227000, eps 0.000000, edf 0.000000   * iter 228, nobs 228000, eps 2.123400, edf 0.990000   * iter 229, nobs 229000, eps 0.000000, edf 0.000000   * iter 230, nobs 230000, eps 0.000000, edf 0.000000   * iter 231, nobs 231000, eps 0.000000, edf 0.000000   * iter 232, nobs 232000, eps 0.000000, edf 0.000000   * iter 233, nobs 233000, eps 0.000000, edf 0.000000   * iter 234, nobs 234000, eps 0.000000, edf 0.000000   * iter 235, nobs 235000, eps 0.000000, edf 0.000000   * iter 236, nobs 236000, eps 0.000000, edf 0.000000   * iter 237, nobs 237000, eps 0.000000, edf 0.000000   * iter 238, nobs 238000, eps 0.680600, edf 1.000000   * iter 239, nobs 239000, eps 0.000000, edf 0.000000   * iter 240, nobs 240000, eps 0.225700, edf 7.930000   * iter 241, nobs 241000, eps 0.000000, edf 0.000000   * iter 242, nobs 242000, eps 0.000000, edf 0.000000   * iter 243, nobs 243000, eps 0.000000, edf 0.000000   * iter 244, nobs 244000, eps 0.000000, edf 0.000000   * iter 245, nobs 245000, eps 0.000000, edf 0.000000   * iter 246, nobs 246000, eps 0.000000, edf 0.000000   * iter 247, nobs 247000, eps 0.000000, edf 0.000000   * iter 248, nobs 248000, eps 0.000000, edf 0.000000   * iter 249, nobs 249000, eps 0.000000, edf 0.000000   * iter 250, nobs 250000, eps 0.000000, edf 0.000000   * iter 251, nobs 251000, eps 0.000000, edf 0.000000   * iter 252, nobs 252000, eps 0.000000, edf 0.000000   * iter 253, nobs 253000, eps 0.000000, edf 0.000000   * iter 254, nobs 254000, eps 0.000000, edf 0.000000   * iter 255, nobs 255000, eps 0.000000, edf 0.000000   * iter 256, nobs 256000, eps 0.000000, edf 0.000000   * iter 257, nobs 257000, eps 0.000000, edf 0.000000   * iter 258, nobs 258000, eps 0.000000, edf 0.000000   * iter 259, nobs 259000, eps 0.000000, edf 0.000000   * iter 260, nobs 260000, eps 0.000000, edf 0.000000   * iter 261, nobs 261000, eps 0.000000, edf 0.000000   * iter 262, nobs 262000, eps 0.000000, edf 0.000000   * iter 263, nobs 263000, eps 0.000000, edf 0.000000   * iter 264, nobs 264000, eps 0.000000, edf 0.000000   * iter 265, nobs 265000, eps 0.000000, edf 0.000000   * iter 266, nobs 266000, eps 0.000000, edf 0.000000   * iter 267, nobs 267000, eps 0.000000, edf 0.000000   * iter 268, nobs 268000, eps 0.000000, edf 0.000000   * iter 269, nobs 269000, eps 0.000000, edf 0.000000   * iter 270, nobs 270000, eps 0.000000, edf 0.000000   * iter 271, nobs 271000, eps 0.000000, edf 0.000000   * iter 272, nobs 272000, eps 0.000000, edf 0.000000   * iter 273, nobs 273000, eps 0.000000, edf 0.000000   * iter 274, nobs 274000, eps 0.000000, edf 0.000000   * iter 275, nobs 275000, eps 0.000000, edf 0.000000   * iter 276, nobs 276000, eps 0.000000, edf 0.000000   * iter 277, nobs 277000, eps 0.000000, edf 0.000000   * iter 278, nobs 278000, eps 0.000000, edf 0.000000   * iter 279, nobs 279000, eps 43.491500, edf 6.890000   * iter 280, nobs 280000, eps 0.000000, edf 0.000000   * iter 281, nobs 281000, eps 0.000000, edf 0.000000   * iter 282, nobs 282000, eps 0.000000, edf 0.000000   * iter 283, nobs 283000, eps 0.000000, edf 0.000000   * iter 284, nobs 284000, eps 0.000000, edf 0.000000   * iter 285, nobs 285000, eps 0.000000, edf 0.000000   * iter 286, nobs 286000, eps 0.000000, edf 0.000000   * iter 287, nobs 287000, eps 0.000000, edf 0.000000   * iter 288, nobs 288000, eps 0.000000, edf 0.000000   * iter 289, nobs 289000, eps 0.000000, edf 0.000000   * iter 290, nobs 290000, eps 0.000000, edf 0.000000   * iter 291, nobs 291000, eps 0.000000, edf 0.000000   * iter 292, nobs 292000, eps 0.000000, edf 0.000000   * iter 293, nobs 293000, eps 0.000000, edf 0.000000   * iter 294, nobs 294000, eps 0.000000, edf 0.000000   * iter 295, nobs 295000, eps 0.000000, edf 0.000000   * iter 296, nobs 296000, eps 0.000000, edf 0.000000   * iter 297, nobs 297000, eps 0.000000, edf 0.000000   * iter 298, nobs 298000, eps 0.216700, edf 8.680000   * iter 299, nobs 299000, eps 0.000000, edf 0.000000   * iter 300, nobs 300000, eps 0.000000, edf 0.000000   * iter 301, nobs 301000, eps 0.000000, edf 0.000000   * iter 302, nobs 302000, eps 0.000000, edf 0.000000   * iter 303, nobs 303000, eps 0.000000, edf 0.000000   * iter 304, nobs 304000, eps 0.000000, edf 0.000000   * iter 305, nobs 305000, eps 0.000000, edf 0.000000   * iter 306, nobs 306000, eps 0.000000, edf 0.000000   * iter 307, nobs 307000, eps 0.000000, edf 0.000000   * iter 308, nobs 308000, eps 0.000000, edf 0.000000   * iter 309, nobs 309000, eps 0.000000, edf 0.000000   * iter 310, nobs 310000, eps 0.000000, edf 0.000000   * iter 311, nobs 311000, eps 0.000000, edf 0.000000   * iter 312, nobs 312000, eps 0.000000, edf 0.000000   * iter 313, nobs 313000, eps 0.000000, edf 0.000000   * iter 314, nobs 314000, eps 0.000000, edf 0.000000   * iter 315, nobs 315000, eps 0.000000, edf 0.000000   * iter 316, nobs 316000, eps 0.000000, edf 0.000000   * iter 317, nobs 317000, eps 0.000000, edf 0.000000   * iter 318, nobs 318000, eps 0.000000, edf 0.000000   * iter 319, nobs 319000, eps 0.000000, edf 0.000000   * iter 320, nobs 320000, eps 0.000000, edf 0.000000   * iter 321, nobs 321000, eps 0.000000, edf 0.000000   * iter 322, nobs 322000, eps 0.000000, edf 0.000000   * iter 323, nobs 323000, eps 0.000000, edf 0.000000   * iter 324, nobs 324000, eps 0.000000, edf 0.000000   * iter 325, nobs 325000, eps 0.000000, edf 0.000000   * iter 326, nobs 326000, eps 0.000000, edf 0.000000   * iter 327, nobs 327000, eps 0.000000, edf 0.000000   * iter 328, nobs 328000, eps 0.000000, edf 0.000000   * iter 329, nobs 329000, eps 0.000000, edf 0.000000   * iter 330, nobs 330000, eps 0.000000, edf 0.000000   * iter 331, nobs 331000, eps 0.000000, edf 0.000000   * iter 332, nobs 332000, eps 0.000000, edf 0.000000   * iter 333, nobs 333000, eps 0.000000, edf 0.000000   * iter 334, nobs 334000, eps 0.000000, edf 0.000000   * iter 335, nobs 335000, eps 0.000000, edf 0.000000   * iter 336, nobs 336000, eps 0.000000, edf 0.000000   * iter 337, nobs 337000, eps 0.000000, edf 0.000000   * iter 338, nobs 338000, eps 0.000000, edf 0.000000   * iter 339, nobs 339000, eps 0.000000, edf 0.000000   * iter 340, nobs 340000, eps 0.000000, edf 0.000000   * iter 341, nobs 341000, eps 0.000000, edf 0.000000   * iter 342, nobs 342000, eps 0.000000, edf 0.000000   * iter 343, nobs 343000, eps 0.000000, edf 0.000000   * iter 344, nobs 344000, eps 0.000000, edf 0.000000   * iter 345, nobs 345000, eps 0.000000, edf 0.000000   * iter 346, nobs 346000, eps 0.000000, edf 0.000000   * iter 347, nobs 347000, eps 0.000000, edf 0.000000   * iter 348, nobs 348000, eps 0.000000, edf 0.000000   * iter 349, nobs 349000, eps 0.000000, edf 0.000000   * iter 350, nobs 350000, eps 0.000000, edf 0.000000   * iter 351, nobs 351000, eps 0.000000, edf 0.000000   * iter 352, nobs 352000, eps 0.000000, edf 0.000000   * iter 353, nobs 353000, eps 0.000000, edf 0.000000   * iter 354, nobs 354000, eps 0.000000, edf 0.000000   * iter 355, nobs 355000, eps 0.000000, edf 0.000000   * iter 356, nobs 356000, eps 0.000000, edf 0.000000   * iter 357, nobs 357000, eps 0.000000, edf 0.000000   * iter 358, nobs 358000, eps 0.000000, edf 0.000000   * iter 359, nobs 359000, eps 0.000000, edf 0.000000   * iter 360, nobs 360000, eps 0.000000, edf 0.000000   * iter 361, nobs 361000, eps 0.000000, edf 0.000000   * iter 362, nobs 362000, eps 0.000000, edf 0.000000   * iter 363, nobs 363000, eps 0.000000, edf 0.000000   * iter 364, nobs 364000, eps 0.000000, edf 0.000000   * iter 365, nobs 365000, eps 0.000000, edf 0.000000   * iter 366, nobs 366000, eps 0.000000, edf 0.000000   * iter 367, nobs 367000, eps 0.000000, edf 0.000000   * iter 368, nobs 368000, eps 0.000000, edf 0.000000   * iter 369, nobs 369000, eps 0.000000, edf 0.000000   * iter 370, nobs 370000, eps 0.000000, edf 0.000000   * iter 371, nobs 371000, eps 0.000000, edf 0.000000   * iter 372, nobs 372000, eps 0.000000, edf 0.000000   * iter 373, nobs 373000, eps 0.000000, edf 0.000000   * iter 374, nobs 374000, eps 0.000000, edf 0.000000   * iter 375, nobs 375000, eps 0.000000, edf 0.000000   * iter 376, nobs 376000, eps 0.000000, edf 0.000000   * iter 377, nobs 377000, eps 0.000000, edf 0.000000   * iter 378, nobs 378000, eps 0.000000, edf 0.000000   * iter 379, nobs 379000, eps 0.000000, edf 0.000000   * iter 380, nobs 380000, eps 0.000000, edf 0.000000   * iter 381, nobs 381000, eps 0.000000, edf 0.000000   * iter 382, nobs 382000, eps 0.000000, edf 0.000000   * iter 383, nobs 383000, eps 0.000000, edf 0.000000   * iter 384, nobs 384000, eps 0.000000, edf 0.000000   * iter 385, nobs 385000, eps 0.000000, edf 0.000000   * iter 386, nobs 386000, eps 0.000000, edf 0.000000   * iter 387, nobs 387000, eps 0.000000, edf 0.000000   * iter 388, nobs 388000, eps 0.000000, edf 0.000000   * iter 389, nobs 389000, eps 0.697700, edf 1.000000   * iter 390, nobs 390000, eps 0.000000, edf 0.000000   * iter 391, nobs 391000, eps 0.000000, edf 0.000000   * iter 392, nobs 392000, eps 0.000000, edf 0.000000   * iter 393, nobs 393000, eps 0.000000, edf 0.000000   * iter 394, nobs 394000, eps 0.000000, edf 0.000000   * iter 395, nobs 395000, eps 0.000000, edf 0.000000   * iter 396, nobs 396000, eps 0.000000, edf 0.000000   * iter 397, nobs 397000, eps 0.000000, edf 0.000000   * iter 398, nobs 398000, eps 0.000000, edf 0.000000   * iter 399, nobs 399000, eps 0.000000, edf 0.000000   * iter 400, nobs 400000, eps 0.000000, edf 0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> elapsed time:  1.36min</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot log-likelihood contributions.</span></span></span>
<span class="r-in"><span><span class="co">## contribplot(b3)</span></span></span>
<span class="r-in"><span><span class="co">## In this case, the algorithm did not converge,</span></span></span>
<span class="r-in"><span><span class="co">## we need more iterations/batches.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Note, prediction uses last iterate.</span></span></span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">b3</span>, model <span class="op">=</span> <span class="st">"mu"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## (4) Use slice sampling under the "out-of-sample"</span></span></span>
<span class="r-in"><span><span class="co">##     log likelihood for estimation of smoothing</span></span></span>
<span class="r-in"><span><span class="co">##     variances. In this case model terms are always</span></span></span>
<span class="r-in"><span><span class="co">##     updated ad parameter paths behave like a MCMC</span></span></span>
<span class="r-in"><span><span class="co">##     chain. Therefore, use opt_bbfitp(), which stores</span></span></span>
<span class="r-in"><span><span class="co">##     parameter paths as "mcmc" objects and we can</span></span></span>
<span class="r-in"><span><span class="co">##     inspect using traceplots. Note nu = 1 if</span></span></span>
<span class="r-in"><span><span class="co">##     slice = TRUE.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">b4</span> <span class="op">&lt;-</span> <span class="fu"><a href="bamlss.html">bamlss</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">d</span>, sampler <span class="op">=</span> <span class="cn">FALSE</span>, optimizer <span class="op">=</span> <span class="va">opt_bbfitp</span>,</span></span>
<span class="r-in"><span>  batch_ids <span class="op">=</span> <span class="va">batch_ids</span>, aic <span class="op">=</span> <span class="cn">TRUE</span>, slice <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term s(x1) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term s(x2) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term s(x3) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df mu term te(lon,lat) 10.00451 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term s(x1) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term s(x2) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term s(x3) 4.000001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. df sigma term te(lon,lat) 10.00001 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    * iter 1, nobs 1000, edf 38.019000   * iter 2, nobs 2000, eps 1.197100, edf 43.690000   * iter 3, nobs 3000, eps 0.471600, edf 42.620000   * iter 4, nobs 4000, eps 0.890300, edf 46.740000   * iter 5, nobs 5000, eps 0.631100, edf 51.210000   * iter 6, nobs 6000, eps 0.764300, edf 52.610000   * iter 7, nobs 7000, eps 0.893000, edf 51.920000   * iter 8, nobs 8000, eps 1.301900, edf 42.690000   * iter 9, nobs 9000, eps 0.644100, edf 39.720000   * iter 10, nobs 10000, eps 0.906400, edf 39.180000   * iter 11, nobs 11000, eps 1.255200, edf 40.820000   * iter 12, nobs 12000, eps 0.804500, edf 35.060000   * iter 13, nobs 13000, eps 0.881100, edf 40.270000   * iter 14, nobs 14000, eps 0.648700, edf 42.060000   * iter 15, nobs 15000, eps 0.617300, edf 46.520000   * iter 16, nobs 16000, eps 1.308700, edf 42.120000   * iter 17, nobs 17000, eps 0.832800, edf 40.330000   * iter 18, nobs 18000, eps 0.782100, edf 45.610000   * iter 19, nobs 19000, eps 0.518600, edf 42.590000   * iter 20, nobs 20000, eps 0.648100, edf 41.290000   * iter 21, nobs 21000, eps 1.718900, edf 37.890000   * iter 22, nobs 22000, eps 0.885900, edf 39.510000   * iter 23, nobs 23000, eps 1.699800, edf 38.480000   * iter 24, nobs 24000, eps 8.358400, edf 37.330000   * iter 25, nobs 25000, eps 1.129700, edf 42.810000   * iter 26, nobs 26000, eps 0.556200, edf 46.850000   * iter 27, nobs 27000, eps 1.115000, edf 43.260000   * iter 28, nobs 28000, eps 0.550100, edf 39.560000   * iter 29, nobs 29000, eps 0.847200, edf 39.290000   * iter 30, nobs 30000, eps 1.902100, edf 47.630000   * iter 31, nobs 31000, eps 0.544500, edf 50.040000   * iter 32, nobs 32000, eps 0.741400, edf 46.970000   * iter 33, nobs 33000, eps 0.832200, edf 47.180000   * iter 34, nobs 34000, eps 1.535900, edf 39.050000   * iter 35, nobs 35000, eps 1.280800, edf 40.870000   * iter 36, nobs 36000, eps 0.559400, edf 40.000000   * iter 37, nobs 37000, eps 1.496500, edf 35.510000   * iter 38, nobs 38000, eps 0.884700, edf 30.770000   * iter 39, nobs 39000, eps 0.994000, edf 38.200000   * iter 40, nobs 40000, eps 0.915000, edf 38.580000   * iter 41, nobs 41000, eps 0.569200, edf 35.390000   * iter 42, nobs 42000, eps 0.712600, edf 39.260000   * iter 43, nobs 43000, eps 0.619300, edf 36.030000   * iter 44, nobs 44000, eps 0.509500, edf 39.260000   * iter 45, nobs 45000, eps 0.602500, edf 40.950000   * iter 46, nobs 46000, eps 1.153800, edf 38.170000   * iter 47, nobs 47000, eps 0.787700, edf 35.350000   * iter 48, nobs 48000, eps 0.888400, edf 37.920000   * iter 49, nobs 49000, eps 0.670100, edf 35.740000   * iter 50, nobs 50000, eps 1.138400, edf 39.230000   * iter 51, nobs 51000, eps 1.113800, edf 38.880000   * iter 52, nobs 52000, eps 0.877600, edf 36.290000   * iter 53, nobs 53000, eps 0.585000, edf 34.840000   * iter 54, nobs 54000, eps 1.527500, edf 42.130000   * iter 55, nobs 55000, eps 1.238300, edf 42.780000   * iter 56, nobs 56000, eps 0.763300, edf 32.940000   * iter 57, nobs 57000, eps 0.550900, edf 38.410000   * iter 58, nobs 58000, eps 0.689900, edf 33.420000   * iter 59, nobs 59000, eps 1.094000, edf 43.220000   * iter 60, nobs 60000, eps 0.700400, edf 44.480000   * iter 61, nobs 61000, eps 0.535000, edf 39.660000   * iter 62, nobs 62000, eps 1.314700, edf 39.490000   * iter 63, nobs 63000, eps 0.698700, edf 42.780000   * iter 64, nobs 64000, eps 0.812600, edf 39.480000   * iter 65, nobs 65000, eps 1.214300, edf 40.950000   * iter 66, nobs 66000, eps 0.649200, edf 42.570000   * iter 67, nobs 67000, eps 0.864800, edf 46.310000   * iter 68, nobs 68000, eps 0.827000, edf 44.970000   * iter 69, nobs 69000, eps 0.688200, edf 42.030000   * iter 70, nobs 70000, eps 1.419000, edf 40.250000   * iter 71, nobs 71000, eps 0.826800, edf 36.200000   * iter 72, nobs 72000, eps 0.873800, edf 39.340000   * iter 73, nobs 73000, eps 0.547400, edf 36.500000   * iter 74, nobs 74000, eps 0.530500, edf 37.000000   * iter 75, nobs 75000, eps 0.863900, edf 40.880000   * iter 76, nobs 76000, eps 0.600500, edf 36.500000   * iter 77, nobs 77000, eps 0.787000, edf 32.960000   * iter 78, nobs 78000, eps 0.637300, edf 35.310000   * iter 79, nobs 79000, eps 0.568900, edf 43.980000   * iter 80, nobs 80000, eps 0.738900, edf 45.200000   * iter 81, nobs 81000, eps 0.890100, edf 46.600000   * iter 82, nobs 82000, eps 1.028400, edf 45.210000   * iter 83, nobs 83000, eps 0.830300, edf 44.870000   * iter 84, nobs 84000, eps 0.977900, edf 43.290000   * iter 85, nobs 85000, eps 1.041900, edf 46.440000   * iter 86, nobs 86000, eps 0.997500, edf 37.710000   * iter 87, nobs 87000, eps 0.819800, edf 36.160000   * iter 88, nobs 88000, eps 0.901500, edf 34.130000   * iter 89, nobs 89000, eps 0.348700, edf 42.920000   * iter 90, nobs 90000, eps 0.542700, edf 37.460000   * iter 91, nobs 91000, eps 0.597300, edf 36.940000   * iter 92, nobs 92000, eps 0.680500, edf 34.430000   * iter 93, nobs 93000, eps 0.700800, edf 33.130000   * iter 94, nobs 94000, eps 0.583700, edf 36.110000   * iter 95, nobs 95000, eps 45.324000, edf 36.160000   * iter 96, nobs 96000, eps 0.590600, edf 31.180000   * iter 97, nobs 97000, eps 0.523300, edf 31.140000   * iter 98, nobs 98000, eps 1.354000, edf 36.080000   * iter 99, nobs 99000, eps 1.776800, edf 39.660000   * iter 100, nobs 100000, eps 1.210700, edf 46.810000   * iter 101, nobs 101000, eps 0.537900, edf 42.750000   * iter 102, nobs 102000, eps 0.522500, edf 36.690000   * iter 103, nobs 103000, eps 0.540600, edf 36.070000   * iter 104, nobs 104000, eps 0.874100, edf 38.340000   * iter 105, nobs 105000, eps 1.257700, edf 35.730000   * iter 106, nobs 106000, eps 1.254600, edf 37.570000   * iter 107, nobs 107000, eps 2.287900, edf 33.600000   * iter 108, nobs 108000, eps 0.930100, edf 38.840000   * iter 109, nobs 109000, eps 1.179400, edf 39.620000   * iter 110, nobs 110000, eps 0.909700, edf 34.980000   * iter 111, nobs 111000, eps 0.617200, edf 38.840000   * iter 112, nobs 112000, eps 2.823700, edf 43.780000   * iter 113, nobs 113000, eps 0.671600, edf 40.380000   * iter 114, nobs 114000, eps 1.148300, edf 40.290000   * iter 115, nobs 115000, eps 0.844600, edf 36.000000   * iter 116, nobs 116000, eps 1.411200, edf 31.100000   * iter 117, nobs 117000, eps 0.650300, edf 35.850000   * iter 118, nobs 118000, eps 1.480800, edf 38.620000   * iter 119, nobs 119000, eps 1.026300, edf 35.600000   * iter 120, nobs 120000, eps 3.394000, edf 38.640000   * iter 121, nobs 121000, eps 1.280700, edf 44.670000   * iter 122, nobs 122000, eps 0.504100, edf 43.060000   * iter 123, nobs 123000, eps 0.679800, edf 38.370000   * iter 124, nobs 124000, eps 0.857400, edf 43.150000   * iter 125, nobs 125000, eps 0.604500, edf 42.810000   * iter 126, nobs 126000, eps 0.548200, edf 40.870000   * iter 127, nobs 127000, eps 1.008200, edf 32.060000   * iter 128, nobs 128000, eps 0.542900, edf 28.430000   * iter 129, nobs 129000, eps 1.016700, edf 34.850000   * iter 130, nobs 130000, eps 0.584700, edf 39.630000   * iter 131, nobs 131000, eps 0.851300, edf 36.880000   * iter 132, nobs 132000, eps 0.975300, edf 45.190000   * iter 133, nobs 133000, eps 0.586300, edf 34.530000   * iter 134, nobs 134000, eps 0.653700, edf 33.990000   * iter 135, nobs 135000, eps 0.677700, edf 31.150000   * iter 136, nobs 136000, eps 0.601300, edf 31.720000   * iter 137, nobs 137000, eps 0.724200, edf 32.910000   * iter 138, nobs 138000, eps 0.869400, edf 38.090000   * iter 139, nobs 139000, eps 0.926600, edf 33.810000   * iter 140, nobs 140000, eps 0.685600, edf 35.780000   * iter 141, nobs 141000, eps 0.685200, edf 37.830000   * iter 142, nobs 142000, eps 0.973300, edf 39.930000   * iter 143, nobs 143000, eps 2.194200, edf 36.780000   * iter 144, nobs 144000, eps 0.662500, edf 30.740000   * iter 145, nobs 145000, eps 1.352100, edf 38.990000   * iter 146, nobs 146000, eps 0.524400, edf 38.290000   * iter 147, nobs 147000, eps 0.868100, edf 37.620000   * iter 148, nobs 148000, eps 1.377100, edf 31.150000   * iter 149, nobs 149000, eps 0.554300, edf 30.430000   * iter 150, nobs 150000, eps 1.118700, edf 50.090000   * iter 151, nobs 151000, eps 0.934500, edf 43.410000   * iter 152, nobs 152000, eps 1.567700, edf 44.520000   * iter 153, nobs 153000, eps 1.049000, edf 39.880000   * iter 154, nobs 154000, eps 1.095100, edf 39.270000   * iter 155, nobs 155000, eps 0.501500, edf 41.720000   * iter 156, nobs 156000, eps 0.478200, edf 42.270000   * iter 157, nobs 157000, eps 2.765900, edf 46.530000   * iter 158, nobs 158000, eps 0.742000, edf 41.060000   * iter 159, nobs 159000, eps 1.292200, edf 32.510000   * iter 160, nobs 160000, eps 0.905400, edf 45.670000   * iter 161, nobs 161000, eps 1.151500, edf 40.670000   * iter 162, nobs 162000, eps 3.305000, edf 43.090000   * iter 163, nobs 163000, eps 0.654800, edf 45.260000   * iter 164, nobs 164000, eps 0.564200, edf 41.500000   * iter 165, nobs 165000, eps 0.587200, edf 36.470000   * iter 166, nobs 166000, eps 0.923800, edf 38.130000   * iter 167, nobs 167000, eps 1.152000, edf 44.680000   * iter 168, nobs 168000, eps 1.373700, edf 36.000000   * iter 169, nobs 169000, eps 0.807600, edf 41.170000   * iter 170, nobs 170000, eps 0.712100, edf 35.820000   * iter 171, nobs 171000, eps 0.600300, edf 42.440000   * iter 172, nobs 172000, eps 0.731200, edf 34.930000   * iter 173, nobs 173000, eps 0.866100, edf 31.740000   * iter 174, nobs 174000, eps 0.568500, edf 32.460000   * iter 175, nobs 175000, eps 0.473100, edf 39.580000   * iter 176, nobs 176000, eps 1.433900, edf 37.290000   * iter 177, nobs 177000, eps 0.891600, edf 31.260000   * iter 178, nobs 178000, eps 0.577900, edf 35.210000   * iter 179, nobs 179000, eps 0.991600, edf 37.470000   * iter 180, nobs 180000, eps 1.029500, edf 36.830000   * iter 181, nobs 181000, eps 0.612900, edf 42.660000   * iter 182, nobs 182000, eps 0.905500, edf 40.300000   * iter 183, nobs 183000, eps 0.398200, edf 37.390000   * iter 184, nobs 184000, eps 0.689600, edf 36.080000   * iter 185, nobs 185000, eps 0.991900, edf 35.920000   * iter 186, nobs 186000, eps 0.590900, edf 33.990000   * iter 187, nobs 187000, eps 0.822600, edf 40.150000   * iter 188, nobs 188000, eps 0.493600, edf 44.660000   * iter 189, nobs 189000, eps 0.978700, edf 37.300000   * iter 190, nobs 190000, eps 0.605700, edf 35.990000   * iter 191, nobs 191000, eps 0.776900, edf 44.400000   * iter 192, nobs 192000, eps 0.990500, edf 42.740000   * iter 193, nobs 193000, eps 0.583000, edf 36.460000   * iter 194, nobs 194000, eps 0.441000, edf 40.430000   * iter 195, nobs 195000, eps 1.494100, edf 35.000000   * iter 196, nobs 196000, eps 0.626800, edf 37.430000   * iter 197, nobs 197000, eps 0.720700, edf 35.280000   * iter 198, nobs 198000, eps 0.795500, edf 37.250000   * iter 199, nobs 199000, eps 0.735600, edf 39.410000   * iter 200, nobs 200000, eps 1.691800, edf 39.100000   * iter 201, nobs 201000, eps 0.671700, edf 34.050000   * iter 202, nobs 202000, eps 0.961200, edf 35.920000   * iter 203, nobs 203000, eps 0.943600, edf 35.680000   * iter 204, nobs 204000, eps 0.707400, edf 34.120000   * iter 205, nobs 205000, eps 1.252400, edf 35.900000   * iter 206, nobs 206000, eps 0.966400, edf 38.570000   * iter 207, nobs 207000, eps 0.673800, edf 32.940000   * iter 208, nobs 208000, eps 2.485900, edf 35.020000   * iter 209, nobs 209000, eps 0.788200, edf 38.050000   * iter 210, nobs 210000, eps 0.953200, edf 42.790000   * iter 211, nobs 211000, eps 1.058000, edf 38.520000   * iter 212, nobs 212000, eps 0.392400, edf 38.810000   * iter 213, nobs 213000, eps 0.626200, edf 39.460000   * iter 214, nobs 214000, eps 6.179100, edf 44.010000   * iter 215, nobs 215000, eps 1.390400, edf 38.140000   * iter 216, nobs 216000, eps 0.817300, edf 41.260000   * iter 217, nobs 217000, eps 0.572500, edf 38.310000   * iter 218, nobs 218000, eps 1.455200, edf 39.620000   * iter 219, nobs 219000, eps 0.691300, edf 36.290000   * iter 220, nobs 220000, eps 0.631400, edf 38.860000   * iter 221, nobs 221000, eps 0.827300, edf 34.890000   * iter 222, nobs 222000, eps 0.708400, edf 43.360000   * iter 223, nobs 223000, eps 1.231000, edf 39.330000   * iter 224, nobs 224000, eps 2.782700, edf 33.740000   * iter 225, nobs 225000, eps 1.417900, edf 37.740000   * iter 226, nobs 226000, eps 1.281600, edf 37.110000   * iter 227, nobs 227000, eps 0.853300, edf 36.950000   * iter 228, nobs 228000, eps 1.853200, edf 37.120000   * iter 229, nobs 229000, eps 0.733600, edf 43.320000   * iter 230, nobs 230000, eps 0.987900, edf 37.650000   * iter 231, nobs 231000, eps 0.565700, edf 32.210000   * iter 232, nobs 232000, eps 0.711200, edf 33.980000   * iter 233, nobs 233000, eps 0.725000, edf 33.330000   * iter 234, nobs 234000, eps 1.148400, edf 34.520000   * iter 235, nobs 235000, eps 0.632800, edf 31.420000   * iter 236, nobs 236000, eps 0.694300, edf 34.690000   * iter 237, nobs 237000, eps 0.917700, edf 37.400000   * iter 238, nobs 238000, eps 0.590600, edf 42.180000   * iter 239, nobs 239000, eps 1.000500, edf 40.980000   * iter 240, nobs 240000, eps 0.847700, edf 38.370000   * iter 241, nobs 241000, eps 0.711200, edf 37.480000   * iter 242, nobs 242000, eps 0.634700, edf 34.790000   * iter 243, nobs 243000, eps 0.840800, edf 40.490000   * iter 244, nobs 244000, eps 0.876400, edf 44.380000   * iter 245, nobs 245000, eps 0.620300, edf 43.440000   * iter 246, nobs 246000, eps 0.843300, edf 43.390000   * iter 247, nobs 247000, eps 0.703100, edf 42.960000   * iter 248, nobs 248000, eps 1.131600, edf 37.920000   * iter 249, nobs 249000, eps 0.610100, edf 43.840000   * iter 250, nobs 250000, eps 0.730400, edf 40.960000   * iter 251, nobs 251000, eps 1.137500, edf 35.160000   * iter 252, nobs 252000, eps 1.129000, edf 38.690000   * iter 253, nobs 253000, eps 1.104800, edf 36.660000   * iter 254, nobs 254000, eps 0.594000, edf 39.570000   * iter 255, nobs 255000, eps 2.618500, edf 33.720000   * iter 256, nobs 256000, eps 0.775300, edf 28.780000   * iter 257, nobs 257000, eps 1.067000, edf 28.980000   * iter 258, nobs 258000, eps 0.867300, edf 29.970000   * iter 259, nobs 259000, eps 0.706800, edf 30.970000   * iter 260, nobs 260000, eps 0.788800, edf 30.660000   * iter 261, nobs 261000, eps 0.841600, edf 42.270000   * iter 262, nobs 262000, eps 1.059900, edf 39.460000   * iter 263, nobs 263000, eps 2.113500, edf 36.820000   * iter 264, nobs 264000, eps 0.501100, edf 37.550000   * iter 265, nobs 265000, eps 0.906900, edf 45.000000   * iter 266, nobs 266000, eps 0.714200, edf 47.100000   * iter 267, nobs 267000, eps 1.075700, edf 39.710000   * iter 268, nobs 268000, eps 0.873600, edf 37.050000   * iter 269, nobs 269000, eps 0.713800, edf 37.170000   * iter 270, nobs 270000, eps 0.656200, edf 37.650000   * iter 271, nobs 271000, eps 19.164600, edf 36.330000   * iter 272, nobs 272000, eps 1.040000, edf 34.100000   * iter 273, nobs 273000, eps 1.621300, edf 41.120000   * iter 274, nobs 274000, eps 0.642600, edf 41.650000   * iter 275, nobs 275000, eps 0.489600, edf 39.210000   * iter 276, nobs 276000, eps 2.705800, edf 44.370000   * iter 277, nobs 277000, eps 0.727300, edf 40.910000   * iter 278, nobs 278000, eps 1.179200, edf 45.930000   * iter 279, nobs 279000, eps 1.525500, edf 44.020000   * iter 280, nobs 280000, eps 0.570000, edf 37.160000   * iter 281, nobs 281000, eps 1.845000, edf 35.920000   * iter 282, nobs 282000, eps 0.546400, edf 41.130000   * iter 283, nobs 283000, eps 4.611300, edf 42.670000   * iter 284, nobs 284000, eps 1.002900, edf 41.470000   * iter 285, nobs 285000, eps 1.120200, edf 37.810000   * iter 286, nobs 286000, eps 0.947900, edf 37.310000   * iter 287, nobs 287000, eps 1.956800, edf 36.910000   * iter 288, nobs 288000, eps 1.272400, edf 36.570000   * iter 289, nobs 289000, eps 0.927200, edf 41.560000   * iter 290, nobs 290000, eps 1.260800, edf 43.880000   * iter 291, nobs 291000, eps 0.833300, edf 38.240000   * iter 292, nobs 292000, eps 0.866100, edf 35.810000   * iter 293, nobs 293000, eps 0.589300, edf 37.370000   * iter 294, nobs 294000, eps 1.762100, edf 36.880000   * iter 295, nobs 295000, eps 0.789600, edf 41.580000   * iter 296, nobs 296000, eps 0.629500, edf 38.910000   * iter 297, nobs 297000, eps 0.812400, edf 35.870000   * iter 298, nobs 298000, eps 1.044900, edf 39.000000   * iter 299, nobs 299000, eps 0.550800, edf 42.560000   * iter 300, nobs 300000, eps 16.459900, edf 39.180000   * iter 301, nobs 301000, eps 0.693800, edf 40.520000   * iter 302, nobs 302000, eps 0.980500, edf 38.920000   * iter 303, nobs 303000, eps 3.024100, edf 39.090000   * iter 304, nobs 304000, eps 0.591100, edf 38.390000   * iter 305, nobs 305000, eps 2.074800, edf 40.400000   * iter 306, nobs 306000, eps 3.723500, edf 39.270000   * iter 307, nobs 307000, eps 0.724700, edf 41.040000   * iter 308, nobs 308000, eps 2.833700, edf 40.430000   * iter 309, nobs 309000, eps 2.241400, edf 42.180000   * iter 310, nobs 310000, eps 0.625800, edf 37.860000   * iter 311, nobs 311000, eps 1.214700, edf 39.620000   * iter 312, nobs 312000, eps 1.501100, edf 39.800000   * iter 313, nobs 313000, eps 1.523000, edf 38.740000   * iter 314, nobs 314000, eps 0.875900, edf 39.120000   * iter 315, nobs 315000, eps 0.661700, edf 46.210000   * iter 316, nobs 316000, eps 2.253000, edf 45.220000   * iter 317, nobs 317000, eps 0.998300, edf 44.640000   * iter 318, nobs 318000, eps 0.652600, edf 37.210000   * iter 319, nobs 319000, eps 0.786000, edf 37.260000   * iter 320, nobs 320000, eps 0.842400, edf 37.030000   * iter 321, nobs 321000, eps 1.946100, edf 37.880000   * iter 322, nobs 322000, eps 0.541800, edf 32.920000   * iter 323, nobs 323000, eps 0.981700, edf 33.430000   * iter 324, nobs 324000, eps 0.551100, edf 35.070000   * iter 325, nobs 325000, eps 0.645800, edf 35.570000   * iter 326, nobs 326000, eps 0.894000, edf 39.980000   * iter 327, nobs 327000, eps 0.787000, edf 35.200000   * iter 328, nobs 328000, eps 0.570300, edf 34.600000   * iter 329, nobs 329000, eps 0.911600, edf 30.450000   * iter 330, nobs 330000, eps 0.505800, edf 34.600000   * iter 331, nobs 331000, eps 1.499000, edf 40.560000   * iter 332, nobs 332000, eps 0.835600, edf 38.120000   * iter 333, nobs 333000, eps 0.598700, edf 36.030000   * iter 334, nobs 334000, eps 0.508500, edf 31.290000   * iter 335, nobs 335000, eps 0.713400, edf 35.370000   * iter 336, nobs 336000, eps 0.869700, edf 40.420000   * iter 337, nobs 337000, eps 1.049500, edf 35.930000   * iter 338, nobs 338000, eps 0.551600, edf 39.150000   * iter 339, nobs 339000, eps 0.657700, edf 37.290000   * iter 340, nobs 340000, eps 1.578300, edf 42.260000   * iter 341, nobs 341000, eps 0.963500, edf 41.540000   * iter 342, nobs 342000, eps 0.493500, edf 41.030000   * iter 343, nobs 343000, eps 0.571400, edf 44.020000   * iter 344, nobs 344000, eps 0.678400, edf 40.690000   * iter 345, nobs 345000, eps 1.014200, edf 47.890000   * iter 346, nobs 346000, eps 0.431900, edf 44.590000   * iter 347, nobs 347000, eps 0.572400, edf 36.150000   * iter 348, nobs 348000, eps 0.735000, edf 45.920000   * iter 349, nobs 349000, eps 0.928300, edf 39.850000   * iter 350, nobs 350000, eps 0.668400, edf 40.740000   * iter 351, nobs 351000, eps 0.706800, edf 41.820000   * iter 352, nobs 352000, eps 1.001200, edf 42.100000   * iter 353, nobs 353000, eps 0.736000, edf 40.180000   * iter 354, nobs 354000, eps 0.833000, edf 38.060000   * iter 355, nobs 355000, eps 0.567100, edf 37.720000   * iter 356, nobs 356000, eps 0.986700, edf 45.240000   * iter 357, nobs 357000, eps 0.664900, edf 45.840000   * iter 358, nobs 358000, eps 1.163300, edf 40.360000   * iter 359, nobs 359000, eps 0.473600, edf 39.300000   * iter 360, nobs 360000, eps 2.000500, edf 42.320000   * iter 361, nobs 361000, eps 0.778600, edf 37.910000   * iter 362, nobs 362000, eps 0.654900, edf 39.410000   * iter 363, nobs 363000, eps 0.570200, edf 41.030000   * iter 364, nobs 364000, eps 0.679600, edf 34.690000   * iter 365, nobs 365000, eps 1.295700, edf 33.580000   * iter 366, nobs 366000, eps 1.079200, edf 36.040000   * iter 367, nobs 367000, eps 1.026800, edf 36.080000   * iter 368, nobs 368000, eps 0.562500, edf 32.170000   * iter 369, nobs 369000, eps 1.494500, edf 39.290000   * iter 370, nobs 370000, eps 0.808700, edf 40.090000   * iter 371, nobs 371000, eps 1.070800, edf 41.450000   * iter 372, nobs 372000, eps 1.044300, edf 41.500000   * iter 373, nobs 373000, eps 1.495000, edf 36.860000   * iter 374, nobs 374000, eps 2.660100, edf 40.760000   * iter 375, nobs 375000, eps 0.854700, edf 40.480000   * iter 376, nobs 376000, eps 2.539100, edf 38.160000   * iter 377, nobs 377000, eps 0.682300, edf 34.090000   * iter 378, nobs 378000, eps 0.646800, edf 38.130000   * iter 379, nobs 379000, eps 1.191200, edf 38.910000   * iter 380, nobs 380000, eps 0.933600, edf 36.590000   * iter 381, nobs 381000, eps 0.814100, edf 34.350000   * iter 382, nobs 382000, eps 0.746100, edf 35.520000   * iter 383, nobs 383000, eps 1.257400, edf 34.880000   * iter 384, nobs 384000, eps 0.636400, edf 37.810000   * iter 385, nobs 385000, eps 3.133300, edf 41.090000   * iter 386, nobs 386000, eps 12.171200, edf 41.850000   * iter 387, nobs 387000, eps 0.698000, edf 37.010000   * iter 388, nobs 388000, eps 5.595800, edf 40.830000   * iter 389, nobs 389000, eps 1.013800, edf 42.990000   * iter 390, nobs 390000, eps 1.880800, edf 45.100000   * iter 391, nobs 391000, eps 1.404200, edf 42.440000   * iter 392, nobs 392000, eps 1.658700, edf 43.600000   * iter 393, nobs 393000, eps 0.471200, edf 42.450000   * iter 394, nobs 394000, eps 0.596500, edf 43.750000   * iter 395, nobs 395000, eps 0.498200, edf 40.320000   * iter 396, nobs 396000, eps 0.817700, edf 39.080000   * iter 397, nobs 397000, eps 1.376900, edf 33.860000   * iter 398, nobs 398000, eps 0.843700, edf 38.270000   * iter 399, nobs 399000, eps 0.630000, edf 39.080000   * iter 400, nobs 400000, eps 1.384700, edf 35.720000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> elapsed time: 52.13sec</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## plot(b4)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot parameter updates/samples.</span></span></span>
<span class="r-in"><span><span class="co">## plot(b4, which = "samples")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Predict with burnin and compute mean</span></span></span>
<span class="r-in"><span><span class="co">## prediction of the last 20 iterates.</span></span></span>
<span class="r-in"><span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">b4</span>, model <span class="op">=</span> <span class="st">"mu"</span>, burnin <span class="op">=</span> <span class="fl">30</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nikolaus Umlauf, Nadja Klein, Achim Zeileis, Thorsten Simon.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

