<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit Bayesian Additive Models for Location Scale and Shape (and Beyond) — bamlss • bamlss</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fit Bayesian Additive Models for Location Scale and Shape (and Beyond) — bamlss"><meta property="og:description" content="This is the main model fitting function of the package. Function bamlss()
  is a wrapper function that parses the data and the model formula, or
  extended bamlss.formula, as well as the bamlss.family
  into a bamlss.frame. The bamlss.frame then holds all model
  matrices and information that is needed for setting up estimation engines.
  The model matrices are based on mgcv infrastructures, i.e.,
  smooth terms are constructed using smooth.construct and
  smoothCon. Therefore, all mgcv model term constructors like
  s, te, t2 and ti
  can be used. Identifiability conditions are imposed using function gam.side.
After the bamlss.frame is set up function bamlss() applies optimizer
  and/or sampling functions. These functions can also be provided by the user. See the details
  below on how to create new engines to be used with function bamlss().
Finally, the estimated parameters and/or samples are used to create model output results like
  summary statistics or effect plots. The computation of results may also be controlled by the user."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bamlss</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2-2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bamlss.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/terms.html">Available Model Terms</a>
    </li>
    <li>
      <a href="../articles/families.html">Families</a>
    </li>
    <li>
      <a href="../articles/bf.html">BAMLSS Model Frame</a>
    </li>
    <li>
      <a href="../articles/engines.html">Estimation Engines</a>
    </li>
    <li>
      <a href="../articles/distregvis.html">Visualization with distreg.vis</a>
    </li>
    <li>
      <a href="../articles/glm.html">Generalized Linear Models (+)</a>
    </li>
    <li>
      <a href="../articles/multinomial.html">Bayesian Multinomial Regression</a>
    </li>
    <li>
      <a href="../articles/rent.html">Munich Rent Example</a>
    </li>
    <li>
      <a href="../articles/zn.html">Spatial Location-Scale Model</a>
    </li>
    <li>
      <a href="../articles/fatalities.html">Fatalities Model for Austria</a>
    </li>
    <li>
      <a href="../articles/mvnorm.html">Multivariate Normal Model</a>
    </li>
    <li>
      <a href="../articles/misc.html">Miscellaneous Topics</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Publications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/jm.html">Bayesian Joint Models for Longitudinal and Survival Data</a>
    </li>
    <li>
      <a href="../articles/bivnorm.html">Bivariate Gaussian Models for Wind Vectors</a>
    </li>
    <li>
      <a href="../articles/cox.html">Complex Space-Time Interactions in a Cox Model</a>
    </li>
    <li>
      <a href="../articles/lasso.html">LASSO-Type Penalization in the Framework of GAMLSS</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit Bayesian Additive Models for Location Scale and Shape (and Beyond)</h1>
    
    <div class="hidden name"><code>bamlss.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is the main model fitting function of the package. Function <code>bamlss()</code>
  is a wrapper function that parses the <code>data</code> and the model <code>formula</code>, or
  extended <code><a href="bamlss.formula.html">bamlss.formula</a></code>, as well as the <code><a href="family.bamlss.html">bamlss.family</a></code>
  into a <code><a href="bamlss.frame.html">bamlss.frame</a></code>. The <code><a href="bamlss.frame.html">bamlss.frame</a></code> then holds all model
  matrices and information that is needed for setting up estimation engines.
  The model matrices are based on <code>mgcv</code> infrastructures, i.e.,
  smooth terms are constructed using <code><a href="https://rdrr.io/pkg/mgcv/man/smooth.construct.html" class="external-link">smooth.construct</a></code> and
  <code><a href="https://rdrr.io/pkg/mgcv/man/smoothCon.html" class="external-link">smoothCon</a></code>. Therefore, all <code>mgcv</code> model term constructors like
  <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">te</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/t2.html" class="external-link">t2</a></code> and <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">ti</a></code>
  can be used. Identifiability conditions are imposed using function <code><a href="https://rdrr.io/pkg/mgcv/man/gam.side.html" class="external-link">gam.side</a></code>.</p>
<p>After the <code><a href="bamlss.frame.html">bamlss.frame</a></code> is set up function <code>bamlss()</code> applies optimizer
  and/or sampling functions. These functions can also be provided by the user. See the details
  below on how to create new engines to be used with function <code>bamlss()</code>.</p>
<p>Finally, the estimated parameters and/or samples are used to create model output results like
  summary statistics or effect plots. The computation of results may also be controlled by the user.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bamlss</span><span class="op">(</span><span class="va">formula</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>, data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>, knots <span class="op">=</span> <span class="cn">NULL</span>, weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>, offset <span class="op">=</span> <span class="cn">NULL</span>, na.action <span class="op">=</span> <span class="va">na.omit</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="cn">NULL</span>, reference <span class="op">=</span> <span class="cn">NULL</span>, transform <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="cn">NULL</span>, sampler <span class="op">=</span> <span class="cn">NULL</span>, samplestats <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  results <span class="op">=</span> <span class="cn">NULL</span>, cores <span class="op">=</span> <span class="cn">NULL</span>, sleep <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  combine <span class="op">=</span> <span class="cn">TRUE</span>, model <span class="op">=</span> <span class="cn">TRUE</span>, x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  light <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>A formula or extended formula, i.e., the <code>formula</code> can be a
    <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> of formulas where each list entry specifies the details of one parameter
    of the modeled response distribution, see <code><a href="bamlss.formula.html">bamlss.formula</a></code>. For incorporating
    smooth terms, all model term constructors implemented in <code>mgcv</code> such as
    <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">te</a></code> and <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">ti</a></code> can be used, amongst others.</p></dd>

  <dt>family</dt>
<dd><p>A <code><a href="family.bamlss.html">bamlss.family</a></code> object, specifying the details of the modeled
    distribution such as the parameter names, the density function, link functions, etc.
    Can be a character without the <code>"_bamlss"</code> extension of the
    <code><a href="family.bamlss.html">bamlss.family</a></code> name.</p></dd>

  <dt>data</dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code> or <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> containing the model
    response variable(s) and covariates specified in the <code>formula</code>.
    By default the variables are taken from <code>environment(formula)</code>:
    typically the environment from which <code>bamlss</code> is called.</p></dd>

  <dt>start</dt>
<dd><p>A named numeric vector containing starting values to be send to the <code>optimizer</code>
    and/or <code>sampler</code> function. For a possible naming convention for the parameters see
    function <code><a href="parameters.html">parameters</a></code>, but this is not restrictive and engine specific.</p></dd>

  <dt>knots</dt>
<dd><p>An optional list containing user specified knots, see the documentation of
    function <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code>.</p></dd>

  <dt>weights</dt>
<dd><p>Prior weights on the data.</p></dd>

  <dt>subset</dt>
<dd><p>An optional vector specifying a subset of observations to be
    used in the fitting process.</p></dd>

  <dt>offset</dt>
<dd><p>Can be used to supply model offsets for use in fitting.</p></dd>

  <dt>na.action</dt>
<dd><p>A function which indicates what should happen when the data
    contain <code>NA</code>'s. The default is set by the <code>na.action</code>
    setting of <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></code>, and is <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></code> if set to <code>NULL</code>.</p></dd>

  <dt>contrasts</dt>
<dd><p>An optional list. See the <code>contrasts.arg</code> of 
    <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix.default</a></code>.</p></dd>

  <dt>reference</dt>
<dd><p>A <code>character</code> specifying a reference category, e.g., when
    fitting a multinomial model.</p></dd>

  <dt>transform</dt>
<dd><p>A transformer function that is applied on the <code><a href="bamlss.frame.html">bamlss.frame</a></code>.
    See, e.g., function <code><a href="randomize.html">randomize</a></code> and <code><a href="bamlss.engine.setup.html">bamlss.engine.setup</a></code>.</p></dd>

  <dt>optimizer</dt>
<dd><p>An optimizer function that returns, e.g., posterior mode estimates
    of the parameters as a named numeric vector. The default optimizer function is
    <code><a href="bfit.html">opt_bfit</a></code>. If set to <code>FALSE</code>, no optimizer function will be used.</p></dd>

  <dt>sampler</dt>
<dd><p>A sampler function that returns a matrix of samples, the columns represent the
    parameters, the rows the iterations. The returned matrix must be coerced to an object of
    class <code>"mcmc"</code>, see <code><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">as.mcmc</a></code>. The default sampler function is
    <code><a href="GMCMC.html">sam_GMCMC</a></code>. If set to <code>FALSE</code>, no sampler function will be used.</p></dd>

  <dt>samplestats</dt>
<dd><p>A function computing statistics from samples, per default function
    <code><a href="samplestats.html">samplestats</a></code> is used. If set to <code>FALSE</code>, no <code>samplestats</code> function
    will be used. Note that this option is crucial for very large datasets, as computing
    statistics from samples this way may be very time consuming!</p></dd>

  <dt>results</dt>
<dd><p>A function computing results from the parameters and/or samples, e.g., for
    creating effect plots, see function <code>link{results.bamlss.default}</code>. If set <code>FALSE</code>
    no <code>results</code> function will be used.</p></dd>

  <dt>cores</dt>
<dd><p>An integer specifying the number of cores that should be used for the sampler
    function. This is based on function <code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">mclapply</a></code> of the <span class="pkg">parallel</span>
    package.</p></dd>

  <dt>sleep</dt>
<dd><p>Time the system should sleep before the next core is started.</p></dd>

  <dt>combine</dt>
<dd><p>If samples are computed on multiple cores, should the samples be combined into
    one <code><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">mcmc</a></code> matrix?</p></dd>

  <dt>model</dt>
<dd><p>If set to <code>FALSE</code> the model frame used for modeling is not part of the
    return value.</p></dd>

  <dt>x</dt>
<dd><p>If set to <code>FALSE</code> the model matrices are not part of the return value.</p></dd>

  <dt>light</dt>
<dd><p>Should the returned object be lighter, i.e., if <code>light = TRUE</code> the returned
    object will not contain the model.frame and design and penalty matrices are deleted.</p></dd>

  <dt>...</dt>
<dd><p>Arguments passed to the <code>transformer</code>, <code>optimizer</code>, <code>sampler</code>,
    <code>results</code> and <code>samplestats</code> function.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The main idea of this function is to provide infrastructures that make it relatively easy
  to create estimation engines for new problems, or write interfaces to existing software
  packages.</p>
<p>The steps that are performed within the function are:</p><ul><li><p>First, the function parses the <code>data</code>, the <code>formula</code> or the extended
      <code><a href="bamlss.formula.html">bamlss.formula</a></code> as well as the <code><a href="family.bamlss.html">bamlss.family</a></code> into a model frame
      like object, the <code><a href="bamlss.frame.html">bamlss.frame</a></code>. This object holds all necessary model matrices
      and information that is needed for subsequent model fitting engines. Per default,
      all package <code>mgcv</code> smooth term constructor functions like
      <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">te</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/t2.html" class="external-link">t2</a></code> and
      <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">ti</a></code> can be used (see also function <code><a href="https://rdrr.io/pkg/mgcv/man/smooth.construct.html" class="external-link">smooth.construct</a></code>),
      however, even special user defined constructors can be included, see the manual of
      <code><a href="bamlss.frame.html">bamlss.frame</a></code>.</p></li>
<li><p>In a second step, the <code><a href="bamlss.frame.html">bamlss.frame</a></code> can be transformed, e.g., if a mixed
      model representation of smooth terms is needed, see function <code><a href="randomize.html">randomize</a></code>.</p></li>
<li><p>Then an optimizer function is started, e.g., a function that finds posterior mode estimates
      of the parameters. A convention for model fitting engines is that such functions should have
      the following arguments:</p>
<p><code>optimizer(x, y, family, start, weights, offset, ...)</code></p>
<p>Internally, function <code>bamlss()</code> will send the <code>x</code> object that holds all
      model matrices, the response <code>y</code> object, the <code>family</code> object, <code>start</code>ing
      values for the parameters, possible <code>weights</code> and <code>offset</code>s of the created
      <code><a href="bamlss.frame.html">bamlss.frame</a></code> to the
      optimizer function (see the manual of <code><a href="bamlss.frame.html">bamlss.frame</a></code> for more details on the
      <code>x</code>, <code>y</code> and other objects). The job of the optimizer is to return a named numeric
      vector of optimum parameters. The names of the parameters should be such that they can be
      uniquely mapped to the corresponding model matrices in <code>x</code>. See function
      <code><a href="parameters.html">parameters</a></code> for more details on parameter names. The default optimizer function
      is <code><a href="bfit.html">bfit</a></code>. The optimizer can return more information than only the optimum
      parameters. It is possible to return a list, the convention here is that an element named
      <code>"parameters"</code> then holds the named vector of estimated parameters. Possible other return
      values could be fitted values, the Hessian matrix, information criteria or information
      about convergence of the algorithm, etc. Note that the parameters are simply added to the
      <code><a href="bamlss.frame.html">bamlss.frame</a></code> in an (list) entry named <code>parameters</code>.</p></li>
<li><p>After the optimization step, a <code>sampler</code> function is started. The arguments of such
      sampler functions are the same as for the <code>optimizer</code> functions</p>
<p><code>sampler(x, y, family, start, weights, offset, ...)</code></p>
<p>Sampler functions must return a matrix of samples, each row represents one iteration and the matrix
      can be coerced to <code><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">mcmc</a></code> objects. The function may return a list of samples,
      e.g., if multiple chains are returned each list entry then holds one sample matrix of
      one chain. The column names of the sample matrix should be the same as the names of estimated
      parameters. For a possible naming convention see function <code><a href="parameters.html">parameters</a></code>, which
      ensures unique mapping of samples with the model matrices in the <code>x</code> object of the
      <code><a href="bamlss.frame.html">bamlss.frame</a></code>. The samples are added to the <code><a href="bamlss.frame.html">bamlss.frame</a></code>
      in an (list) entry named <code>samples</code>.</p></li>
<li><p>Next, the <code>samplestats</code> function is applied. This function can compute any quantity
      from the samples and the <code>x</code> object, the arguments of such functions are</p>
<p><code>samplestats(samples, x, y, family, ...)</code></p>
<p>where argument <code>samples</code> are the samples returned from the <code>sampler</code> function,
      and <code>x</code>, <code>y</code> and <code>family</code> are the same objects as passed to the optimizer
      and or sampler functions. For example, the default function in <code>bamlss()</code> for this task
      is also called <code><a href="samplestats.html">samplestats</a></code> and returns the mean of the log-likelihood and the
      log-posterior computed of all samples, as well as the DIC.</p></li>
<li><p>The last step is to compute more complex information about the model using the
      <code>results</code> function. The arguments of such <code>results</code> functions are</p>
<p><code>results(bamlss.frame, ...)</code></p>
<p>here, the full <code><a href="bamlss.frame.html">bamlss.frame</a></code> including possible <code>parameters</code> and
      <code>samples</code> is passed to the function within <code>bamlss()</code>. The default function
      for this task is <code><a href="results.bamlss.default.html">results.bamlss.default</a></code> which returns an object of class
      <code>"bamlss.results"</code> for which generic plotting functions are and a <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></code>
      function is provided. Hence, the user can control the output of the model, the plotting
      and summary statistics, too.</p></li>
</ul><p>Note that function <code><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform()</a></code>, <code>optimizer()</code>, <code>sampler()</code>, <code><a href="samplestats.html">samplestats()</a></code>
  and <code>results()</code> can be provided from the <code><a href="family.bamlss.html">bamlss.family</a></code> object, e.g.,
  if a <code><a href="family.bamlss.html">bamlss.family</a></code> object has an element named <code>"optimizer"</code>, which
  represents a valid optimizer function such as <code><a href="bfit.html">bfit</a></code>, exactly this optimizer
  function will be used as a default when using the family.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>"bamlss"</code>. The object is in principle only a slight extension
  of a <code><a href="bamlss.frame.html">bamlss.frame</a></code>, i.e., if an <code>optimizer</code> is applied it will hold the
  estimated parameters in an additional element named <code>"parameters"</code>. If a sampler function
  is applied it will additionally hold the samples in an element named <code>"samples"</code>.
  The same mechanism is used for <code>results</code> function.</p>


<p>If the <code>optimizer</code> function computes additional output next to the parameters, this will
  be saved in an element named <code>"model.stats"</code>. If a <code>samplestats</code> function is applied,
  the output will also be saved in the <code>"model.stats"</code> element.</p>


<p>Additionally, all functions that are called are saved as attribute <code>"functions"</code> in the
  returned object.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Umlauf N, Klein N, Zeileis A (2019). BAMLSS: Bayesian Additive Models for Location,
  Scale and Shape (and Beyond). <em>Journal of Computational and Graphical Statistics</em>, <b>27</b>(3), 612--627.
  doi: <a href="https://doi.org/10.1080/10618600.2017.1407325" class="external-link">10.1080/10618600.2017.1407325</a></p>
<p>Umlauf N, Klein N, Simon T, Zeileis A (2021).
  bamlss: A Lego Toolbox for Flexible Bayesian Regression (and Beyond).
  <em>Journal of Statistical Software</em>,
  <b>100</b>(4), 1--53. doi: <a href="https://doi.org/10.18637/jss.v100.i04" class="external-link">10.18637/jss.v100.i04</a></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Nikolaus Umlauf, Nadja Klein, Achim Zeileis.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="bamlss.frame.html">bamlss.frame</a></code>, <code><a href="family.bamlss.html">family.bamlss</a></code>, <code><a href="bamlss.formula.html">bamlss.formula</a></code>,
  <code><a href="randomize.html">randomize</a></code>, <code><a href="bamlss.engine.setup.html">bamlss.engine.setup</a></code>,
  <code><a href="bfit.html">opt_bfit</a></code>, <code><a href="GMCMC.html">sam_GMCMC</a></code>, <code><a href="continue.html">continue</a></code>,
  <code><a href="coef.bamlss.html">coef.bamlss</a></code>, <code><a href="parameters.html">parameters</a></code>, <code><a href="predict.bamlss.html">predict.bamlss</a></code>,
  <code><a href="plot.bamlss.html">plot.bamlss</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co">## Simulated data example.</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="GAMart.html">GAMart</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="va">num</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">s</span><span class="op">(</span><span class="va">x3</span><span class="op">)</span> <span class="op">+</span> <span class="fu">te</span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">bamlss</span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in bamlss(f, data = d):</span> object 'd' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in summary(b):</span> object 'b' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'plot': object 'b' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span>, which <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'plot': object 'b' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b</span>, which <span class="op">=</span> <span class="st">"samples"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'plot': object 'b' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Use of optimizer and sampler functions:</span></span></span>
<span class="r-in"><span><span class="co">## * first run optimizer,</span></span></span>
<span class="r-in"><span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu">bamlss</span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">d</span>, optimizer <span class="op">=</span> <span class="va">opt_bfit</span>, sampler <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in bamlss(f, data = d, optimizer = opt_bfit, sampler = FALSE):</span> object 'd' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">b1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in print(b1):</span> object 'b1' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">b1</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in summary(b1):</span> object 'b1' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## * afterwards, start sampler with staring values,</span></span></span>
<span class="r-in"><span><span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu">bamlss</span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">d</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">b1</span><span class="op">)</span>, optimizer <span class="op">=</span> <span class="cn">FALSE</span>, sampler <span class="op">=</span> <span class="va">sam_GMCMC</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in bamlss(f, data = d, start = coef(b1), optimizer = FALSE, sampler = sam_GMCMC):</span> object 'd' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">b2</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in print(b2):</span> object 'b2' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">b2</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in summary(b2):</span> object 'b2' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Continue sampling.</span></span></span>
<span class="r-in"><span><span class="va">b3</span> <span class="op">&lt;-</span> <span class="fu"><a href="continue.html">continue</a></span><span class="op">(</span><span class="va">b2</span>, n.iter <span class="op">=</span> <span class="fl">12000</span>, burnin <span class="op">=</span> <span class="fl">0</span>, thin <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in continue(b2, n.iter = 12000, burnin = 0, thin = 10):</span> object 'b2' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b3</span>, which <span class="op">=</span> <span class="st">"samples"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'plot': object 'b3' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b3</span>, which <span class="op">=</span> <span class="st">"max-acf"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'plot': object 'b3' not found</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">b3</span>, which <span class="op">=</span> <span class="st">"max-acf"</span>, burnin <span class="op">=</span> <span class="fl">500</span>, thin <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'plot': object 'b3' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nikolaus Umlauf, Nadja Klein, Achim Zeileis, Thorsten Simon.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

